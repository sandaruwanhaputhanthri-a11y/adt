var Gt=Object.defineProperty;var Wr=Object.getOwnPropertyDescriptor;var Vr=Object.getOwnPropertyNames;var Ur=Object.prototype.hasOwnProperty;var N=(e,t)=>()=>(e&&(t=e(e=0)),t);var Me=(e,t)=>{for(var o in t)Gt(e,o,{get:t[o],enumerable:!0})},Gr=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Vr(t))!Ur.call(e,a)&&a!==o&&Gt(e,a,{get:()=>t[a],enumerable:!(n=Wr(t,a))||n.enumerable});return e};var Kr=e=>Gr(Gt({},"__esModule",{value:!0}),e);var Qr,l,Kt,g,z=N(()=>{"use strict";Qr={currentAudio:null,isPlaying:!1,currentIndex:0,audioElements:[],audioQueue:[],eli5Active:!1,eli5Element:null,eli5Audio:null,eli5Mode:!1,readAloudMode:!1,signLanguageMode:!1,sideBarActive:!1,navOpen:!1,navScrollPosition:0,easyReadMode:!1,autoplayMode:!1,describeImagesMode:!1,syllablesMode:!1,glossaryMode:!1,audioSpeed:1,selectedOption:null,selectedWord:null,inCategoryNavigation:!1,currentWord:null,translations:{},audioFiles:{},validateHandler:null,retryHandler:null,currentLanguage:document.documentElement.lang||"en",currentPage:"",interfaceInitialized:!1,activeTabIndex:0,glossaryListOpen:!1,isReferencePage:!1,originatingPage:null,stateMode:!0,videoFiles:{},videoPlaying:!1,videoElement:null,videoSource:"",characterName:null,characterGreeting:null,notepadOpen:!1,navigationDirection:"forward"},l={...Qr},Kt=e=>l[e],g=(e,t)=>(l[e]=t,l[e])});var I,k,Qt,de=N(()=>{"use strict";I=(e,t,o=7,n="/")=>{let a="";if(o){let r=new Date;r.setTime(r.getTime()+o*24*60*60*1e3),a="; expires="+r.toUTCString()}document.cookie=e+"="+(t||"")+a+"; path="+n},k=e=>{let t=e+"=",o=document.cookie.split(";");for(let n=0;n<o.length;n++){let a=o[n];for(;a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(t)===0)return a.substring(t.length,a.length)}return null},Qt=(e,t="/")=>{document.cookie=e+"=; Max-Age=-99999999; path="+t}});var kn=N(()=>{"use strict";z();de()});var Jt,Ke,Jr,Tn,ht,vt=N(()=>{"use strict";Jt=e=>{console.error("Application initialization failed:",e?.message||"Unknown error"),ht();let t="Error initializing application. Some features may be unavailable.";e instanceof ReferenceError?t="Application configuration error. Please refresh the page.":e instanceof TypeError?t="Interface elements not found. Please check your connection.":e.message?.includes("fetch")&&(t="Failed to load required components. Please check your connection."),Ke(t)},Ke=e=>{try{let t=document.getElementById("toast");if(!t){Jr(e);return}Tn(t,e)}catch(t){console.error("Failed to show error toast:",t),alert(e)}},Jr=e=>{let t=document.createElement("div");t.id="toast",t.className="fixed bottom-20 right-5 px-4 py-2 rounded-md shadow-lg z-50",document.body.appendChild(t),Tn(t,e)},Tn=(e,t)=>{e.textContent=t,e.classList.remove("hidden"),e.classList.add("bg-red-200","text-red-700"),setTimeout(()=>{e.classList.add("hidden")},5e3)},ht=()=>{try{document.body.classList.remove("hidden");let e=document.querySelector(".container");e&&(e.classList.remove("opacity-0","invisible","hidden"),e.classList.add("opacity-100","visible"));let t=document.getElementById("content");t&&(t.classList.remove("hidden","opacity-0","invisible"),t.classList.add("visible","opacity-100")),document.querySelectorAll(".initial-hidden").forEach(o=>{o.classList.remove("initial-hidden","hidden")})}catch(e){console.error("Error showing main content:",e),document.body.style.display="block",document.body.style.opacity="1",document.body.style.visibility="visible"}};setTimeout(()=>{let e=document.getElementById("content");(document.body.classList.contains("hidden")||e&&e.classList.contains("opacity-0"))&&(console.warn("Forcing content display after timeout"),ht())},2e3)});var Zt,Xt,Zr,Nn,Yt,eo=N(()=>{"use strict";z();Zt=()=>{let e=document.getElementById("sign-language-video"),t=l.videoElement;t&&(t.pause(),t.currentTime=0),e.classList.add("hidden"),g("videoPlaying",!1)},Xt=()=>{let e=document.getElementById("sign-language-video"),t=e.querySelector("video");if(t&&t.remove(),!l.videoSource)return;let n=`content/i18n/${l.currentLanguage||"es"}/video/${l.videoSource}`;Zr(n).then(a=>{e.appendChild(a),a.play().then(()=>{e.classList.remove("hidden"),g("videoPlaying",!0)}).catch(r=>{console.warn("Video playback failed:",r)})}).catch(a=>{console.error("Failed to start the video:",a)})},Zr=e=>new Promise((t,o)=>{let n=document.createElement("video");n.src=e,n.controls=!0,n.autoplay=!0,n.classList.add("w-full","h-full","object-cover"),g("videoElement",n),n.onloadeddata=()=>{t(n)},n.onerror=()=>{console.warn(`Error loading video: ${e}. Falling back to default video.`),n.src="content/i18n/es/video/10_0.mp4",n.load(),n.onloadeddata=()=>{t(n)},n.onerror=a=>{console.error("Error loading fallback video:",a),o(a)}}}),Nn=()=>{let e=l.videoFiles,t=l.currentPage.replace(/_/g,"-");l.videoSource=e["video-"+t]},Yt=e=>{let t=document.getElementById("sign-language-bottom-container"),o=document.getElementById("sign-language-video");if(e)if(t)o&&o.classList.remove("hidden");else{let n=document.createElement("div");if(n.id="sign-language-bottom-container",n.className=["fixed","bottom-0","left-0","z-40","w-full","flex","justify-center","items-center","h-72"].join(" "),o)n.appendChild(o),o.classList.remove("hidden");else{let a=document.createElement("div");a.id="sign-language-video",a.className="w-full h-full",n.appendChild(a)}document.body.appendChild(n),document.body.classList.add("pb-72")}else t&&(o&&(document.body.appendChild(o),o.classList.add("hidden")),t.remove(),document.body.classList.remove("pb-72"))}});var qn,xt,Qe,Xr,Yr,ei,ti,oi,ni,f,to,ai,D=N(()=>{"use strict";z();Y();H();vt();ue();eo();Y();qn=async()=>{try{return l.currentLanguage||(console.warn("No language set, using default"),g("currentLanguage","en")),await Qe(),!0}catch(e){return console.error("Error setting up translations:",e),Ke("Error loading translations. Using defaults."),!1}finally{ni()}},xt=async(e,t)=>{try{let o=await e.text();return JSON.parse(o)}catch(o){throw console.error(`JSON parse error in ${t}:`,o),new Error(`Invalid JSON in ${t}: ${o.message}`)}},Qe=async()=>{try{let e=l.currentLanguage||"en",t=`./assets/interface_translations/${e}/interface_translations.json`,o=await fetch(t);if(!o.ok){console.warn("Interface translations not found, using defaults"),g("translations",{});return}let n=await xt(o,"interface translations");await ai(`./content/i18n/${e}`),n&&(g("translations",{...l.translations,...n}),oi()),await Xr()}catch(e){throw console.error("Error loading translations:",e),g("translations",{}),g("audioFiles",{}),e}finally{window.MathJax&&window.MathJax.typeset()}},Xr=async()=>{K();let e=l.translations;if(!e)return;for(let[o,n]of Object.entries(e)){if(o.endsWith("_eli5"))continue;let a=o;if(l.easyReadMode){let r=document.querySelectorAll(`[data-id="${o}"]`),i=Array.from(r).some(c=>c.tagName.toLowerCase().match(/^h[1-6]$/)),s=Array.from(r).some(c=>{let d=c.closest(".word-card"),u=c.closest("[data-activity-item]"),m=c.closest(".activity-text");return d!==null||u!==null||m!==null});if(!i&&!s){let c=`${o}_easy_read`;e.hasOwnProperty(c)&&(a=c)}}Yr(o,a),ei(o,a)}me(),Nn(),ti(),l.glossaryMode&&typeof X=="function"&&(typeof ve=="function"&&ve(),typeof he=="function"?he().then(()=>{X()}):X());let t=document.querySelector('meta[name="title-id"]');if(t){let o=t.getAttribute("content");o&&l.translations[o]&&(document.title=l.translations[o])}typeof document<"u"&&typeof document.dispatchEvent=="function"&&document.dispatchEvent(new CustomEvent("adt-language-changed",{detail:{language:l.currentLanguage}}))},Yr=(e,t)=>{document.querySelectorAll(`[data-id="${e}"]`).forEach(n=>{if(n)if(n.tagName==="IMG")n.setAttribute("alt",l.translations[t]);else{let a=l.translations[t].replace(/\n/g,"<br>");if(t.endsWith("_easy_read")&&n.closest("nav"))return;n.innerHTML=a}})},ei=(e,t)=>{document.querySelectorAll(`[data-placeholder-id="${e}"]`).forEach(n=>{n&&(n.tagName==="INPUT"||n.tagName==="TEXTAREA")&&n.setAttribute("placeholder",l.translations[t])})},ti=()=>{if(l.eli5Mode){let e=document.querySelector('section[data-id^="sectioneli5"]');if(e){let t=e.getAttribute("data-id"),o=l.translations[t];if(o){let n=document.getElementById("eli5-content-text");n&&(n.innerHTML=o)}}}},oi=async()=>{let e=document.getElementById("language-dropdown");if(!(!e||!window.appConfig||!window.appConfig.languages||!Array.isArray(window.appConfig.languages.available))){e.innerHTML="";for(let t of window.appConfig.languages.available)try{let o=await fetch(`./assets/interface_translations/${t}/interface_translations.json`);if(!o.ok)continue;let a=(await o.json())?.["language-name"]||t,r=document.createElement("option");r.value=t,r.textContent=a,t===l.currentLanguage&&(r.selected=!0),e.appendChild(r)}catch{console.warn(`Could not load interface translations for ${t}`)}}},ni=()=>{let e=document.querySelector("body > .container");e&&(e.classList.remove("opacity-0","invisible"),e.classList.add("opacity-100","visible","transition-opacity","duration-300","ease-in-out"))},f=(e,t={})=>!l.translations||!l.translations[e]?e:l.translations[e].replace(/\${(.*?)}/g,(o,n)=>t[n]??""),to=()=>{let e=document.getElementById("language-dropdown");if(!e){console.error("Language dropdown not found");return}let t=e.value,o=Array.from(e.options),a=(o.findIndex(c=>c.value===t)+1)%o.length,r=o[a].value;e.value=r;let i=new Event("change");e.dispatchEvent(i);let s=o[a].text;O(f("language-changed-to",{language:s}))},ai=async e=>{try{let t=window.appConfig?.bundleVersion||"",o=t?`?v=${t}`:"",[n,a,r]=await Promise.allSettled([fetch(`${e}/texts.json${o}`),fetch(`${e}/audios.json${o}`),fetch(`${e}/videos.json${o}`)]);if(n.status==="fulfilled"&&n.value.ok){let i=await xt(n.value,"texts.json");g("translations",{...l.translations,...i})}else console.warn(`Could not load texts.json from ${e}`);if(a.status==="fulfilled"&&a.value.ok){let i=await xt(a.value,"audios.json");g("audioFiles",{...l.audioFiles,...i})}else console.warn(`Could not load audios.json from ${e}`);if(r.status==="fulfilled"&&r.value.ok){let i=await xt(r.value,"videos.json");g("videoFiles",{...l.videoFiles,...i})}else console.warn(`Could not load videos.json from ${e}`)}catch(t){console.error("Error fetching content files:",t)}}});var Bn={};Me(Bn,{initMatomo:()=>ii,trackActivityCompletion:()=>oo,trackEvent:()=>ge,trackFormSubmission:()=>li,trackNavigation:()=>Et,trackTimeSpent:()=>si,trackToggleEvent:()=>xe});var ri,ii,ge,oo,Et,si,li,xe,Ee=N(()=>{"use strict";ri={siteId:1,trackerUrl:"https://unisitetracker.unicef.io/matomo.php",srcUrl:"https://unisitetracker.unicef.io/matomo.js"},ii=(e={})=>{let t={...ri,...e};window._paq=window._paq||[],window._paq.push(["trackPageView"]),window._paq.push(["enableLinkTracking"]),window._paq.push(["setTrackerUrl",t.trackerUrl]),window._paq.push(["setSiteId",t.siteId]);let o=document.createElement("script");o.type="text/javascript",o.async=!0,o.defer=!0,o.src=t.srcUrl,document.head.appendChild(o)},ge=(e,t,o=null,n=null)=>{window._paq?window._paq.push(["trackEvent",e,t,o,n]):console.warn("Matomo not initialized. Unable to track event.")},oo=(e,t,o=null)=>{ge("Activity","Completion",`${t}: ${e}`,o)},Et=(e,t)=>{ge("Navigation","PageChange",`${e} \u2192 ${t}`)},si=(e,t)=>{ge("Activity","TimeSpent",e,Math.round(t))},li=(e,t)=>{ge("Form","Submission",e,t?1:0)},xe=(e,t)=>{ge("Toggle",t?"Activated":"Deactivated",e)}});function Hn(e){let t=document.activeElement,o=t.tagName==="INPUT"&&t.type!=="checkbox"&&t.type!=="radio"||t.tagName==="TEXTAREA"||t.isContentEditable,n=e.ctrlKey||e.metaKey||e.altKey&&!e.shiftKey;if(o&&!t.id.startsWith("toggle-")||n)return;let a=k("readAloudMode")==="true",r=k("easyReadMode")==="true",i=k("eli5Mode")==="true";if(e.key==="ArrowRight"||e.key==="ArrowLeft"){if(e.preventDefault(),!document.querySelectorAll(".nav__list-link").length)return;e.key==="ArrowRight"?Le():ao();return}switch(e.key){case"x":e.preventDefault(),Ae();break;case"a":e.preventDefault(),re();break;case"z":e.preventDefault(),to();break;case"Escape":e.preventDefault(),xi();break}if(e.altKey&&e.shiftKey){switch(e.code){case"KeyX":e.preventDefault(),Ae();break;case"KeyA":e.preventDefault(),re();break;case"KeyZ":e.preventDefault(),to();break}return}}var $n,ci,Pn,di,ui,Fe,mi,Je,Ze,Mn,_n,Oe,gi,pi,fi,yi,bi,no,On,Fn,Rn,zn,hi,Dn,Ae,vi,Le,ao,xi,jn,Xe=N(()=>{"use strict";de();ue();Ee();D();$n='.nav__list[data-nav-type="pages"]',ci='.nav__list[data-nav-type="toc"]',Pn="navActiveTab",di=["toc","pages"],ui="toc",Fe={pages:[],toc:[]},mi=()=>{let e=k(Pn);return di.includes(e)?e:ui},Je=mi(),Ze=()=>document.querySelector($n),Mn=()=>document.querySelectorAll(`${$n} .nav__list-link`),_n=["text-gray-300","opacity-40","cursor-not-allowed","pointer-events-none"],Oe=(e,t)=>{e&&(t?(e.disabled=!0,e.setAttribute("aria-disabled","true"),e.tabIndex=-1,_n.forEach(o=>e.classList.add(o))):(e.disabled=!1,e.removeAttribute("aria-disabled"),e.tabIndex=0,_n.forEach(o=>e.classList.remove(o))))},gi=()=>{let e=document.getElementById("back-forward-buttons");if(!e||e.classList.contains("hidden"))return;let t=document.getElementById("back-button"),o=document.getElementById("forward-button");if(!t&&!o)return;let n=Array.from(Mn());if(!n.length){Oe(t,!1),Oe(o,!1);return}let a=window.location.pathname.split("/").pop()||"index.html",r=n.findIndex(i=>i.getAttribute("href")===a);if(r===-1){Oe(t,!1),Oe(o,!1);return}Oe(t,r===0),Oe(o,r===n.length-1)},pi=e=>Array.isArray(e)?e.map((t,o)=>{let n=t?.page_number??null,a=o+1,r=a===1?`${a} (Cover)`:String(a);return{...t,page_label:String(a),sequential_index:a,pdf_page_number:n,display_label:r}}):[],fi=()=>{yi(),bi(),no(Je)},yi=()=>{let e=document.querySelector(ci);e&&(e.innerHTML="",Fe.toc.forEach((t,o)=>{let n=document.createElement("li");n.classList.add("nav__list-item","border-b","border-gray-300","flex","items-center");let a=document.createElement("a");a.classList.add("nav__toc-link","flex-grow","flex","items-center","w-full","h-full","p-2","py-3","hover:bg-blue-50","transition","text-gray-700"),a.href=t.href,t.chapter_id&&a.setAttribute("data-text-id",t.chapter_id);let r=t.title||t.chapter_id||t.href,i=`${o+1}.`,s=document.createElement("span");s.classList.add("text-gray-500","font-semibold","mr-3","tabular-nums"),s.textContent=i;let c=document.createElement("span");t.chapter_id&&c.setAttribute("data-id",t.chapter_id),c.classList.add("inline","text-gray-800"),c.textContent=r,a.setAttribute("aria-label",`${i} ${r}`),a.appendChild(s),a.appendChild(c),n.appendChild(a),e.appendChild(n)}))},bi=()=>{let e=Ze();if(!e||(e.innerHTML="",!Fe.pages?.length))return;let t=Fe.toc.reduce((n,a,r)=>(a?.section_id&&(n[a.section_id]={...a,displayTitle:a.title||a.chapter_id||a.href,index:r+1}),n),{}),o=new Set;Fe.pages.forEach(n=>{let a=t[n.section_id];if(a&&!o.has(a.section_id)){let u=document.createElement("li");u.classList.add("nav__list-heading","px-2","pt-4","pb-2","text-xs","font-semibold","tracking-wide","text-gray-500","uppercase"),u.dataset.chapterId=a.chapter_id||"";let m=a.index?`${a.index}. ${a.displayTitle}`:a.displayTitle;u.textContent=m,e.appendChild(u),o.add(a.section_id)}let r=n.page_label||String(n.sequential_index||1),i=n.display_label||r,s=n.pdf_page_number!==void 0&&n.pdf_page_number!==null?String(n.pdf_page_number):"",c=document.createElement("li");c.classList.add("nav__list-item"),c.dataset.sectionId=n.section_id;let d=document.createElement("a");d.classList.add("nav__list-link"),d.href=n.href,d.dataset.pageNumber=r,d.dataset.sectionIndex=(n.sequential_index||r).toString(),d.dataset.pageLabel=r,d.dataset.pageDisplayLabel=i,d.dataset.sectionId=n.section_id,s?(d.dataset.pdfPage=s,d.setAttribute("aria-label",`Page ${r}, Print page ${s}`)):(delete d.dataset.pdfPage,d.setAttribute("aria-label",`Page ${r}`)),d.textContent=i,c.appendChild(d),e.appendChild(c)}),Re()},no=e=>{if(!e)return;let t=Je;if(t){let r=document.querySelector(`[data-nav-panel="${t}"]`)?.querySelector(".nav__list");r&&I(`navScrollPosition-${t}`,r.scrollTop,7)}Je=e,I(Pn,Je,7);let o=document.querySelectorAll("[data-nav-tab]"),n=document.querySelectorAll("[data-nav-panel]");o.forEach(a=>{let r=a.dataset.navTab===e;a.setAttribute("aria-selected",r?"true":"false"),a.classList.toggle("bg-white",r),a.classList.toggle("text-gray-900",r),a.classList.toggle("shadow",r),a.classList.toggle("text-gray-500",!r)}),n.forEach(a=>{let r=a.dataset.navPanel===e;if(a.classList.toggle("hidden",!r),a.setAttribute("aria-hidden",(!r).toString()),r){let i=a.querySelector(".nav__list");if(i){let s=k(`navScrollPosition-${e}`);s&&(i.scrollTop=parseInt(s,10))}}})},On=()=>{let e=document.querySelectorAll("[data-nav-tab]");e.length&&(e.forEach(t=>{t.addEventListener("click",()=>no(t.dataset.navTab))}),no(Je))},Fn=({pages:e=[],toc:t=[]})=>{let o=Array.isArray(e)?e:[];Fe={pages:pi(o),toc:Array.isArray(t)?t:[]},fi(),gi()},Rn=()=>Fe,zn=e=>{let t=e.target.closest(".nav__list-link, .nav__toc-link");if(t||e.target.id==="back-button"||e.target.id==="forward-button"){e.preventDefault();let n=t||e.target,a=n.href||n.getAttribute("data-href");if(!a){console.error("Navigation target URL is null or undefined for element:",n);return}ie(),hi();let r=document.querySelector("body > .container");r&&r.classList.add("opacity-0"),setTimeout(()=>{window.location.href=a},150)}},hi=()=>{let e={sidebarState:k("sidebarState"),scrollPosition:window.scrollY,navScrollPosition:Ze()?.scrollTop||0};sessionStorage.setItem("pageState",JSON.stringify(e))},Dn=(e,t)=>{t&&t.setAttribute("aria-expanded",e?"true":"false")},Ae=(e=null)=>{let t=document.getElementById("navPopup"),o=Ze(),n=Mn(),a=document.querySelector(".nav__toggle");if(!o||!a||!n||!t)return;let r=typeof e=="boolean"?e:null,i;r!==null?i=!r:i=k("navState")==="open";let s=window.location.pathname.split("/").pop()||"index.html";At(!i),Dn(!i,a),vi(!i,s,n,o)},vi=(e,t,o,n)=>{if(!e||!n)return;let a=Array.from(o).find(r=>r.getAttribute("href")===t);a&&(a.setAttribute("tabindex","0"),setTimeout(()=>{let r=a.getBoundingClientRect(),i=n.getBoundingClientRect();r.top>=i.top&&r.bottom<=i.bottom||a.scrollIntoView({behavior:"smooth",block:"center"}),a.focus({preventScroll:!0})},100))},Le=()=>{let e=window.location.href.split("/").pop()||"index.html",t=Array.from(document.querySelectorAll(".nav__list-link")),o=t.findIndex(n=>n.getAttribute("href")===e);if(o>=0&&o<t.length-1){let a=Ze()?.scrollTop||0,r=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1);I("navScrollPosition",a,7,r),ie();let i=document.querySelector("body > .container");i&&i.classList.add("opacity-0");let s=t[o+1].getAttribute("href"),c=s.split("/").pop();Et(e,c),setTimeout(()=>{window.location.href=s},150)}},ao=()=>{let e=window.location.href.split("/").pop()||"index.html",t=Array.from(document.querySelectorAll(".nav__list-link")),o=t.findIndex(n=>n.getAttribute("href")===e);if(o>0){let a=Ze()?.scrollTop||0,r=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1);I("navScrollPosition",a,7,r),ie();let i=document.querySelector("body > .container");i&&i.classList.add("opacity-0");let s=t[o-1].getAttribute("href"),c=s.split("/").pop().split(".")[0];Et(e,c),setTimeout(()=>{window.location.href=s},150)}};xi=()=>{let e=document.getElementById("navPopup"),t=document.querySelector(".nav__toggle"),o=document.getElementById("sidebar"),n=document.querySelector("body .container");e&&e.getAttribute("aria-expanded")==="true"?(At(!1),Dn(!1,t)):o&&o.getAttribute("aria-expanded")==="true"&&re(),n&&(n.setAttribute("tabindex","-1"),n.focus())},jn=()=>{document.addEventListener("click",e=>{let t=document.getElementById("navPopup"),o=document.getElementById("sidebar"),n=document.querySelector(".nav__toggle"),a=document.getElementById("open-sidebar"),r=document.querySelector("body > .container"),i=t&&t.getAttribute("aria-expanded")==="true",s=o&&o.getAttribute("aria-expanded")==="true";if(!i&&!s)return;let c=i&&!t.contains(e.target)&&(!n||!n.contains(e.target)),d=s&&!o.contains(e.target)&&(!a||!a.contains(e.target));if(c&&Ae(),d&&re(),(c||d)&&r){r.setAttribute("tabindex","-1"),r.focus();try{let{announceToScreenReader:u}=(Y(),Kr(Wn));u("Men\xFA cerrado")}catch{}}})}});async function U(e){try{let o="unicefadttest@gmail.com",n=document.querySelectorAll(".fa-pen-to-square"),a=window.location.href;n.forEach((E,P)=>{if(E.classList.contains("fa-pen-to-square")&&E.classList.contains("text-blue-700")&&E.classList.contains("mr-2")){let Z=E.parentElement;if(Z){let $e=Z.querySelector("span");if($e){let Pe=$e.innerText.trim(),ce=JSON.parse(localStorage.getItem("instructionPage"));Array.isArray(ce)||(ce=[]),ce.some(Ut=>Ut.text===Pe)||(ce.push({number:ce.length+1,text:Pe}),localStorage.setItem("instructionPage",JSON.stringify(ce)))}}}});let r=location.pathname.split("/").pop().split(".")[0],i=r.replace(/_/g,".").split(".").slice(0,2),s=parseInt(i[0],10),c=parseInt(i[1],10),d=s===0?0:s-1,u=c+1,m=`${d}.${u}`,y=localStorage.getItem("namePage"),p=JSON.parse(localStorage.getItem("instructionPage"))||[],h=localStorage.getItem(r+"-intentos"),x={};for(let E=0;E<localStorage.length;E++){let P=localStorage.key(E);P.startsWith(r)&&!P.includes("-intentos")&&!P.includes("_succes")&&(x[P]=localStorage.getItem(P))}let v=p.length>0?p.map(E=>`<h3><strong>Instrucci\xF3n ${E.number}</strong>: ${E.text}</h3>`).join(""):"<p>No hay instrucciones en esta pagina</p>",T=JSON.parse(localStorage.getItem("completedActivities")||"[]"),L=T.map(E=>{let P=E.replace(/_/g,".").split(".").slice(0,2),Z=parseInt(P[0],10),$e=parseInt(P[1],10),Pe=Z===0?0:Z-1,ce=$e+1,Sn=`${Pe}.${ce}`,Ut=Pe*100+ce,bt=E.match(/^[^\-]+-([^-\d]+)-(\d+)-(.+)$/),wn="",In="",Cn="";return bt&&(wn=bt[1].trim(),In=bt[2],Cn=bt[3].trim()),{id:E,pageNumber:Sn,name:wn,sortValue:Ut,intent:In,time:Cn}});L.sort((E,P)=>E.sortValue-P.sortValue);let w=T.length>0?`<ul>${L.map(E=>`
          <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr>
              <th style="padding: 8px; border: 1px solid #ddd;"> <strong>P\xE1gina ${E.pageNumber}</strong>: ${E.name} </th>
              <th style="padding: 8px; border: 1px solid #ddd;">Intentos: ${E.intent}</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Time Completed: ${E.time}</th>
          </table>`).join("")}</ul>`:"<p>No hay actividades completadas a\xFAn.</p>",B=localStorage.getItem("nameUser"),R="",Q=localStorage.getItem("studentID")||"unknown-student",C=localStorage.getItem("characterInfo");if(C)try{R=JSON.parse(C).emoji||""}catch(E){console.error("Error parsing character information:",E)}if(!B){let Z=function(){let $e=E[Math.floor(Math.random()*E.length)];return`${P[Math.floor(Math.random()*P.length)]} ${$e}`};var t=Z;let E=["R\xE1pido","Feroz","Dulce","Elegante","Intr\xE9pido"],P=["Tigre","\xC1guila","Lobo","Jaguar","Puma"];B=Z(),localStorage.setItem("nameUser",B)}let M="";switch(e){case b.MULTIPLE_CHOICE:case b.QUIZ:{let E=e===b.QUIZ?"Quiz interactivo":"Opci\xF3n m\xFAltiple";M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3 style="color: #333;">P\xE1gina: ${m} </h3>
          <h4>Tipo: ${E}</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>


         <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Estado</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Completado \u2705</th>
          </table>

          <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break}case b.FILL_IN_THE_BLANK:M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3 style="color: #333;">P\xE1gina: ${m} </h3>
          <h4>Tipo: Completar espacios en blanco</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>

           <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Estado</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Completado \u2705</th>
          </table>

          <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break;case b.OPEN_ENDED_ANSWER:M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3 style="color: #333;">P\xE1gina: ${m} </h3>
          <h4>Tipo: Respuesta abierta</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>

          <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Pregunta</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Respuesta</th>
              ${Object.entries(x).map(([E,P])=>[E.slice(-1),P]).sort((E,P)=>Number(E[0])-Number(P[0])).map(([E,P],Z)=>`<tr><td>${Z}</td><td>${P}</td></tr>`).join("")}
            </table>
         
           <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break;case b.SORTING:M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3 style="color: #333;">P\xE1gina: ${m} </h3>
          <h4 style="color: #555;">Tipo: Ordenar elementos</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>

          <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Estado</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Completado \u2705</th>
          </table>

          <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break;case b.MATCHING:M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3>P\xE1gina: ${m}</h3>
          <h4>Tipo: Relacionar columnas</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>


         <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Estado</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Completado \u2705</th>
          </table>

          <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break;case b.TRUE_FALSE:M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3>P\xE1gina: ${m}</h3>
          <h4>Tipo: Verdadero o falso</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>


           <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Estado</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Completado \u2705</th>
          </table>

          <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break;case b.FILL_IN_A_TABLE:M=`
          <h2 style="color: #4CAF50; text-align: center;">Respuesta del alumno ${R} ${B}</h2>
          <h3 style="text-align: center;">Actividad: <a href="${a}">${y}</a></h3>
          <h3 style="color: #333;">${v} </h3>
          <h3>P\xE1gina: ${m}</h3>
          <h4>Tipo: Completar tabla</h4>
          <h4 style="color: #555;">Intentos: ${h}</h4>


          <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
            <tr style="background-color: #4CAF50; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Pregunta</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Respuesta</th>
              ${Object.entries(x).map(([E,P])=>[E.slice(-1),P]).sort((E,P)=>Number(E[0])-Number(P[0])).map(([E,P],Z)=>`<tr><td>${Z}</td><td>${P}</td></tr>`).join("")}
            </table>
         
          <h3 style="color: #333; margin-top: 15px;">\u{1F4CC} Actividades completadas:</h3>
          <div style="background-color: #e9f7e5; padding: 10px; border-radius: 5px;">
            ${w}
          </div>
        `;break;default:alert("\u274C Tipo de actividad no reconocido.");return}let le="",Vt={sender:{name:B,email:"testmailadtunicef@gmail.com"},to:[{email:o}],subject:`Respuesta de estudiante [ID: ${Q}]`,htmlContent:M}}catch(o){console.error("\u274C Error en el env\xEDo del correo:",o)}localStorage.removeItem("instructionPage")}var pe=N(()=>{"use strict";j()});var Vn,Un=N(()=>{"use strict";Vn=e=>{if(!e)return!1;let t=e.tagName?.toLowerCase();return["input","textarea","select","button"].includes(t)?!0:!!e.isContentEditable}});var Lt,Ei,Gn,Ai,Li,Si,St,ro,wi,Ii,Kn,io,Qn,Ci,ki,so=N(()=>{"use strict";z();H();j();D();pe();ze();Un();Lt=null,Ei=()=>{let e=document.getElementById("submit-button");!e||e.dataset.submitState!=="retry"||(e.textContent=f("submit-text"),e.setAttribute("aria-label",f("submit-text")),e.dataset.submitState="submit",l.retryHandler&&(e.removeEventListener("click",l.retryHandler),l.retryHandler=null),l.validateHandler&&(e.removeEventListener("click",l.validateHandler),e.addEventListener("click",l.validateHandler)))},Gn=e=>{Li(e),e.querySelectorAll(".activity-option").forEach(r=>{let i=r.cloneNode(!0);r.parentNode.replaceChild(i,r)}),e.querySelectorAll(".activity-option").forEach(r=>{r.addEventListener("click",()=>ro(r)),r.addEventListener("keydown",u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),ro(r))});let i=r.querySelector(".option-letter")?.textContent||"",s=r.querySelector("img")?.alt||"",c=r.querySelector('input[type="radio"]');c&&c.setAttribute("tabindex","-1"),r.setAttribute("aria-label",`Option ${i}: ${s}`),r.setAttribute("role","radio"),r.setAttribute("aria-checked","false"),r.classList.add("cursor-pointer","transition-all","duration-200","hover:shadow-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-opacity-50");let d=r.querySelector("span");d&&d.classList.add("px-4","py-2","rounded-full","font-medium","transition-colors","duration-200")});let o=e.querySelector('[role="group"]');if(o){o.setAttribute("role","radiogroup"),o.setAttribute("aria-labelledby","question-label");let r=o.querySelector(".quiz-shortcut-hint");r||(r=document.createElement("p"),r.className="quiz-shortcut-hint sr-only",r.setAttribute("aria-live","polite"),o.prepend(r)),r.textContent=f("quiz-shortcut-hint")}let n=[...e.querySelectorAll(".activity-option")],a=r=>{if(Vn(r.target))return;let i=parseInt(r.key,10);if(i>=1&&i<=n.length)r.preventDefault(),ro(n[i-1]);else if(r.key==="Enter"){let s=document.getElementById("submit-button");s&&(r.preventDefault(),s.click())}};Lt&&document.removeEventListener("keydown",Lt),Lt=a,document.addEventListener("keydown",Lt)},Ai=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.closest("[data-area-id]")?.getAttribute("data-area-id")||"default",n=`${t}_${o}_multipleChoice`,a={question:e.getAttribute("data-activity-item"),value:e.querySelector('input[type="radio"]').value,areaId:o};localStorage.setItem(n,JSON.stringify(a))},Li=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.querySelector("[data-area-id]")?.getAttribute("data-area-id")||"default",n=`${t}_${o}_multipleChoice`,a=localStorage.getItem(n);if(a){let{value:r}=JSON.parse(a),i=[...e.querySelectorAll(".activity-option")].find(s=>s.querySelector('input[type="radio"]').value===r);i&&(Kn(i),g("selectedOption",i))}},Si=e=>{let t=e.querySelector(".option-letter"),o=t?.parentElement;return t?.dataset.letterHidden==="true"||o?.dataset.letterHidden==="true"},St=(e,t,o)=>{let n=e.querySelector(".option-letter"),a=n?.parentElement;if(!(!n||!a)){if(Si(e)){a.className="option-letter-wrapper sr-only",n.className="option-letter sr-only";return}t&&(a.className=t),o&&(n.className=o)}},ro=e=>{wi();let t=io(e),o=e.closest('[role="radiogroup"]')||e.closest('[role="group"]');if(!o)return;Ii(o),Kn(e),g("selectedOption",e),o.querySelectorAll(".activity-option").forEach(i=>{i.setAttribute("aria-checked","false")}),e.setAttribute("aria-checked","true");let n=e.querySelector(".option-letter")?.textContent||"",a=document.getElementById("validation-results-announcement");a&&(a.setAttribute("aria-live","polite"),a.textContent=`Option ${n} selected`,setTimeout(()=>{a.textContent=""},1e3)),Ai(e),Ei();let r=o?.querySelector(".quiz-shortcut-hint");r&&(r.textContent=f("quiz-shortcut-hint"))},wi=()=>{document.querySelectorAll(".validation-mark").forEach(t=>{t.classList.add("hidden"),t.textContent=""}),document.querySelectorAll(".activity-option").forEach(t=>{t.classList.remove("bg-green-50","bg-red-50"),t.removeAttribute("aria-invalid");let o=t.querySelector(".feedback-container");if(o){o.classList.add("hidden");let n=o.querySelector(".feedback-icon"),a=o.querySelector(".feedback-text");n&&(n.className="feedback-icon",n.textContent=""),a&&(a.className="feedback-text",a.textContent="")}St(t,"w-8 h-8 aspect-square rounded-full border-2 border-gray-300 flex items-center justify-center","option-letter text-gray-500"),t.classList.remove("selected-option")});let e=document.getElementById("validation-results-announcement");e&&(e.textContent=f("selection-changed-resubmit"))},Ii=e=>{e.querySelectorAll(".activity-option").forEach(t=>{t.setAttribute("aria-checked","false"),St(t,"w-8 h-8 aspect-square rounded-full border-2 border-gray-300 flex items-center justify-center","option-letter text-gray-500"),t.classList.remove("bg-green-50","bg-red-50"),t.classList.remove("selected-option");let o=t.querySelector(".feedback-container");o&&o.classList.add("hidden")})},Kn=e=>{let t=e.querySelector('input[type="radio"]');t&&(t.checked=!0),e.setAttribute("aria-checked","true"),St(e,"w-8 h-8 aspect-square rounded-full border-2 border-blue-500 bg-blue-500 flex items-center justify-center","option-letter text-white"),e.classList.add("selected-option")},io=e=>{let t=e.getAttribute("data-activity-item");if(!t){let o=e.querySelector('input[type="radio"]');if(o&&(t=o.getAttribute("data-activity-item")),e.tagName==="INPUT"){let n=e.closest(".activity-option");n&&(t=n.getAttribute("data-activity-item")||t)}}return t},Qn=()=>{if(!l.selectedOption){let n=document.getElementById("validation-results-announcement");n&&(n.setAttribute("aria-live","assertive"),n.textContent=f("select-option-first"),setTimeout(()=>{n.textContent=""},3e3));return}let e=l.selectedOption.querySelector('input[type="radio"]'),t=io(l.selectedOption),o=correctAnswers[t];Ci(l.selectedOption,o),ki(l.selectedOption,o),typeof J=="function"&&J(),W(o,f("next-activity"),b.MULTIPLE_CHOICE)},Ci=(e,t)=>{e.classList.remove("selected-option"),St(e,`w-8 h-8 aspect-square rounded-full border-2 flex items-center justify-center ${t?"border-green-500 bg-green-500 text-white":"border-red-500 bg-red-500 text-white"}`,"option-letter text-white"),e.classList.add(t?"bg-green-50":"bg-red-50"),e.setAttribute("aria-invalid",t?"false":"true")},ki=(e,t)=>{let o=e.querySelector(".feedback-container");if(!o){console.warn("Feedback container not found for option:",e);return}let n=o.querySelector(".feedback-icon"),a=o.querySelector(".feedback-text");if(!n||!a){console.warn("Feedback children missing for option:",e);return}o.classList.remove("hidden");let r=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],i=r+"-intentos",s=localStorage.getItem(i);s===null?(localStorage.setItem(i,"0"),s=0):s=parseInt(s,10),s++,localStorage.setItem(i,s.toString());let c=e.getAttribute("data-explanation"),d=window?.multipleChoiceExplanations?.[io(e)],u=c||d;if(t){n.className="feedback-icon hidden",n.textContent="",a.className="feedback-text text-lg font-semibold text-green-800",u?a.textContent=u:a.textContent=f("multiple-choice-correct-answer"),o.setAttribute("role","status"),o.setAttribute("aria-live","polite"),A("success");let m=localStorage.getItem("completedActivities"),y=m?JSON.parse(m):[],p=localStorage.getItem("namePage"),h=new Date().toLocaleString("es-ES"),x=`${r}-${p}-${s}-${h}`;y=y.filter(v=>!v.startsWith(`${r}-`)),y.push(x),localStorage.setItem("completedActivities",JSON.stringify(y)),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page"),U(b.MULTIPLE_CHOICE)}else n.className="feedback-icon hidden",n.textContent="",a.className="feedback-text text-lg font-semibold text-red-800",u?a.textContent=u:a.textContent=f("multiple-choice-try-again"),o.setAttribute("role","alert"),A("error")}});var De,Ti,Ni,qi,Jn,uo,mo,ea,Bi,_i,$i,Pi,Zn,Xn,Mi,wt,Oi,ta,Fi,Ri,zi,It,oa,Di,na,aa,Yn,ra,lo,Hi,ji,Wi,Vi,co,Ui,Gi,Ki,go,Qi,ia,sa,Ji,Zi,Xi,la,Ct=N(()=>{"use strict";z();H();j();D();pe();ze();Y();De='section[role="activity"][data-section-type="activity_quiz"]',Ti="quiz-correct-answers",Ni="quiz-explanations",qi=["1","2","3"],Jn=!1,uo=()=>document.getElementById("submit-button"),mo=()=>{let e=uo();e&&(e.setAttribute("disabled","true"),e.setAttribute("aria-disabled","true"),e.setAttribute("tabindex","-1"),e.classList.add("opacity-50","cursor-not-allowed"))},ea=()=>{let e=uo();e&&(e.removeAttribute("disabled"),e.removeAttribute("aria-disabled"),e.removeAttribute("tabindex"),e.classList.remove("opacity-50","cursor-not-allowed"))},Bi=()=>{let e=uo();e&&(e.classList.remove("hidden"),e.removeAttribute("aria-hidden"),e.removeAttribute("tabindex"),requestAnimationFrame(()=>{if(typeof e.focus=="function")try{e.focus({preventScroll:!0})}catch{e.focus()}}))},_i=()=>{let e=document.querySelector(De);if(!e)return;let t=e.querySelector(".activity-option");if(!t)return;let n=t.querySelector('input[type="radio"]')||t;requestAnimationFrame(()=>{if(typeof n.focus=="function")try{n.focus({preventScroll:!0})}catch{n.focus()}})},$i=()=>{if(document.getElementById("validation-results-announcement"))return;let e=document.createElement("div");e.id="validation-results-announcement",e.className="sr-only",e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),document.body.appendChild(e)},Pi=()=>{document.body.style.backgroundColor="#FFFAF5"},Zn=e=>{let t=document.getElementById(e);if(!t||!t.textContent)return null;try{return JSON.parse(t.textContent)}catch(o){return console.warn(`activity_quiz: unable to parse JSON for ${e}`,o),null}},Xn=(e,t)=>{if(!t||typeof t!="object")return;let o=window[e]||{};window[e]={...o,...t}},Mi=()=>{let e=Zn(Ti);Xn("correctAnswers",e);let t=Zn(Ni);Xn("multipleChoiceExplanations",t)},wt=()=>location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],Oi=e=>e.closest("[data-area-id]")?.getAttribute("data-area-id")||"default",ta=()=>{let e=document.getElementById("submit-button");!e||e.dataset.submitState!=="retry"||(e.textContent=f("submit-text"),e.setAttribute("aria-label",f("submit-text")),e.dataset.submitState="submit",l.retryHandler&&(e.removeEventListener("click",l.retryHandler),l.retryHandler=null),l.validateHandler&&(e.removeEventListener("click",l.validateHandler),e.addEventListener("click",l.validateHandler)))},Fi=e=>{let t=wt(),o=Oi(e),n=`${t}_${o}_quiz`,a={question:e.getAttribute("data-activity-item"),value:e.querySelector('input[type="radio"]').value,areaId:o};localStorage.setItem(n,JSON.stringify(a))},Ri=e=>{let t=wt(),o=e.querySelector("[data-area-id]")?.getAttribute("data-area-id")||"default",n=`${t}_${o}_quiz`,a=localStorage.getItem(n);if(a){let{value:r}=JSON.parse(a),i=[...e.querySelectorAll(".activity-option")].find(s=>s.querySelector('input[type="radio"]').value===r);if(i){na(i),g("quizSelectedOption",i),ea();return}}mo()},zi=e=>{let t=e.querySelector(".option-letter"),o=t?.parentElement;return t?.dataset.letterHidden==="true"||o?.dataset.letterHidden==="true"},It=(e,t,o)=>{let n=e.querySelector(".option-letter"),a=n?.parentElement;if(!(!n||!a)){if(zi(e)){a.className="option-letter-wrapper sr-only",n.className="option-letter sr-only";return}t&&(a.className=t),o&&(n.className=o)}},oa=()=>{let e=document.querySelector(De)||document,t=!1;e.querySelectorAll(".validation-mark").forEach(n=>{n.classList.add("hidden"),n.textContent=""}),e.querySelectorAll(".activity-option").forEach(n=>{n.classList.remove("bg-green-50","bg-red-50","selected-option"),n.removeAttribute("aria-invalid");let a=n.querySelector(".feedback-container");if(a){a.classList.add("hidden");let r=a.querySelector(".feedback-icon"),i=a.querySelector(".feedback-text");if(r){let s=n.querySelector('input[type="radio"]');s&&s.setAttribute("tabindex","-1"),r.className="feedback-icon",r.textContent=""}i&&(i.className="feedback-text",i.textContent="",i.hasAttribute("data-id")&&(i.removeAttribute("data-id"),t=!0))}It(n,"w-8 h-8 aspect-square rounded-full border-2 border-gray-300 flex items-center justify-center","option-letter text-gray-500")});let o=document.getElementById("validation-results-announcement");o&&(o.textContent=f("selection-changed-resubmit")),t&&me()},Di=e=>{e.querySelectorAll(".activity-option").forEach(t=>{t.setAttribute("aria-checked","false"),It(t,"w-8 h-8 aspect-square rounded-full border-2 border-gray-300 flex items-center justify-center","option-letter text-gray-500"),t.classList.remove("bg-green-50","bg-red-50","selected-option");let o=t.querySelector(".feedback-container");o&&o.classList.add("hidden")})},na=e=>{let t=e.querySelector('input[type="radio"]');t&&(t.checked=!0),e.setAttribute("aria-checked","true"),It(e,"w-8 h-8 aspect-square rounded-full border-2 border-blue-500 bg-blue-500 flex items-center justify-center","option-letter text-white"),e.classList.add("selected-option")},aa=e=>{let t=e.getAttribute("data-activity-item");if(!t){let o=e.querySelector('input[type="radio"]');if(o&&(t=o.getAttribute("data-activity-item")),e.tagName==="INPUT"){let n=e.closest(".activity-option");n&&(t=n.getAttribute("data-activity-item")||t)}}return t},Yn=e=>{if(!e)return null;let t=f(e);return t&&(l?.translations&&Object.prototype.hasOwnProperty.call(l.translations,e)||t!==e)?t:null},ra=e=>{if(!e)return{text:null,id:null};let t=e.getAttribute("data-explanation-id"),o=Yn(t);if(o)return console.debug("activity_quiz: resolved explanation via data attribute",{explanationId:t,source:"data-explanation-id"}),{text:o,id:t};let n=aa(e),a=window?.multipleChoiceExplanations?.[n],r=Yn(a);if(r)return console.debug("activity_quiz: resolved explanation via global map",{activityItem:n,explanationId:a}),{text:r,id:a};if(a)return console.debug("activity_quiz: using untranslated global explanation",{activityItem:n,explanationId:a}),{text:a,id:null};let i=e.getAttribute("data-explanation");return i&&console.debug("activity_quiz: using inline fallback explanation",{activityItem:n,fallbackExplanation:i}),{text:i||null,id:null}},lo=(e,t)=>{if(!e)return!1;let o=e.getAttribute("data-id"),n=t??null;t?e.setAttribute("data-id",t):e.removeAttribute("data-id");let a=o!==n;return a&&console.debug("activity_quiz: updated feedback audio binding",{previousId:o,explanationId:n}),a},Hi=e=>{if(!e||!l?.audioFiles)return null;let t=l.audioFiles[e];return t?`content/i18n/${l.currentLanguage||window.appConfig&&window.appConfig.languages&&window.appConfig.languages.default||"es"}/audio/${t}`:null},ji=(e,t)=>{if(!e)return!1;let o=Hi(t);if(!o)return console.debug("activity_quiz: explanation audio unavailable",{explanationId:t,hasAudioFiles:!!l?.audioFiles}),!1;$();let n=new Audio(o);n.playbackRate=parseFloat(l.audioSpeed)||1;let a=!!l.readAloudMode;a||console.debug("activity_quiz: playing explanation audio with read aloud disabled"),a&&Se(e),g("currentAudio",n),g("isPlaying",!0),a&&oe(!0),console.debug("activity_quiz: playing explanation audio",{explanationId:t,audioSrc:o,playbackRate:n.playbackRate});let r=()=>{a&&(fe(e),oe(!1)),l.currentAudio===n&&g("currentAudio",null),g("isPlaying",!1)};return n.addEventListener("ended",r,{once:!0}),n.addEventListener("error",r,{once:!0}),n.play().catch(i=>{console.warn("activity_quiz: explanation audio playback failed",i),r()}),!0},Wi=()=>{let e=document.querySelector(De);if(!e)return;let t=!1;e.querySelectorAll(".activity-option").forEach(o=>{let n=o.querySelector(".feedback-container");if(!n||n.classList.contains("hidden"))return;let a=n.querySelector(".feedback-text");if(!a)return;let{text:r,id:i}=ra(o),c=o.getAttribute("aria-invalid")==="false",d=f(c?"multiple-choice-correct-answer":"multiple-choice-try-again");a.textContent=r||d,console.debug("activity_quiz: feedback text reapplied during language change",{optionId:o.getAttribute("data-activity-item"),explanationId:i,text:a.textContent});let u=lo(a,i);t=t||u}),t&&me()},Vi=e=>{let t=e.querySelector(".option-letter")?.textContent?.trim()||"",o=e.querySelector(".option-text")?.textContent?.trim()||"",n=document.getElementById("validation-results-announcement");n&&(n.setAttribute("aria-live","polite"),t?n.textContent=`Option ${t} selected`:o?n.textContent=`Selected ${o}`:n.textContent="Option selected",setTimeout(()=>{n.textContent=""},1e3))},co=e=>{oa();let t=e.closest('[role="radiogroup"]')||e.closest('[role="group"]');t&&(Di(t),na(e),g("quizSelectedOption",e),A("drop"),t.querySelectorAll(".activity-option").forEach(o=>o.setAttribute("aria-checked","false")),e.setAttribute("aria-checked","true"),Vi(e),Fi(e),ea(),Bi(),ta())},Ui=e=>{if(!e)return!1;let t=e.tagName?.toLowerCase();return["input","textarea","select"].includes(t)?!0:!!e.isContentEditable},Gi=e=>{if(!qi.includes(e.key)||Ui(e.target))return;let t=document.querySelector(De);if(!t)return;let o=t.querySelectorAll(".activity-option"),n=Number(e.key)-1,a=o[n];a&&(e.preventDefault(),e.stopPropagation(),co(a))},Ki=()=>{Jn||(document.addEventListener("keydown",Gi),Jn=!0)},go=e=>{let t=document.querySelector(De);t&&(t.querySelectorAll('input[type="radio"]').forEach(o=>{o.checked=!1}),t.querySelectorAll(".activity-option").forEach(o=>{o.setAttribute("aria-checked","false")}),oa(),g("quizSelectedOption",null),mo(),Object.keys(localStorage).filter(o=>o.startsWith(`${e}_`)&&o.endsWith("_quiz")).forEach(o=>localStorage.removeItem(o)))},Qi=()=>{let e=document.getElementById("submit-button");if(!e)return;l.retryHandler&&e.removeEventListener("click",l.retryHandler);let t=()=>{A("reset");let o=wt();go(o),ta(),_i()};l.retryHandler=t,e.addEventListener("click",t,{once:!1})},ia=e=>{g("quizSelectedOption",null),Ri(e),e.querySelectorAll(".activity-option").forEach(n=>{let a=n.cloneNode(!0);n.parentNode.replaceChild(a,n)}),e.querySelectorAll(".activity-option").forEach(n=>{n.addEventListener("click",()=>co(n)),n.addEventListener("keydown",u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),co(n))});let a=n.querySelector(".option-text")?.textContent?.trim()||"",r=n.querySelector("img")?.alt?.trim()||"",i=n.querySelector('input[type="radio"]');i&&i.setAttribute("tabindex","-1");let s=[];a&&s.push(a),r&&r!==a&&s.push(r);let c=s.join(" ").trim()||"Option";n.setAttribute("aria-label",c),n.setAttribute("role","radio"),n.setAttribute("aria-checked","false"),n.classList.add("cursor-pointer","transition-all","duration-200","hover:shadow-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-opacity-50");let d=n.querySelector("span");d&&d.classList.add("px-4","py-2","rounded-full","font-medium","transition-colors","duration-200")});let o=e.querySelector('[role="group"]');if(o){o.setAttribute("role","radiogroup"),o.setAttribute("aria-labelledby","question-label");let n=o.querySelector(".quiz-shortcut-hint");n||(n=document.createElement("p"),n.className="quiz-shortcut-hint sr-only",n.setAttribute("aria-live","polite"),o.prepend(n)),n.textContent=f("quiz-shortcut-hint")}Ki()},sa=()=>{if(!l.quizSelectedOption){let o=document.getElementById("validation-results-announcement");o&&(o.setAttribute("aria-live","assertive"),o.textContent=f("select-option-first"),setTimeout(()=>{o.textContent=""},3e3));return}let e=aa(l.quizSelectedOption),t=correctAnswers[e];Ji(l.quizSelectedOption,t),Xi(l.quizSelectedOption,t),typeof J=="function"&&J(),W(t,f("next-activity"),b.QUIZ),t||Qi()},Ji=(e,t)=>{e.classList.remove("selected-option"),It(e,`w-8 h-8 aspect-square rounded-full border-2 flex items-center justify-center ${t?"border-green-500 bg-green-500 text-white":"border-red-500 bg-red-500 text-white"}`,"option-letter text-white"),e.classList.add(t?"bg-green-50":"bg-red-50"),e.setAttribute("aria-invalid",t?"false":"true")},Zi=(e,t,o)=>{let a=A(e?"success":"error");if(!l.readAloudMode)return;let r=()=>{ji(t,o)};a&&typeof a.addEventListener=="function"?a.addEventListener("ended",r,{once:!0}):r()},Xi=(e,t)=>{let o=e.querySelector(".feedback-container");if(!o)return;let n=o.querySelector(".feedback-icon"),a=o.querySelector(".feedback-text");if(!n||!a)return;o.classList.remove("hidden");let r=wt(),i=`${r}-intentos`,s=parseInt(localStorage.getItem(i)||"0",10);s+=1,localStorage.setItem(i,s.toString());let{text:c,id:d}=ra(e),u=!1;if(t){n.className="feedback-icon hidden",n.textContent="",a.className="feedback-text text-lg font-semibold text-green-800",a.textContent=c||f("multiple-choice-correct-answer"),u=lo(a,d)||u,o.setAttribute("role","status"),o.setAttribute("aria-live","polite");let m=localStorage.getItem("completedActivities"),y=m?JSON.parse(m):[],p=localStorage.getItem("namePage"),h=new Date().toLocaleString("es-ES"),x=`${r}-${p}-${s}-${h}`;y=y.filter(T=>!T.startsWith(`${r}-`)),y.push(x),localStorage.setItem("completedActivities",JSON.stringify(y));let v=document.querySelector("h1");v&&localStorage.setItem("namePage",v.innerText),U(b.QUIZ)}else n.className="feedback-icon hidden",n.textContent="",a.className="feedback-text text-lg font-semibold text-red-800",a.textContent=c||f("multiple-choice-try-again"),u=lo(a,d)||u,o.setAttribute("role","alert");u&&me(),Zi(t,a,d)},la=()=>{document.querySelector(De)&&(Pi(),$i(),mo(),Mi())};document.addEventListener("adt-language-changed",Wi)});var ha={};Me(ha,{allowDrop:()=>fa,checkSorting:()=>yo,dropSort:()=>ya,handleDragStart:()=>ga,highlightBoxes:()=>ye,placeWord:()=>Tt,prepareSorting:()=>po,resetActivity:()=>ma,selectWordSort:()=>Ye});function yo(){let e=document.getElementById("feedback"),t=document.getElementById("toast"),o=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],n=0,a=0,r=o+"-intentos",i=localStorage.getItem(r);i===null?(localStorage.setItem(r,"0"),i=0):i=parseInt(i,10),i++,localStorage.setItem(r,i.toString()),document.querySelectorAll("section .category").forEach(p=>{let h=p.getAttribute("data-activity-category");p.querySelectorAll(".placed-word").forEach(v=>{let T=v.getAttribute("data-activity-item"),L=correctAnswers[T],w=v.querySelector(".validation-mark");w&&w.remove();let B=document.createElement("span");B.classList.add("validation-mark","ml-2","inline-flex","items-center","text-lg");let R=p.getAttribute("aria-label")||p.getAttribute("data-activity-category"),Q=ca(v.textContent);if(h===L)v.classList.remove("bg-red-100","border-red-300"),v.classList.add("bg-green-100","border-green-300","border"),B.textContent="\u2713",B.classList.add("text-green-700"),n++,v.setAttribute("aria-label",`${Q} - colocado correctamente en la categor\xEDa: ${R}. Presione Enter para quitar.`);else{v.classList.remove("bg-green-100","border-green-300"),v.classList.add("bg-red-100","border-red-300","border"),B.textContent="\u2717",B.classList.add("text-red-700"),a++;let C=document.querySelector(`[data-activity-category="${L}"]`),M=C?C.getAttribute("aria-label")||C.getAttribute("data-activity-category"):L;v.setAttribute("aria-label",`${Q} - colocado incorrectamente en la categor\xEDa: ${R}. Deber\xEDa estar en: ${M}. Presione Enter para quitar.`)}if(v.querySelector("img")){let C=v.querySelector(".content-container");if(!C){for(C=document.createElement("div"),C.classList.add("content-container","flex","flex-col","items-center","w-full","space-y-2");v.firstChild;)C.appendChild(v.firstChild);v.appendChild(C)}let M=v.querySelector(".text-wrapper");if(!M){M=document.createElement("div"),M.classList.add("text-wrapper","flex","items-center","justify-center");let le=C.querySelector(".word-text, span:not(.validation-mark)");le&&M.appendChild(le),C.appendChild(M)}M.appendChild(B)}else{let C=v.querySelector(".text-wrapper");if(!C){for(C=document.createElement("div"),C.classList.add("text-wrapper","flex","items-center","justify-center","w-full");v.firstChild;)C.appendChild(v.firstChild);v.appendChild(C)}C.appendChild(B)}v.classList.add("p-2","rounded"),setTimeout(()=>{if(h===L)O(`${Q} est\xE1 correctamente colocado en ${R}.`);else{let C=document.querySelector(`[data-activity-category="${L}"]`),M=C?C.getAttribute("aria-label")||C.getAttribute("data-activity-category"):L;O(`${Q} est\xE1 incorrectamente colocado. Deber\xEDa estar en ${M}.`)}},100*(n+a))})});let c=document.querySelectorAll("section .placed-word").length,d=Object.keys(correctAnswers).length,u=c===d,m=n===d;if(!u){let p=f("sorting-not-complete",{cardsPlaced:c,totalCards:d});e.textContent=p,e.classList.remove("text-green-500"),e.classList.add("text-red-500"),W(!1,f("retry"),b.SORTING,d-c,{message:p,emoji:"\u{1F914}",toastType:"warning",timeout:6e3,showCloseButton:!0}),A("error"),typeof J=="function"&&J();return}let y=f("sorting-results",{correctCount:n,incorrectCount:a});if(m){A("success");let p=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],h=localStorage.getItem("completedActivities"),x=h?JSON.parse(h):[],v=localStorage.getItem("namePage"),T=new Date().toLocaleString("es-ES"),L=`${p}-${v}-${i}-${T}`;x.includes(p)||(x.push(L),localStorage.setItem("completedActivities",JSON.stringify(x))),y=f("sorting-correct-answer"),U(b.SORTING),setTimeout(()=>{O(`\xA1Excelente! Todas las ${d} palabras est\xE1n correctamente colocadas.`)},1e3)}else A("error"),y=f("sorting-results",{correctCount:n,incorrectCount:a}),setTimeout(()=>{O(`Resultados: ${n} correctas, ${a} incorrectas. Revisa las palabras marcadas con X.`)},1e3);e.textContent=y,e.classList.remove("text-red-500","text-green-500"),e.classList.add(m?"text-green-500":"text-red-500"),W(m,m?f("next-activity"):f("retry"),b.SORTING,0,{message:y,emoji:m?"\u{1F389}":"\u{1F914}",toastType:m?"success":"error",timeout:6e3,showCloseButton:!0})}var ca,po,Yi,fo,da,ua,es,ts,os,ns,as,ma,rs,ga,ye,Ye,is,kt,Tt,pa,ss,ls,cs,ds,et,fa,ya,ba,us,ms,gs,ps,Nt=N(()=>{"use strict";z();H();j();Y();D();pe();ze();ca=e=>e.trim().replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]|[\u{1F900}-\u{1F9FF}]|[\u{1FA70}-\u{1FAFF}]/gu,"").replace(/\s+/g," ").trim(),po=e=>{Yi(e),ns(e),as(e),setTimeout(()=>{us()},0)},Yi=e=>{e.querySelectorAll(".word-card").forEach(o=>{ua(o,e),os(o)})},fo=()=>{let e=document.querySelector("[data-aria-id]");if(!e)return;let t=e.getAttribute("data-aria-id"),n=`${location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0]}_${t}`;return document.getElementsByTagName("h1").length<0?localStorage.setItem("namePage",document.getElementsByTagName("h2")[0].innerText):document.getElementsByTagName("h1").length>0&&localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page"),n},da=e=>{let t=Array.from(e.querySelectorAll(".word-card:not(.bg-gray-300):not(.placed-word)")).filter(s=>!s.closest(".category")),o=Array.from(e.querySelectorAll(".placed-word")),n=Array.from(e.querySelectorAll("section .category")),a=document.getElementById("submit-button"),r=document.getElementById("reset-button"),i=[];return i.push(...t),i.push(...n),i.push(...o),a&&i.push(a),r&&i.push(r),i},ua=(e,t)=>{e.addEventListener("click",()=>Ye(e)),e.addEventListener("dragstart",ga),e.addEventListener("mousedown",()=>ye(!0)),e.addEventListener("mouseup",()=>ye(!1)),e.addEventListener("keydown",n=>es(n,e,t));let o=e.querySelector("img");o&&(o.setAttribute("draggable","false"),o.style.pointerEvents="none")},es=(e,t,o)=>{if(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="ArrowUp"||e.key==="ArrowDown"){e.stopPropagation(),e.preventDefault(),gs(e.key,t,o);return}if(e.key==="Tab"){if(l.inCategoryNavigation){if(e.preventDefault(),e.shiftKey){l.inCategoryNavigation=!1,et();return}let n=da(o);if(n.length>0){let r=(n.indexOf(t)+1)%n.length;n[r].focus()}return}return}(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),Ye(t))},ts=(e,t,o)=>{let n=da(o);if(n.length<=1)return;let a=n.indexOf(t),r;switch(e){case"ArrowLeft":case"ArrowUp":r=(a-1+n.length)%n.length;break;case"ArrowRight":case"ArrowDown":r=(a+1)%n.length;break}n[r]&&n[r].focus()},os=e=>{e.classList.add("cursor-pointer","transition","duration-300","hover:bg-yellow-300","transform","hover:scale-105")},ns=e=>{e.querySelectorAll("section .category").forEach(o=>{o.setAttribute("tabindex","0"),o.setAttribute("role","listbox"),o.addEventListener("dragover",fa),o.addEventListener("drop",a=>ya(a,e));let n=o.previousElementSibling;n&&n.tagName.toLowerCase().startsWith("h")&&(n.id||(n.id=`category-label-${o.getAttribute("data-activity-category")}`),o.setAttribute("aria-labelledby",n.id)),o.addEventListener("focus",()=>{if(!l.currentWord){let a=o.getAttribute("aria-label")||o.getAttribute("data-activity-category"),r=o.querySelectorAll(".placed-word"),i=r.length,s="";if(i===0)s=`Categor\xEDa: ${a}. No hay palabras colocadas aqu\xED.`;else{let c=Array.from(r).map(d=>d.textContent.trim());s=`Categor\xEDa: ${a}. Contiene ${i} palabra${i!==1?"s":""}: ${c.join(", ")}.`}O(s)}}),o.addEventListener("click",a=>{if(l.currentWord){if(a.target.closest(".placed-word")){a.stopPropagation();return}Tt(o.getAttribute("data-activity-category"),e)}}),o.addEventListener("keydown",a=>{if(a.key==="ArrowLeft"||a.key==="ArrowRight"||a.key==="ArrowUp"||a.key==="ArrowDown"){a.stopPropagation(),a.preventDefault(),ps(a.key,o,e);return}if(a.key==="Tab"){if(l.currentWord&&l.inCategoryNavigation){if(a.preventDefault(),a.shiftKey){l.inCategoryNavigation=!1,et(),ye(!1);let i=document.querySelectorAll("section .word-card:not(.bg-gray-300):not(.placed-word)");i.length>0&&i[0].focus();return}let r=Array.from(e.querySelectorAll("section .category"));if(r.length>0){let s=(r.indexOf(o)+1)%r.length;r[s].focus()}}else return;return}if(l.currentWord&&(a.key==="Enter"||a.key===" ")){a.preventDefault();let r=o.getAttribute("data-activity-category");Tt(r,e)}})})},as=()=>{let e=document.querySelector("#feedback");e&&e.addEventListener("click",ma)},ma=()=>{document.querySelectorAll("section .placed-word").forEach(a=>{a.remove()}),document.querySelectorAll("section .word-card").forEach(a=>{is(a)}),g("currentWord",""),l&&(l.inCategoryNavigation=!1);let o=document.getElementById("feedback");o&&(o.textContent="",o.classList.remove("text-red-500","text-green-500"));let n=document.getElementById("toast");n&&(n.textContent="",n.classList.add("hidden"),n.classList.remove("bg-red-200","text-red-700","bg-green-200","text-green-700")),ye(!1),rs();try{typeof A=="function"&&A("reset")}catch(a){console.warn("Could not play reset sound:",a)}},rs=()=>{try{let e=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0];Object.keys(localStorage).filter(n=>n.startsWith(`${e}_`)).forEach(n=>{localStorage.removeItem(n)});let o=fo();o&&localStorage.removeItem(o)}catch(e){console.error("Error clearing sorting localStorage:",e)}},ga=e=>{let t=e.target.closest(".word-card");if(t){if(t.classList.contains("bg-gray-300")){e.preventDefault();return}e.dataTransfer.setData("text",t.getAttribute("data-activity-item")),t.classList.add("selected"),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(t,0,0),ye(!0)}},ye=e=>{document.querySelectorAll("section .category").forEach(o=>{e?o.classList.add("bg-blue-100","border-blue-400"):o.classList.remove("bg-blue-100","border-blue-400")})},Ye=e=>{if(e.classList.contains("placed-word")){kt(e);return}if(e.classList.contains("bg-gray-300")){let o=document.querySelector(`.placed-word[data-activity-item="${e.getAttribute("data-activity-item")}"]`);o&&kt(o);return}document.querySelectorAll("section .word-card").forEach(o=>o.classList.remove("border-blue-700")),e.classList.remove("border-gray-300"),e.classList.add("border-blue-700","border-2","box-border"),g("currentWord",e.getAttribute("data-activity-item")),l.inCategoryNavigation=!0;let t=document.querySelector("section .category");if(t){t.focus();let o=t.querySelector(".word-list")?.children.length||0,n=t.getAttribute("aria-label")||t.getAttribute("data-activity-category"),a=`Seleccionado: ${e.textContent.trim()}. `;if(a+=`Ahora enfocado en categor\xEDa: ${n}. `,o===0)a+="Esta categor\xEDa est\xE1 vac\xEDa. ";else{let r=t.querySelectorAll(".placed-word"),i=Array.from(r).map(s=>s.textContent.trim());a+=`Ya contiene ${o} palabra${o!==1?"s":""}: ${i.join(", ")}. `}a+="Presione Enter para colocar aqu\xED, o use las flechas para moverse entre categor\xEDas.",O(a)}ye(!0)},is=e=>{e.classList.remove("bg-gray-300","cursor-not-allowed","text-gray-400","hover:bg-gray-300","hover:scale-100"),e.style.border="",e.classList.add("cursor-pointer","transition","duration-300","hover:bg-yellow-300","transform","hover:scale-105"),e.addEventListener("click",()=>Ye(e))},kt=e=>{let t=e.getAttribute("data-activity-item"),n=e.closest("[data-activity-category]").getAttribute("data-activity-category"),a=JSON.parse(localStorage.getItem("wordPlacement"))||{};a[n]&&(a[n]=a[n].filter(i=>i!==t),a[n].length===0&&delete a[n],localStorage.setItem("wordPlacement",JSON.stringify(a)));let r=document.querySelector(`section .word-card[data-activity-item="${t}"]`);if(r){let i=r.cloneNode(!0);r.parentNode.replaceChild(i,r),i.classList.remove("bg-gray-300","cursor-not-allowed","text-gray-400","hover:bg-gray-300","hover:scale-100"),i.classList.add("cursor-pointer","transition","duration-300","hover:bg-yellow-300","transform","hover:scale-105"),i.style.border="",i.setAttribute("draggable","true");let s=document.querySelector('section[data-section-type="activity_sorting"]');ua(i,s),setTimeout(()=>{i.focus(),O(`${i.textContent.trim()} has been returned to available options.`)},100),ba(),A("reset")}else console.error(`Could not find original card with id: ${t}`);e.remove()},Tt=e=>{if(!l.currentWord)return;A("drop");let t=document.querySelector(`div[data-activity-category="${e}"]`),o=t?.querySelector("section .word-list");if(!o){console.error(`Category "${e}" not found or no word list available.`);return}let n=document.querySelector(`.word-card[data-activity-item="${l.currentWord}"]`);if(!n){console.error(`Word card for "${l.currentWord}" not found.`);return}let a=pa(n,o),r=n.textContent.trim(),i=t.getAttribute("aria-label")||t.getAttribute("data-activity-category");et(),ba();let s=document.querySelector('section[data-section-type="activity_sorting"]');setTimeout(()=>{let c=Array.from(document.querySelectorAll("section .word-card:not(.bg-gray-300):not(.placed-word)")).filter(y=>!y.closest(".category")),d=o||t.querySelector(".word-list"),u=d?d.children.length:0,m="";if(m+=`${r} colocado en ${i}. `,u===1?m+="Esta es la primera palabra en esta categor\xEDa. ":m+=`Hay ${u} palabras en esta categor\xEDa. `,c.length===0){let y=document.getElementById("submit-button");y?(y.focus(),m+="Todas las palabras han sido colocadas. Ahora est\xE1 enfocado el bot\xF3n de enviar. Presione Enter para enviar sus respuestas.",O(m)):(m+="Todas las palabras han sido colocadas. Puede enviar sus respuestas ahora.",O(m))}else{let y=c[0];y.focus(),m+=`Ahora est\xE1 enfocado en "${y.textContent.trim()}", que es la siguiente palabra disponible.`,O(m)}},50)},pa=(e,t)=>{let o=e.cloneNode(!0);return t.classList.add("flex","flex-wrap"),t.appendChild(o),ss(o),cs(e),o},ss=e=>{e.querySelector("img")?ds(e):ls(e),e.classList.add("placed-word","max-w-40","m-2","p-2","cursor-pointer","hover:bg-red-100","bg-blue-50","border-2","border-blue-300","rounded-md","shadow-sm","transition-all"),e.setAttribute("draggable","false"),e.setAttribute("tabindex","0"),e.setAttribute("role","option"),e.setAttribute("aria-selected","false");let t=e.closest(".category"),o="";t&&(o=t.getAttribute("aria-label")||t.getAttribute("data-activity-category"));let n=ca(e.textContent);e.setAttribute("aria-label",`${n} - colocado en la categor\xEDa: ${o}. Presione Enter para quitar.`),e.addEventListener("click",function(){kt(this)}),e.addEventListener("keydown",function(a){if(a.key==="Tab"){l.inCategoryNavigation&&(l.inCategoryNavigation=!1,et());return}if(a.key==="ArrowLeft"||a.key==="ArrowRight"||a.key==="ArrowUp"||a.key==="ArrowDown"){a.preventDefault(),a.stopPropagation();let r=document.querySelector('section[data-section-type="activity_sorting"]');ts(a.key,this,r);return}(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),a.stopPropagation(),kt(this))})},ls=e=>{let t=document.createElement("div");for(t.classList.add("text-wrapper","flex","items-center","justify-center","w-full");e.firstChild;)t.appendChild(e.firstChild);e.appendChild(t)},cs=e=>{e.classList.contains("placed-word")||(e.classList.add("bg-gray-300","cursor-not-allowed","text-gray-400","hover:bg-gray-300","hover:scale-100"),e.style.border="none",e.classList.remove("selected","shadow-lg"),e.removeEventListener("click",()=>Ye(e)))},ds=e=>{let t=document.createElement("div");t.classList.add("content-container","flex","flex-col","items-center","w-full","space-y-2");let o=document.createElement("div");o.classList.add("text-wrapper","flex","items-center","justify-center");let n=e.querySelector("img"),a=e.querySelector(".word-text, span:not(.validation-mark)");for(n&&(n.setAttribute("draggable","false"),n.style.pointerEvents="none",t.appendChild(n)),a&&o.appendChild(a),t.appendChild(o);e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t)},et=()=>{g("currentWord",""),ye(!1)},fa=e=>{e.preventDefault()},ya=e=>{e.preventDefault();let t=e.dataTransfer.getData("text");g("currentWord",t);let o=e.target.closest(".category").dataset.activityCategory;A("drop"),Tt(o),ye(!1)};ba=()=>{let e=document.querySelectorAll("[data-activity-category]"),t={};e.forEach(o=>{let n=o.getAttribute("data-activity-category"),a=[...o.querySelectorAll(".word-card")].map(r=>r.dataset.activityItem);t[n]=a}),localStorage.setItem(fo(),JSON.stringify(t))},us=()=>{try{let e=localStorage.getItem(fo());if(!e)return;let t={};try{t=JSON.parse(e)}catch(o){console.error("Error parsing saved sorting data:",o);return}if(!t||Object.keys(t).length===0)return;Object.entries(t).forEach(([o,n])=>{document.querySelector(`div[data-activity-category="${o}"]`)&&Array.isArray(n)&&n.forEach(r=>{if(document.querySelector(`.word-card[data-activity-item="${r}"]`)&&l.currentWord!==r){let s=l.currentWord;g("currentWord",r),ms(o),g("currentWord",s)}})})}catch(e){console.error("Error loading sorting data:",e)}},ms=e=>{if(!l.currentWord)return;let o=document.querySelector(`div[data-activity-category="${e}"]`)?.querySelector(".word-list");if(!o)return;let n=document.querySelector(`.word-card[data-activity-item="${l.currentWord}"]`);if(!n)return;let a=pa(n,o);et()},gs=(e,t,o)=>{let n=Array.from(o.querySelectorAll(".word-card:not(.bg-gray-300):not(.placed-word)")).filter(i=>!i.closest(".category"));if(n.length<=1)return;let a=n.indexOf(t),r;switch(e){case"ArrowLeft":case"ArrowUp":r=(a-1+n.length)%n.length;break;case"ArrowRight":case"ArrowDown":r=(a+1)%n.length;break}n[r]&&n[r].focus()},ps=(e,t,o)=>{let n=Array.from(o.querySelectorAll("section .category"));if(n.length<=1)return;let a=n.indexOf(t),r;switch(e){case"ArrowLeft":case"ArrowUp":r=(a-1+n.length)%n.length;break;case"ArrowRight":case"ArrowDown":r=(a+1)%n.length;break}if(n[r]){let i=n[r];if(i.focus(),l.currentWord){let s=i.getAttribute("aria-label")||i.getAttribute("data-activity-category"),c=i.querySelectorAll(".placed-word"),d=c.length,u=`Categor\xEDa: ${s}. `,m=document.querySelector(`.word-card[data-activity-item="${l.currentWord}"]`),y=m?m.textContent.trim():"Palabra seleccionada";if(u+=`Palabra seleccionada: ${y}. `,d===0)u+="No hay palabras colocadas aqu\xED. ";else{u+=`Ya contiene ${d} palabra${d!==1?"s":""}: `;let p=Array.from(c).map(h=>h.textContent.trim());u+=`${p.join(", ")}. `}u+="Presione Enter para colocar la palabra aqu\xED.",O(u)}}}});var Ia={};Me(Ia,{allowDrop:()=>xa,checkMatching:()=>xo,drag:()=>Ea,drop:()=>Aa,dropWord:()=>vo,loadDropzoneState:()=>La,prepareMatching:()=>ho,resetActivity:()=>Ss,selectWord:()=>tt});var ne,ho,fs,ys,bs,hs,vs,tt,vo,xa,Ea,Aa,qt,Ie,bo,La,Sa,va,xo,wa,xs,Es,As,Ls,Ss,Bt=N(()=>{"use strict";z();H();j();D();j();pe();ne=(e,t=!1)=>{e.classList.add("hover:bg-yellow-300","hover:scale-105","transition-transform","duration-200"),t&&(e.classList.add("placed-in-dropzone"),e.classList.add("hover:shadow-md"),e.setAttribute("title",f("click-to-remove")))},ho=e=>{fs(e),ys(e),bs()},fs=e=>{e.querySelectorAll(".activity-item").forEach(o=>{o.addEventListener("click",()=>tt(o)),o.addEventListener("dragstart",n=>Ea(n)),o.addEventListener("keydown",n=>hs(n,o)),o.setAttribute("tabindex","0"),o.style.cursor="pointer",ne(o)})},ys=e=>{e.querySelectorAll(".dropzone").forEach(o=>{o.addEventListener("click",()=>vo(o.id)),o.addEventListener("drop",n=>Aa(n)),o.addEventListener("dragover",n=>xa(n)),o.addEventListener("keydown",n=>vs(n,o)),o.setAttribute("tabindex","0"),o.style.cursor="pointer"})},bs=()=>{document.querySelectorAll(".activity-item").forEach(t=>{t.addEventListener("click",o=>{o.target.closest(".dropzone")?(va(o.target),bo(o.target.getAttribute("data-activity-item"))):tt(o.target)}),t.addEventListener("keydown",o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),o.target.closest(".dropzone")?(va(o.target),bo(o.target.getAttribute("data-activity-item"))):tt(o.target))})})},hs=(e,t)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),tt(t))},vs=(e,t)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),vo(t.id))},tt=e=>{l.selectedWord&&l.selectedWord.classList.remove("border-4","border-blue-500"),e.classList.add("border-4","border-blue-500"),g("selectedWord",e)},vo=e=>{if(!l.selectedWord)return;let t=document.getElementById(e).querySelector("div[role='region']"),o=t.querySelector(".activity-item");if(o){Sa(o,l.selectedWord,t),Ie(e,l.selectedWord),l.selectedWord.classList.remove("border-4","border-blue-500"),g("selectedWord",null),A("drop");return}let n=l.selectedWord.parentElement;if(n&&(n.classList.contains("relative")||n.classList.contains("inline-block"))){let a=l.selectedWord;n.parentElement.removeChild(n),l.selectedWord=a}t.appendChild(l.selectedWord),ne(l.selectedWord,!0),Ie(e,l.selectedWord),l.selectedWord.classList.remove("border-4","border-blue-500"),g("selectedWord",null),A("drop")},xa=e=>{e.preventDefault()},Ea=e=>{e.dataTransfer.setData("text",e.target.getAttribute("data-activity-item"))},Aa=e=>{e.preventDefault();let t=e.dataTransfer.getData("text"),o=e.currentTarget.querySelector("div[role='region']"),n=document.querySelector(`.activity-item[data-activity-item='${t}']`),a=o.querySelector(".activity-item");if(a&&a===n)return;if(a){Sa(a,n,o),Ie(e.currentTarget.id,n);return}let r=n.parentElement;if(r&&(r.classList.contains("relative")||r.classList.contains("inline-block"))){let i=n;r.parentElement.removeChild(r),n=i}o.appendChild(n),ne(n,!0),Ie(e.currentTarget.id,n),A("drop")},qt=()=>{let e=document.querySelector("[data-aria-id]");if(!e)return null;let t=e.getAttribute("data-aria-id");return`${location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0]}_${t}`},Ie=(e,t)=>{let o=qt(),n=JSON.parse(localStorage.getItem(o))||{},a=t.getAttribute("data-activity-item")||t.getAttribute("data-id"),r=document.getElementById(e);Object.keys(n).forEach(i=>{n[i]=n[i].filter(s=>s!==a),n[i].length===0&&delete n[i]}),n[e]=[a],localStorage.setItem(o,JSON.stringify(n))},bo=e=>{let t=qt(),o=JSON.parse(localStorage.getItem(t))||{};Object.keys(o).forEach(n=>{o[n]=o[n].filter(a=>a!==e),o[n].length===0&&delete o[n]}),localStorage.setItem(t,JSON.stringify(o))},La=()=>{let e=localStorage.getItem(qt()),t={};if(e)try{t=JSON.parse(e)}catch{return}Object.entries(t).forEach(([o,n])=>{let a=document.querySelector(`#${o}`);if(!a)return;let r=a.querySelector("div[role='region']");n.forEach(i=>{let s=document.querySelector(`.activity-item[data-activity-item='${i}'], .activity-item[data-id='${i}']`);if(!s)return;ne(s);let c=s.parentElement;if(c&&(c.classList.contains("relative")||c.classList.contains("inline-block"))){let d=s;c.parentElement.removeChild(c),s=d}r.contains(s)||(r.appendChild(s),ne(s,!0))})})};La();Sa=(e,t,o)=>{let n=t.closest(".dropzone");if(n!==null&&n!==o.closest(".dropzone")){let r=n.querySelector("div[role='region']");t.parentNode&&t.parentNode.removeChild(t),e.parentNode&&e.parentNode.removeChild(e),o.appendChild(t),r.appendChild(e),ne(e,!0),ne(t,!0);let i=o.closest(".dropzone").id,s=n.id;Ie(i,t),Ie(s,e),A("drop")}else{(document.querySelector(".original-word-list")||document.querySelector(".grid:not(.dropzone)")).appendChild(e),e.classList.remove("placed-in-dropzone","hover:scale-105","transition-transform","duration-200","hover:shadow-md"),ne(e),o.appendChild(t),ne(t,!0);let i=o.closest(".dropzone").id;Ie(i,t),bo(e.getAttribute("data-activity-item"))}},va=e=>{let t=document.querySelector(".original-word-list")||document.querySelector(".grid:not(.dropzone)");t&&e&&(e.classList.remove("border-4","border-blue-500","placed-in-dropzone","hover:shadow-md"),ne(e),l.selectedWord===e&&g("selectedWord",null),t.appendChild(e),A("click"))},xo=()=>{let e=0;wa();let o=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0]+"-intentos",n=localStorage.getItem(o);n===null?(localStorage.setItem(o,"0"),n=0):n=parseInt(n,10),n++,localStorage.setItem(o,n.toString()),Object.keys(correctAnswers).forEach(a=>{let r=document.querySelector(`.activity-item[data-activity-item='${a}']`);if(r){let i=r.closest(".dropzone");Es(i,a,correctAnswers[a],()=>e++)}}),As(e)},wa=()=>{document.querySelectorAll(".dropzone").forEach(o=>{o.classList.remove("bg-green-200","bg-red-200")}),xs(),document.querySelectorAll(".activity-item").forEach(o=>{o.classList.remove("border","border-green-300","border-red-300")})},xs=()=>{document.querySelectorAll(".validation-icon, .validation-mark").forEach(t=>t.remove())},Es=(e,t,o,n)=>{if(e){let a=e.querySelector(`.activity-item[data-activity-item='${t}']`),r=e.querySelector("div[role='region']").id===o;if(a){let i=a.querySelector(".validation-icon, .validation-mark");i&&i.remove(),r?(a.classList.add("border","border-green-300"),n()):a.classList.add("border","border-red-300");let s=document.createElement("span");s.classList.add("validation-mark","ml-2","inline-flex","align-middle","font-bold"),r?(s.textContent="\u2713",s.classList.add("text-green-700")):(s.textContent="\u2717",s.classList.add("text-red-700")),a.appendChild(s)}}},As=e=>{let t=document.getElementById("feedback"),o=Object.keys(correctAnswers).length,n=e===o;if(A(n?"success":"error"),n){let a=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],r=localStorage.getItem("completedActivities"),i=a+"-intentos",s=localStorage.getItem(i),c=r?JSON.parse(r):[],d=localStorage.getItem("namePage"),u=new Date().toLocaleString("es-ES"),m=`${a}-${d}-${s}-${u}`;c=c.filter(y=>!y.startsWith(`${a}-`)),c.push(m),localStorage.setItem("completedActivities",JSON.stringify(c)),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page"),U(b.MATCHING)}t&&Ls(t,n,e),W(n,f("next-activity"),b.MATCHING)},Ls=(e,t,o)=>{t?(e.textContent=f("matching-correct-answers"),e.classList.remove("text-red-500"),e.classList.add("text-green-500")):(e.textContent=f("matching-correct-answers-count",{correctCount:o}),e.classList.remove("text-green-500"),e.classList.add("text-red-500"))},Ss=()=>{let e=document.querySelector(".original-word-list")||document.querySelector(".grid:not(.dropzone)");if(!e)return;document.querySelectorAll(".dropzone .activity-item").forEach(a=>{a.classList.remove("border-4","border-blue-500","placed-in-dropzone","hover:shadow-md"),ne(a),e.appendChild(a)}),wa(),l.selectedWord&&(l.selectedWord.classList.remove("border-4","border-blue-500"),g("selectedWord",null));let o=qt();localStorage.removeItem(o);let n=document.getElementById("feedback");n&&(n.textContent="",n.classList.remove("text-red-500","text-green-500")),A("click")}});var ka,ws,Is,Ca,Cs,ks,Ts,Ns,qs,Bs,Ta,_s,$s,Ps,Ms,Os,Fs,Rs,zs,Ds,Hs,Eo=N(()=>{"use strict";z();H();j();D();j();pe();ka=e=>{ws(),Is(e),Ts(e)},ws=()=>{A("")};document.getElementsByTagName("h1").length<0?localStorage.setItem("namePage",document.getElementsByTagName("h2")[0].innerText):document.getElementsByTagName("h1").length>0&&localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page");Is=e=>{e.querySelectorAll("fieldset").forEach(o=>{let n=Array.from(o.querySelectorAll('input[type="radio"]')),a=o.querySelector("legend span")?.textContent||"";n.length>0&&n.forEach(r=>{let i=r.cloneNode(!0);r.parentNode.replaceChild(i,r),i.addEventListener("keydown",s=>{if(s.key==="Enter"){s.preventDefault(),i.checked=!0,Ca(i,a);let c=new Event("change",{bubbles:!0});i.dispatchEvent(c)}if(s.key==="ArrowLeft"||s.key==="ArrowRight"||s.key==="ArrowUp"||s.key==="ArrowDown"){s.preventDefault(),s.stopPropagation();let c,d=n.indexOf(i);s.key==="ArrowLeft"||s.key==="ArrowUp"?c=d===0?n.length-1:d-1:c=d===n.length-1?0:d+1,n[c].focus(),n[c].checked=!0,Ca(n[c],a);let u=new Event("change",{bubbles:!0});n[c].dispatchEvent(u)}}),i.addEventListener("focus",()=>{let s=i.value==="yes"?"S\xED":"No",c=i.checked?"seleccionado":"no seleccionado",d=document.getElementById("focus-announcement")||ks();d.textContent=`${a} - Opci\xF3n: ${s}, ${c}`})})})},Ca=(e,t)=>{let o=e.value==="yes"?"S\xED":"No",n=document.getElementById("keyboard-action-announcement")||Cs();n.textContent=`${t} - ${o} seleccionado`},Cs=()=>{let e=document.createElement("div");return e.id="keyboard-action-announcement",e.className="sr-only",e.setAttribute("role","status"),e.setAttribute("aria-live","assertive"),document.body.appendChild(e),e},ks=()=>{let e=document.createElement("div");return e.id="focus-announcement",e.className="sr-only",e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),document.body.appendChild(e),e},Ts=e=>{e.querySelectorAll("input[type='radio']").forEach((o,n)=>{Ns(o),qs(o);let a=o.id||`tf-radio-${o.name}-${o.value}-${n}`;o.id=a;let r=o.closest("label");r&&r.setAttribute("for",a)})},Ns=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.closest("[data-area-id]")?.getAttribute("data-area-id")||"default",n=`${t}_${o}_${e.name}`,a=localStorage.getItem(n);if(a){let{value:r}=JSON.parse(a);e.value===r&&(e.checked=!0)}},qs=e=>{e.addEventListener("change",()=>{A("drop"),Bs(e.name);let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.closest("[data-area-id]")?.getAttribute("data-area-id")||"default",n=`${t}_${o}_${e.name}`,a={question:e.name,value:e.value,dataActivityItem:e.getAttribute("data-activity-item"),areaId:o};localStorage.setItem(n,JSON.stringify(a)),g("selectedButton",e)})},Bs=e=>{document.querySelectorAll(`section input[name="${e}"]`).forEach(n=>{let a=n.closest("label");if(!a){console.warn("No parent label found for radio button");return}let r=a.querySelector("div");if(r){let s=r.querySelector(".validation-mark");s?(s.classList.add("hidden"),s.textContent=""):console.warn("No validation mark found in button div"),r.classList.remove("bg-green-500","bg-red-500","text-white","text-green-700","text-red-700"),r.classList.add("bg-gray-200"),n.checked?r.classList.add("bg-blue-500","text-white"):r.classList.add("peer-checked:bg-blue-500","peer-checked:text-white")}else console.warn("No button div found for radio");a.removeAttribute("aria-invalid");let i=a.querySelector(".sr-validation-feedback");i&&i.remove()});let o=document.getElementById("validation-results-announcement");o&&(o.textContent=f("selection-changed-resubmit"))},Ta=()=>{$s();let t=Ps([1,2,3,4,5]);Hs(t.allCorrect);let n=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0]+"-intentos",a=localStorage.getItem(n);a===null?(localStorage.setItem(n,"0"),a=0):a=parseInt(a,10),a++,localStorage.setItem(n,a.toString());let r=document.getElementById("validation-results-announcement")||_s();if(t.allCorrect){r.textContent=f("Todas las respuestas son correctas");let i=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],s=localStorage.getItem("completedActivities"),c=s?JSON.parse(s):[],d=localStorage.getItem("namePage"),u=new Date().toLocaleString("es-ES"),m=`${i}-${d}-${a}-${u}`;c=c.filter(y=>!y.startsWith(`${i}-`)),c.push(m),localStorage.setItem("completedActivities",JSON.stringify(c)),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page"),U(b.TRUE_FALSE)}else{let i=t.incorrectQuestions?.length||0;i>0?r.textContent=f("Hay "+i+" respuestas incorrectas. Por favor, revisa tus respuestas e intenta de nuevo."):r.textContent=f("Hay algunas respuestas sin contestar. Por favor, completa todas las preguntas.")}W(t.allCorrect,f("next-activity"),b.TRUE_FALSE)},_s=()=>{let e=document.createElement("div");return e.id="validation-results-announcement",e.className="sr-only",e.setAttribute("role","status"),e.setAttribute("aria-live","assertive"),document.body.appendChild(e),e},$s=()=>{document.querySelectorAll(".feedback").forEach(e=>e.remove()),document.querySelectorAll(".validation-mark").forEach(e=>{e.classList.add("hidden"),e.textContent=""})},Ps=e=>{let t=!0,o=!0,n=[];return e.forEach(a=>{let r=document.querySelector(`input[name="question${a}"]:checked`);if(!r){t=!1,o=!1;return}Ms(r)||(t=!1,n.push(a))}),{allCorrect:t,allAnswered:o,incorrectQuestions:n}},Ms=e=>{let t=e.getAttribute("data-activity-item"),o=e.value,a=correctAnswers[t]===o;return Os(e,a),a},Os=(e,t)=>{let o=Rs(e);o&&zs(o,t),Ds(e,t),Fs(e,t)},Fs=(e,t)=>{let o=e.closest("label");if(o){let n=o.querySelector(".sr-validation-feedback");n||(n=document.createElement("span"),n.className="sr-only sr-validation-feedback",o.appendChild(n)),n.textContent=t?f("Esta respuesta es correcta"):f("Esta respuesta es incorrecta")}},Rs=e=>{let t=e.parentElement.querySelector(".validation-mark");return t&&t.classList.remove("hidden"),t},zs=(e,t)=>{let o="text-lg font-bold bg-white rounded-full w-6 h-6 flex items-center justify-center";t?(e.textContent="\u2713",e.className=`validation-mark ${o} text-green-600`,e.setAttribute("aria-label",f("Respuesta correcta"))):(e.textContent="\u2717",e.className=`validation-mark ${o} text-red-600`,e.setAttribute("aria-label",f("Respuesta incorrecta")))},Ds=(e,t)=>{let o=e.parentElement.querySelector("div");if(o){o.classList.remove("bg-gray-200","bg-green-500","bg-red-500","peer-checked:bg-blue-500"),o.classList.add(t?"bg-green-500":"bg-red-500");let n=e.closest("label");n&&n.setAttribute("aria-invalid",t?"false":"true")}},Hs=e=>{A(e?"success":"error")}});var Ao,Ce,_t=N(()=>{"use strict";Ao=class e{constructor(){this.documentLanguage=document.documentElement.lang||"es",this.spanishWords=null,this.initialized=!1,this.initializePromise=this.initialize()}async initialize(){try{this.initializeFallbackDictionary();try{let n=(await(await fetch("./assets/modules/activities/index.dic")).text()).split(`
`),a=parseInt(n[0],10);for(let r=1;r<n.length;r++){let i=n[r].trim();if(i){let s=i.split("/")[0].toLowerCase();s&&this.spanishWords.add(s)}}}catch(t){console.warn("Could not load full dictionary, continuing with fallback only:",t)}this.initialized=!0}catch(t){console.error("Error in dictionary initialization:",t),this.initializeFallbackDictionary()}}initializeFallbackDictionary(){let t=["a","al","algo","algunos","ante","antes","como","con","contra","cual","cuando","de","del","desde","donde","durante","e","el","en","entre","era","eres","es","esa","ese","esta","est\xE1","este","ha","hasta","hay","he","las","lo","los","me","mi","m\xED","mientras","muy","ni","no","nos","nosotros","nuestra","nuestro","o","otra","otro","para","pero","por","porque","que","qu\xE9","quien","qui\xE9n","se","sea","seg\xFAn","si","s\xED","siempre","sin","sobre","soy","su","sus","tal","tambi\xE9n","tanto","te","tu","t\xFA","un","una","uno","unos","vosotros","y","ya","yo","informaci\xF3n","reformulaci\xF3n","d\xEDa","a\xF1o","pa\xEDs","despu\xE9s","as\xED","trav\xE9s","n\xFAmero","l\xEDnea","p\xE1gina","p\xE1rrafo","t\xEDtulo","cap\xEDtulo","secci\xF3n","m\xE1s","aqu\xED","all\xED","ah\xED","quiz\xE1s","oraci\xF3n","an\xE1lisis","acci\xF3n","sonr\xEDe","r\xEDe","ejemplo","ejercicio","actividad","lectura","texto","respuesta","pregunta","problema","soluci\xF3n","explicaci\xF3n","definici\xF3n","concepto","tema","materia","vocabulario","gram\xE1tica","verbos","sustantivos","adjetivos","adverbios","teor\xEDa","pr\xE1ctica","resultado","m\xE9todo","sistema","funci\xF3n","proceso","autor","libro","obra","personaje","historia","ciencia","matem\xE1tica","biolog\xEDa","f\xEDsica","qu\xEDmica","geograf\xEDa","econom\xEDa","tecnolog\xEDa","subt\xEDtulo","sumate","s\xFAmate","sumarse","c\xF3mpralo","c\xF3mprame","c\xF3mprate","yacar\xE9","yacare","xer\xF3fila","mes\xF3fila","hidr\xF3fila","fotos\xEDntesis","clorofila","citoplasma","ADN","ARN","gen\xE9tica","evoluci\xF3n","c\xE9lula","bacteria","virus","prote\xEDna","amino\xE1cido","enzima","mitocondria","cloroplasto","n\xFAcleo","cromosoma","taxonom\xEDa","especie","g\xE9nero","familia","orden","clase","filo","reino","eucariota","procariota","aut\xF3trofo","heter\xF3trofo","mutaci\xF3n","alelo","fenotipo","genotipo","meiosis","mitosis","gameto","zigoto","embri\xF3n","organismo","ecosistema","bioma","h\xE1bitat","nicho","bi\xF3sfera","biodiversidad","end\xE9mico","simbiosis","par\xE1sito","hu\xE9sped","cadena alimenticia","tr\xF3fico","f\xEDsica","mec\xE1nica","cinem\xE1tica","din\xE1mica","est\xE1tica","termodin\xE1mica","electromagn\xE9tico","relatividad","cu\xE1ntica","part\xEDcula","\xE1tomo","electr\xF3n","prot\xF3n","neutr\xF3n","fot\xF3n","quark","bos\xF3n","fermi\xF3n","hadrones","leptones","fuerza","masa","energ\xEDa","trabajo","potencia","aceleraci\xF3n","velocidad","gravedad","densidad","presi\xF3n","temperatura","calor","radiaci\xF3n","conductividad","resistencia","voltaje","amperaje","frecuencia","longitud de onda","qu\xEDmica","elemento","compuesto","mol\xE9cula","\xE1tomo","i\xF3n","ani\xF3n","cati\xF3n","is\xF3topo","valencia","enlace","covalente","i\xF3nico","met\xE1lico","soluci\xF3n","soluto","solvente","concentraci\xF3n","mol","molaridad","normalidad","pH","\xE1cido","base","sal","\xF3xido","hidr\xF3xido","org\xE1nico","inorg\xE1nico","hidrocarburo","alcano","alqueno","alquino","alcohol","aldeh\xEDdo","cetona","\xE1cido carbox\xEDlico","\xE9ster","\xE9ter","amina","amida","fenol","carbohidrato","l\xEDpido","prote\xEDna","pol\xEDmero","mon\xF3mero","catalizador","inhibidor","matem\xE1tica","\xE1lgebra","geometr\xEDa","c\xE1lculo","estad\xEDstica","probabilidad","aritm\xE9tica","trigonometr\xEDa","ecuaci\xF3n","funci\xF3n","variable","constante","fracci\xF3n","decimal","exponente","logaritmo","derivada","integral","matriz","vector","tensor","conjunto","permutaci\xF3n","combinaci\xF3n","teorema","axioma","postulado","corolario","lema","hip\xF3tesis","demostraci\xF3n","inducci\xF3n","deducci\xF3n","inferencia","algoritmo","geolog\xEDa","meteorolog\xEDa","hidrolog\xEDa","oceanograf\xEDa","mineralog\xEDa","paleontolog\xEDa","sismolog\xEDa","vulcanolog\xEDa","litosfera","atm\xF3sfera","hidrosfera","biosfera","erosi\xF3n","sedimentaci\xF3n","tect\xF3nica","placa","magma","lava","mineral","roca","f\xF3sil","estrato","clima","tiempo","hurac\xE1n","tornado","cicl\xF3n","precipitaci\xF3n","humedad","presi\xF3n atmosf\xE9rica","astronom\xEDa","astrof\xEDsica","cosmolog\xEDa","galaxia","estrella","planeta","sat\xE9lite","cometa","asteroide","meteorito","nebulosa","constelaci\xF3n","agujero negro","supernova","pulsar","qu\xE1sar","c\xFAmulo","universo","big bang","expansi\xF3n","materia oscura","energ\xEDa oscura","fusi\xF3n nuclear","tecnolog\xEDa","computadora","algoritmo","programa","software","hardware","microprocesador","memoria","disco","pantalla","teclado","mouse","internet","wifi","bluetooth","router","servidor","firewall","ciberseguridad","programaci\xF3n","base de datos","c\xF3digo","binario","digital","an\xE1logo","inteligencia artificial","aprendizaje autom\xE1tico","rob\xF3tica","nanotecnolog\xEDa","biotecnolog\xEDa","ingenier\xEDa gen\xE9tica","realidad virtual","realidad aumentada","medicina","anatom\xEDa","fisiolog\xEDa","patolog\xEDa","histolog\xEDa","inmunolog\xEDa","neurolog\xEDa","cardiolog\xEDa","dermatolog\xEDa","pediatr\xEDa","ortopedia","diagn\xF3stico","s\xEDntoma","s\xEDndrome","tratamiento","terapia","medicamento","vacuna","anticuerpo","ant\xEDgeno","sistema inmune","sistema nervioso","sistema circulatorio","sistema digestivo","sistema respiratorio"];this.spanishWords=new Set(t),this.initialized=!0}async ensureInitialized(){this.initialized||await this.initializePromise}async isValidText(t){try{await this.ensureInitialized();let o=t.trim();if(!o)return!1;if(this.hasKeyboardMashing(o))return console.warn("Text has keyboard mashing or gibberish patterns"),!1;if(!this.hasReasonableVowelRatio(o))return console.warn("Text has unreasonable vowel ratio"),!1;if(!this.hasReasonableWordLengths(o))return console.warn("Text has unreasonable word lengths"),!1;if(this.spanishWords&&this.spanishWords.size>0){let n=o.toLowerCase().split(/[^a-z]+/).filter(i=>i.length>1);if(n.length===0)return!0;let a=0;for(let i of n){if(i.length<=1){a++;continue}if(this.spanishWords.has(i)){a++;continue}let s=this.removeAccents(i);if(s!==i&&this.spanishWords.has(s)){a++;continue}let c=this.getPossibleStems(i),d=c.map(u=>this.removeAccents(u));if(c.some(u=>this.spanishWords.has(u))||d.some(u=>this.spanishWords.has(u))){a++;continue}}return a/n.length*100>=25}return!0}catch(o){return console.error("Error in TextValidator.isValidText:",o),!0}}removeAccents(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}getPossibleStems(t){let o=[t];if(t.length>3){let i=[{ending:"o",replacement:"ar"},{ending:"as",replacement:"ar"},{ending:"a",replacement:"ar"},{ending:"amos",replacement:"ar"},{ending:"\xE1is",replacement:"ar"},{ending:"an",replacement:"ar"},{ending:"\xE9",replacement:"ar"},{ending:"aste",replacement:"ar"},{ending:"\xF3",replacement:"ar"},{ending:"amos",replacement:"ar"},{ending:"asteis",replacement:"ar"},{ending:"aron",replacement:"ar"},{ending:"aba",replacement:"ar"},{ending:"abas",replacement:"ar"},{ending:"\xE1bamos",replacement:"ar"},{ending:"abais",replacement:"ar"},{ending:"aban",replacement:"ar"},{ending:"ar\xE9",replacement:"ar"},{ending:"ar\xE1s",replacement:"ar"},{ending:"ar\xE1",replacement:"ar"},{ending:"aremos",replacement:"ar"},{ending:"ar\xE9is",replacement:"ar"},{ending:"ar\xE1n",replacement:"ar"},{ending:"ar\xEDa",replacement:"ar"},{ending:"ar\xEDas",replacement:"ar"},{ending:"ar\xEDamos",replacement:"ar"},{ending:"ar\xEDais",replacement:"ar"},{ending:"ar\xEDan",replacement:"ar"},{ending:"e",replacement:"ar"},{ending:"es",replacement:"ar"},{ending:"emos",replacement:"ar"},{ending:"\xE9is",replacement:"ar"},{ending:"en",replacement:"ar"},{ending:"ara",replacement:"ar"},{ending:"aras",replacement:"ar"},{ending:"\xE1ramos",replacement:"ar"},{ending:"arais",replacement:"ar"},{ending:"aran",replacement:"ar"},{ending:"ase",replacement:"ar"},{ending:"ases",replacement:"ar"},{ending:"\xE1semos",replacement:"ar"},{ending:"aseis",replacement:"ar"},{ending:"asen",replacement:"ar"},{ending:"are",replacement:"ar"},{ending:"ares",replacement:"ar"},{ending:"\xE1remos",replacement:"ar"},{ending:"areis",replacement:"ar"},{ending:"aren",replacement:"ar"},{ending:"a",replacement:"ar"},{ending:"ad",replacement:"ar"},{ending:"ando",replacement:"ar"},{ending:"ado",replacement:"ar"},{ending:"ada",replacement:"ar"},{ending:"ados",replacement:"ar"},{ending:"adas",replacement:"ar"},{ending:"o",replacement:"er"},{ending:"es",replacement:"er"},{ending:"e",replacement:"er"},{ending:"emos",replacement:"er"},{ending:"\xE9is",replacement:"er"},{ending:"en",replacement:"er"},{ending:"o",replacement:"ir"},{ending:"es",replacement:"ir"},{ending:"e",replacement:"ir"},{ending:"imos",replacement:"ir"},{ending:"\xEDs",replacement:"ir"},{ending:"en",replacement:"ir"},{ending:"\xED",replacement:"ir"},{ending:"iste",replacement:"ir"},{ending:"i\xF3",replacement:"ir"},{ending:"ieron",replacement:"ir"},{ending:"\xED",replacement:"er"},{ending:"iste",replacement:"er"},{ending:"i\xF3",replacement:"er"},{ending:"ieron",replacement:"er"},{ending:"\xEDa",replacement:"er"},{ending:"\xEDas",replacement:"er"},{ending:"\xEDamos",replacement:"er"},{ending:"\xEDais",replacement:"er"},{ending:"\xEDan",replacement:"er"},{ending:"\xEDa",replacement:"ir"},{ending:"\xEDas",replacement:"ir"},{ending:"\xEDamos",replacement:"ir"},{ending:"\xEDais",replacement:"ir"},{ending:"\xEDan",replacement:"ir"}];for(let s of i)if(t.length>s.ending.length+2&&t.endsWith(s.ending)){let d=t.slice(0,-s.ending.length)+s.replacement;o.push(d)}}let n=[{ending:"ora",replacement:"or"},{ending:"riz",replacement:"r"},{ending:"esa",replacement:""},{ending:"ina",replacement:"o"},{ending:"ica",replacement:"o"},{ending:"ada",replacement:"ado"},{ending:"a",replacement:"o"}];for(let i of n)if(t.length>i.ending.length+2&&t.endsWith(i.ending)){let c=t.slice(0,-i.ending.length)+i.replacement;o.push(c)}let a=["s","es","mente"];for(let i of a)t.length>i.length+2&&t.endsWith(i)&&o.push(t.slice(0,-i.length));return[...new Set(o)]}hasKeyboardMashing(t){if(/([a-zA-Z])\1{3,}/.test(t))return!0;let o=["qwertyuiop","asdfghjkl","zxcvbnm"];for(let n of o)for(let a=0;a<=n.length-4;a++){let r=n.substr(a,4);if(t.toLowerCase().includes(r))return!0}return!1}hasReasonableVowelRatio(t){let o=t.toLowerCase().replace(/[^a-z]/g,"");if(o.length<4)return!0;let a=(o.match(/[aeiou]/g)||[]).length/o.length;return a>=.25&&a<=.65}hasReasonableWordLengths(t){let o=t.split(/\s+/).filter(r=>r.length>0);if(o.length<2)return!0;let n=20;return!o.some(r=>r.length>n&&!/[-_]/.test(r))}static async isValidText(t){return new e().isValidText(t)}},Ce=Ao});async function js(){let e=new Ce;await e.ensureInitialized(),window.globalTextValidator=e}var Su,_a,Ws,Na,qa,Ba,Vs,Lo,So=N(()=>{"use strict";H();j();ot();_t();Su=new Ce,_a=e=>{let t=e.querySelectorAll('input[type="text"], textarea');return Ws(t),Lo(t),js(),t};Ws=e=>{e.forEach(t=>{t.removeEventListener("input",Na),t.removeEventListener("focus",qa),t.removeEventListener("blur",Ba),t.addEventListener("input",Na),t.addEventListener("focus",qa),t.addEventListener("blur",Ba)})},Na=e=>{let t=e.target;we(t),Vs(t)},qa=e=>{e.target.classList.add("border-blue-500","ring-2","ring-blue-200")},Ba=e=>{e.target.classList.remove("border-blue-500","ring-2","ring-blue-200")},Vs=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.getAttribute("data-aria-id"),n=`${t}_${o}`;localStorage.setItem(n,e.value)},Lo=e=>{e.forEach(t=>{let o=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],n=t.getAttribute("data-aria-id"),a=`${o}_${n}`,r=localStorage.getItem(a);r!==null&&(t.value=r)}),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page")}});var Pa,Us,Gs,we,Ks,Qs,Ma,Js,Zs,Xs,Ys,el,$a,tl,ol,ot=N(()=>{"use strict";H();j();So();D();pe();$t();Pa=e=>{let t=e.querySelectorAll('section input[type="text"]:not(#filter-input), section textarea:not(#filter-input)');return Us(t),Lo(t),t},Us=e=>{e.forEach(t=>{t.addEventListener("input",Gs),t.addEventListener("focus",Ks),t.addEventListener("blur",Qs)})},Gs=e=>{let t=e.target,o=t.getAttribute("data-activity-item");if(we(t),$a(t),ol(t),window.interchangeablePairs&&window.interchangeablePairs[o]){let n=window.interchangeablePairs[o];for(let a of n){let r=document.querySelector(`[data-activity-item="${a}"]`);r&&$a(r)}}window.updateResetButtonVisibility&&window.updateResetButtonVisibility(!0)},we=e=>{let t=e.getAttribute("data-activity-item"),o=e.getAttribute("data-aria-id"),n=e.id||"";[`.feedback-icon-for-${t}`,`.feedback-icon-for-${o}`,`.feedback-icon-for-${n}`,".feedback-icon-for-feedback",".feedback-icon-for-profanity",".feedback-icon-for-gibberish"].forEach(s=>{document.querySelectorAll(s).forEach(d=>{d&&d.parentNode===e.parentNode&&d.remove()})});let r=e.parentNode;if(r){if(window.getComputedStyle(r).display==="flex"){let c=r.parentNode;c&&c.querySelectorAll(".feedback-container").forEach(u=>{u.remove()})}r.querySelectorAll(".feedback").forEach(c=>{c.remove()})}e.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200","border-red-500","focus:border-red-500","focus:ring-red-200","border-orange-500","focus:border-orange-500","focus:ring-orange-200","focus:ring"),e.removeAttribute("aria-invalid"),e.removeAttribute("data-has-profanity-feedback"),e.removeAttribute("data-has-gibberish-feedback");let i=e.getAttribute("aria-label")||"";if(i.includes(" - ")){let s=i.split(" - ");s[0].includes("Las opciones disponibles son:"),e.setAttribute("aria-label",s[0])}e.style.paddingRight=""},Ks=e=>{e.target.classList.add("border-blue-500","ring-2","ring-blue-200")},Qs=e=>{e.target.classList.remove("border-blue-500","ring-2","ring-blue-200")},Ma=()=>{let e=document.querySelectorAll('section input[type="text"]:not(#filter-input), section textarea:not(#filter-input)');Js();let t=Zs(e);el(t)},Js=()=>{document.querySelectorAll(".feedback").forEach(t=>t.remove())},Zs=e=>{let t=!0,o=null,n=0;return e.forEach(a=>{let r=Xs(a);r.isCorrect||(t=!1,!o&&!r.isFilled&&(o=a)),r.isFilled||n++}),{allCorrect:t,firstIncorrectInput:o,unfilledCount:n}},Xs=e=>{let t=e.getAttribute("data-activity-item"),o=correctAnswers[t],n=e.value.trim().toLowerCase(),a=!1,r=n!=="";if(o&&o.includes("|")){let i=o.split("|");a=r&&i.some(s=>n===s.trim().toLowerCase())}else if(window.interchangeablePairs&&window.interchangeablePairs[t]){let i=window.interchangeablePairs[t],s=i.map(c=>correctAnswers[c]);if(a=r&&o&&n===o.toLowerCase()||s.some(c=>c&&n===c.toLowerCase()),a&&i.length>0)for(let c of i){let d=document.querySelector(`[data-activity-item="${c}"]`);if(d&&d.value.trim().toLowerCase()===n)return a=!1,ke(e,!1,"No puedes usar la misma palabra en ambos campos",b.FILL_IN_THE_BLANK),{isCorrect:!1,isFilled:r}}}else a=r&&o&&o.toLowerCase()===n;return ke(e,a,o,b.FILL_IN_THE_BLANK),a||Ys(e,t),{isCorrect:a,isFilled:r}},Ys=(e,t)=>{let o=e.parentNode.querySelector(".feedback");o&&(o.setAttribute("aria-live","assertive"),o.id=`feedback-${t}`,e.setAttribute("aria-describedby",o.id))},el=e=>{let{allCorrect:t,firstIncorrectInput:o,unfilledCount:n}=e;o&&o.focus();let a=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],r=a+"-intentos",i=localStorage.getItem(r);if(i===null?(localStorage.setItem(r,"0"),i=0):i=parseInt(i,10),i++,localStorage.setItem(r,i.toString()),A(t?"success":"error"),t){let s=localStorage.getItem("completedActivities"),c=s?JSON.parse(s):[],d=localStorage.getItem("namePage"),u=new Date().toLocaleString("es-ES"),m=`${a}-${d}-${i}-${u}`;c=c.filter(y=>!y.startsWith(`${a}-`)),c.push(m),localStorage.setItem("completedActivities",JSON.stringify(c)),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page"),U(b.FILL_IN_THE_BLANK)}W(t,f("next-activity"),b.FILL_IN_THE_BLANK,n)},$a=e=>{let t=e.value.trim().toLowerCase(),o=e.getAttribute("data-activity-item"),n=correctAnswers[o],a=e.parentNode.querySelector(".feedback");a&&a.textContent==="Palabra duplicada"&&e.parentNode.removeChild(a);let r=!1,i=!1;if(window.interchangeablePairs&&window.interchangeablePairs[o]){let s=window.interchangeablePairs[o],c=s.map(d=>correctAnswers[d]);if(r=t!==""&&(t===n.toLowerCase()||c.some(d=>t===d.toLowerCase())),r&&t!=="")for(let d of s){let u=document.querySelector(`[data-activity-item="${d}"]`);if(u&&u.value.trim().toLowerCase()===t){r=!1,i=!0;let m=document.createElement("span");m.classList.add("feedback","ml-2","px-2","py-1","rounded-full","text-sm","font-medium","bg-red-100","text-red-800"),m.textContent="Palabra duplicada",e.parentNode.appendChild(m);break}}}else if(n&&n.includes("|")){let s=n.split("|");r=t!==""&&s.some(c=>t===c.trim().toLowerCase())}else r=t!==""&&n&&n.toLowerCase()===t;return tl(e,r),{isValid:r,hasDuplicate:i}},tl=(e,t)=>{e.classList.remove("border-red-500","border-green-500");let o=e.value.trim();if(o!==""){e.classList.add(t?"border-green-500":"border-red-500");let n=e.dataset.wasValid==="true";t&&!n&&o.length>0?A("validate_success"):t||A("validate_error"),e.dataset.wasValid=t.toString()}},ol=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.getAttribute("data-aria-id"),n=`${t}_${o}`;localStorage.setItem(n,e.value)}});async function nl(){let e=new Ce;await e.ensureInitialized(),window.globalTextValidator=e}var Oa,al,rl,il,sl,Fa,ll,cl,dl,ul,Ra,ml,gl,pl,fl,yl,bl,hl,wo=N(()=>{"use strict";H();j();ot();D();$t();pe();_t();Oa=e=>{let t=e.querySelectorAll('input[type="text"]:not(#filter-input), textarea:not(#filter-input)');return al(t),yl(t),nl(),t};al=e=>{e.forEach(t=>{t.addEventListener("input",rl),t.addEventListener("focus",il),t.addEventListener("blur",sl),t.classList.add("border","border-gray-300","rounded","p-2","w-full","transition-colors","duration-200")})},rl=e=>{let t=e.target;Ra(t),fl(t);let o=t.closest("td, th");o&&o.classList.remove("bg-red-50","bg-green-50","border-red-300","border-green-300"),t.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200","border-red-500","focus:border-red-500","focus:ring-red-200","border-orange-500","focus:border-orange-500","focus:ring-orange-200","focus:ring")},il=e=>{let t=e.target;t.classList.add("border-blue-500","ring-2","ring-blue-200"),bl(t)},sl=e=>{let t=e.target;t.classList.remove("border-blue-500","ring-2","ring-blue-200"),hl(t)},Fa=()=>{let e=document.querySelectorAll('section input[type="text"]:not(#filter-input), section textarea:not(#filter-input)');ll();let t=cl(e),o=Io(e),n={...t,hasGibberish:o,isValid:t.allFilled&&o};ml(n)},ll=()=>{document.querySelectorAll(".feedback").forEach(e=>e.remove()),document.querySelectorAll(".cell-highlight").forEach(e=>{e.classList.remove("cell-highlight","bg-blue-50")})},cl=e=>{let t=!0,o=0,n=0,r=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0]+"-intentos",i=localStorage.getItem(r);i===null?(localStorage.setItem(r,"0"),i=0):i=parseInt(i,10),i++,localStorage.setItem(r,i.toString());let s=document.getElementsByClassName("filled-not-required").length>0;return e.forEach(c=>{let d=dl(c);d.isFilled||(t=!1,o++),d.isCorrect&&n++}),s&&(t=!0,o=0),{allFilled:t,unfilledCount:o,correctCount:n}},dl=e=>{let t=e.value.trim(),o=e.getAttribute("data-activity-item"),n=e.getAttribute("data-aria-id"),a=document.getElementsByClassName("filled-not-required").length>0,r;try{typeof correctAnswers<"u"&&correctAnswers[o]?r=correctAnswers[o]:typeof correctAnswers<"u"&&correctAnswers[n]?r=correctAnswers[n]:r=null}catch(c){console.warn("Could not retrieve correct answer:",c),r=null}let i=t!=="",s=a&&!i?!0:r?r.toLowerCase()===t.toLowerCase():i;return a&&!i?Ra(e):(ke(e,s,r,b.FILL_IN_A_TABLE),ul(e,i,s)),{isFilled:i,isCorrect:a?!0:s}},ul=(e,t,o)=>{let n=e.closest("td, th");n&&(n.classList.remove("bg-red-50","bg-green-50","border-red-300","border-green-300"),t&&(o?n.classList.add("bg-green-50","border-green-300"):n.classList.add("bg-red-50","border-red-300")))},Ra=e=>{let t=e.getAttribute("data-activity-item"),o=e.getAttribute("data-aria-id"),n=e.id||"";[`.feedback-icon-for-${t}`,`.feedback-icon-for-${o}`,`.feedback-icon-for-${n}`].forEach(s=>{document.querySelectorAll(s).forEach(d=>{d&&(d.parentNode===e.parentNode||d.closest("td")===e.closest("td"))&&d.remove()})}),e.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200","border-red-500","focus:border-red-500","focus:ring-red-200","focus:ring");let r=e.closest("td, th");r&&r.classList.remove("bg-red-50","bg-green-50","border-red-300","border-green-300"),e.removeAttribute("aria-invalid");let i=e.getAttribute("aria-label")||"";i.includes(" - ")&&e.setAttribute("aria-label",i.split(" - ")[0]),e.style.paddingRight=""},ml=e=>{let{allFilled:t,unfilledCount:o,correctCount:n,hasGibberish:a,isValid:r}=e;if(t&&r){A("success"),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page");let i=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],s=i+"-intentos",c=localStorage.getItem(s),d=localStorage.getItem("completedActivities"),u=d?JSON.parse(d):[],m=localStorage.getItem("namePage"),y=new Date().toLocaleString("es-ES"),p=`${i}-${m}-${c}-${y}`;u=u.filter(h=>!h.startsWith(`${i}-`)),u.push(p),localStorage.setItem("completedActivities",JSON.stringify(u)),U(b.FILL_IN_A_TABLE)}else A("error");W(t&&r,f("next-activity"),b.FILL_IN_A_TABLE,o)},gl=e=>{let t=e.value.trim(),o=e.getAttribute("data-activity-item"),n;try{n=correctAnswers?.[o]??null}catch{n=null}let r=n?n.toLowerCase()===t.toLowerCase():t!=="";pl(e,r)},pl=(e,t)=>{let o=e.closest("td, th");o&&(e.classList.remove("border-red-500","border-green-500"),o.classList.remove("bg-red-50","bg-green-50"),e.value.trim()!==""&&(e.classList.add(t?"border-green-500":"border-red-500"),o.classList.add(t?"bg-green-50":"bg-red-50")))},fl=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=e.getAttribute("data-aria-id")||e.id||e.getAttribute("data-activity-item");if(!o){console.warn("Input element has no identifier for storage:",e);return}let n=`${t}_${o}`;localStorage.setItem(n,e.value)},yl=e=>{e.forEach(t=>{let o=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],n=t.getAttribute("data-aria-id")||t.id||t.getAttribute("data-activity-item");if(!n){console.warn("Input element has no identifier for loading:",t);return}let a=`${o}_${n}`,r=localStorage.getItem(a);r!==null&&(t.value=r,gl(t))}),localStorage.setItem("namePage",document.querySelector("h1")?.innerText||document.title)},bl=e=>{let t=e.closest("td, th");if(!t)return;let o=t.parentElement.rowIndex,n=t.cellIndex,a=t.closest("table");if(!a)return;let r=a.rows[o];Array.from(r.cells).forEach(i=>{i.classList.add("bg-blue-50","cell-highlight")}),Array.from(a.rows).forEach(i=>{let s=i.cells[n];s&&s.classList.add("bg-blue-50","cell-highlight")})},hl=e=>{document.querySelectorAll(".cell-highlight").forEach(t=>{t.classList.remove("bg-blue-50","cell-highlight")})}});function xl(e){let t=0,o=0;for(let n=0;n<e.length-1;n++){let a=e.substring(n,n+2);a.includes(" ")||(o++,He.commonBigrams.includes(a)&&t++)}return o>0?Math.min(1,t/o):0}function El(e){let t=e.replace(/\s+/g,"");if(t.length===0)return 0;let o=0;for(let a=0;a<t.length;a++)He.vowels.includes(t[a])&&o++;let n=o/t.length;return 1-Math.min(1,Math.abs(.47-n)*2.5)}function Al(e){let t=e.split(/\s+/).filter(n=>n.length>2);if(t.length===0)return 0;let o=0;return t.forEach(n=>{for(let a of He.commonEndings)if(n.endsWith(a)){o++;break}}),Math.min(1,o/t.length)}function Ll(e){let t=0;for(let o of He.specialChars)e.includes(o)&&t++;return Math.min(1,t/3)}function Sl(e){return/(.)\1{2,}/.test(e)?!0:/(.{2,})\1{2,}/.test(e)}function wl(e){let t=e.split(/\s+/);for(let o of t)if(o.length>1&&He.commonWords.includes(o))return!0;return!1}function Il(e){for(let t of He.invalidClusters)if(e.includes(t))return!0;return!1}var He,vl,za,Da=N(()=>{"use strict";He={commonBigrams:["es","de","en","el","la","qu","ue","ar","os","as","er","ra","al","an","nt","or","co","ci","ca","ro","st","ie","ta","te","me","to","tr","pe","pa","ma","do","lo"],commonEndings:["ar","er","ir","os","as","es","i\xF3n","dad","ado","ido","mente","ista","amos","emos","imos","ando","endo","able","ante","encia","anza","tico","tivo","tulo"],specialChars:["\xE1","\xE9","\xED","\xF3","\xFA","\xFC","\xF1","\xBF","\xA1"],vowels:["a","e","i","o","u","\xE1","\xE9","\xED","\xF3","\xFA","\xFC"],invalidClusters:["bk","cg","dk","fh","gj","jf","kw","mz","pz","qk","xz","zx","zv"],commonWords:["el","la","los","las","un","una","unos","unas","y","o","pero","sin","con","para","por","de","del","al","en","yo","t\xFA","\xE9l","ella","nosotros","vosotros","ellos","ellas","mi","su","ese","esta","esto","aqu\xED","all\xED","ahora","antes","despu\xE9s","s\xED","no","bien","mal","m\xE1s","menos","muy","poco","mucho","todo","nada","algo","quien","que","como","cuando","donde","porque","ser","estar","ir","venir","hacer","tener","decir","dar","ver","poner","casa","tiempo","d\xEDa","a\xF1o","hombre","mujer","ni\xF1o","ni\xF1a","vida","ejemplo","palabra"]},vl=e=>{if(!e||e.length<3)return .5;let t=e.toLowerCase();if(Sl(t))return .1;if(wl(t))return .8;if(Il(t))return .2;let o=xl(t),n=El(t),a=Al(t),r=Ll(t),i=o*.5+n*.3+a*.15+r*.05;return Math.min(1,Math.max(0,i))},za=e=>{let t=["subt\xEDtulo","t\xEDtulo","cap\xEDtulo","fauna","flora","c\xE1psula","c\xE1psulas","c\xE1psula","rubio","rubia","t\xEDtulos","subt\xEDtulos","gris"];for(let n of t)if(e.toLowerCase().includes(n))return!0;return vl(e)>.25}});var Cl,Co,Ha=N(()=>{"use strict";Cl=["fuck","shit","ass","damn","bitch","bastard","cunt","dick","penis","vagina","mierda","puta","pene","pija","boludez","puto","boludo","boluda","joder","carajo","co\xF1o","pendejo","culero","verga","polla","chinga","follar","marica","maricon","pinche","cabron","cabr\xF3n","culo","gilipollas","qu\xE9 cabr\xF3n","la concha de tu madre","co\xF1o","carajo","puta madre","pelotudo"],Co=e=>{if(!e||typeof e!="string")return!1;let t=e.toLowerCase();return Cl.some(o=>new RegExp(`\\b${o}\\b`,"i").test(t))}});var be,kl,ja,Tl,Nl,Io,Wa,Ua,Va,ql,Bl,Ga,Ka,_l,$l,Pl,$t=N(()=>{"use strict";j();D();H();so();Ct();ot();Bt();Nt();Eo();wo();Da();pe();Ha();_t();be=e=>{try{switch(e){case b.MULTIPLE_CHOICE:Qn();break;case b.QUIZ:sa();break;case b.FILL_IN_THE_BLANK:Ma();break;case b.OPEN_ENDED_ANSWER:Tl();break;case b.SORTING:yo();break;case b.MATCHING:xo();break;case b.TRUE_FALSE:Ta();break;case b.FILL_IN_A_TABLE:Fa();break;default:throw console.error("Unknown validation type:",e),new Error(`Unsupported activity type: ${e}`)}}catch(t){console.error(`Validation error for ${e}:`,t),Pl(t)}},kl=()=>{document.querySelectorAll('section input[type="text"], section textarea').forEach(t=>{t.removeEventListener("input",ja),t.addEventListener("input",ja)})},ja=e=>{let t=e.target;we(t)},Tl=async()=>{kl();let e=document.querySelector('[data-section-type="activity_open_ended_answer"]');if(!e){console.error("No open-ended activity section found");return}let t=e.querySelectorAll('input[type="text"]:not(#filter-input), textarea:not(#filter-input)');t.forEach(c=>{we(c)});let o=Nl(t),n=await Io(t),a=o===0&&!n;_l(a);let i=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0]+"-intentos",s=localStorage.getItem(i);if(s===null?(localStorage.setItem(i,"0"),s=0):s=parseInt(s,10),s++,localStorage.setItem(i,s.toString()),a){let c=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],d=localStorage.getItem("completedActivities"),u=d?JSON.parse(d):[],m=localStorage.getItem("namePage"),y=new Date().toLocaleString("es-ES"),p=`${c}-${m}-${s}-${y}`;u=u.filter(h=>!h.startsWith(`${c}-`)),u.push(p),localStorage.setItem("completedActivities",JSON.stringify(u)),localStorage.setItem("namePage",document.querySelector("h1")?.innerText??"unknown_page"),U(b.OPEN_ENDED_ANSWER)}$l(a,o,n)},Nl=e=>{let t=0,o=null;return Array.from(e).forEach(n=>{let a=n.value.trim()!=="";ql(n,a),a||(t++,o||(o=n))}),o&&setTimeout(()=>{o.focus()},50),t},Io=async e=>{let t=!1,o=!1,n=null,a=null,r=window.globalTextValidator||new Ce;window.globalTextValidator||await r.ensureInitialized();let i=Array.from(e);for(let s of i){let c=s.value.trim();if(c.length>0)try{if(Co(c))o=!0,Wa(s),a||(a=s);else{if(s.classList.contains("do-not-validate"))continue;await r.isValidText(c)||(t=!0,Va(s),n||(n=s))}}catch(d){console.error("Error validating text:",d),za(c)?Co(c)&&(o=!0,Wa(s),a||(a=s)):(t=!0,Va(s),n||(n=s))}}return a?a.focus():n&&n.focus(),t||o},Wa=e=>{we(e);let t=Ga();t.classList.add("text-red-600"),t.textContent=f("validation-inappropriate-language")||"Inappropriate language",t.style.display="block",t.style.width="100%",t.style.textAlign="left",e.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200","border-orange-500","focus:border-orange-500","focus:ring-orange-200"),e.classList.add("border-red-500","focus:border-red-500","focus:ring-red-200","focus:ring"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-label",`${e.value} - ${f("validation-inappropriate-language")||"Inappropriate language"}`),e.setAttribute("data-has-profanity-feedback","true"),e.style.paddingRight="30px";let o=document.createElement("div"),n=e.getAttribute("data-aria-id")||"",a=e.getAttribute("data-activity-item")||"";o.className=`feedback-icon-for-${n||e.id||a||"profanity"}`,o.style.position="absolute",o.style.pointerEvents="none",o.style.zIndex="10";let r=document.createElement("i");r.className="fas fa-exclamation-circle text-red-600 feedback-icon",r.setAttribute("aria-hidden","true"),o.appendChild(r);let i=e.getBoundingClientRect(),s=e.parentNode.getBoundingClientRect(),c=i.top-s.top+(i.height-24)/2,d=s.right-i.right+10;o.style.top=`${c}px`,o.style.right=`${d}px`,window.getComputedStyle(e.parentNode).position==="static"&&(e.parentNode.style.position="relative"),e.parentNode.insertBefore(o,e.nextSibling),Ua(e).appendChild(t),Ka(e,t)},Ua=e=>{let t=e.parentNode,o=window.getComputedStyle(t).display==="flex",n=window.getComputedStyle(t).display==="grid";if(o||n){let a=t.parentNode,r=document.createElement("div");return r.className="feedback-container w-full mt-2",r.style.marginTop="0.5rem",a.lastChild===t?a.appendChild(r):a.insertBefore(r,t.nextSibling),r}if(e.tagName.toLowerCase()==="textarea"){let a=document.createElement("div");return a.className="feedback-container w-full",t.insertBefore(a,e.nextSibling),a}return t},Va=e=>{we(e);let t=Ga();t.classList.add("text-orange-500"),t.textContent=f("validation-check-spelling")||"Check your spelling",t.style.display="block",t.style.width="100%",t.style.textAlign="left",e.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200","border-red-500","focus:border-red-500","focus:ring-red-200"),e.classList.add("border-orange-500","focus:border-orange-500","focus:ring-orange-200","focus:ring"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-label",`${e.value} - ${f("validation-check-spelling")||"Check your spelling"}`),e.setAttribute("data-has-gibberish-feedback","true"),e.style.paddingRight="30px";let o=document.createElement("div"),n=e.getAttribute("data-aria-id")||"";o.className=`feedback-icon-for-${n||e.id||"gibberish"}`,o.style.position="absolute",o.style.pointerEvents="none",o.style.zIndex="10";let a=document.createElement("i");a.className="fas fa-question-circle text-orange-500 feedback-icon",a.setAttribute("aria-hidden","true"),o.appendChild(a);let r=e.getBoundingClientRect(),i=e.parentNode.getBoundingClientRect(),s=r.top-i.top+(r.height-24)/2,c=i.right-r.right+10;o.style.top=`${s}px`,o.style.right=`${c}px`,window.getComputedStyle(e.parentNode).position==="static"&&(e.parentNode.style.position="relative"),e.parentNode.insertBefore(o,e.nextSibling),Ua(e).appendChild(t),Ka(e,t)},ql=(e,t)=>{let o=window.utils||{};o.provideFeedback?o.provideFeedback(e,t,"",b.OPEN_ENDED_ANSWER):Bl(e,t)},Bl=(e,t)=>{e.style.paddingRight="30px";let o=`.feedback-icon-for-${e.id||"feedback"}`,n=document.querySelector(o);n&&n.remove();let a=document.createElement("div"),r=e.getAttribute("data-aria-id")||"";a.className=`feedback-icon-for-${r||e.id||"feedback"}`,a.style.position="absolute",a.style.pointerEvents="none",a.style.zIndex="10";let i=document.createElement("i");i.className=t?"fas fa-check-circle text-green-600 feedback-icon":"fas fa-times-circle text-red-600 feedback-icon",i.setAttribute("aria-hidden","true"),a.appendChild(i),t?(e.setAttribute("aria-invalid","false"),e.setAttribute("aria-label",`${e.value} - ${f("fill-in-the-blank-correct-answer")}`),e.classList.remove("border-red-500","focus:border-red-500","focus:ring-red-200"),e.classList.add("border-green-500","focus:border-green-500","focus:ring-green-200","focus:ring")):(e.setAttribute("aria-invalid","true"),e.setAttribute("aria-label",`${e.value} - ${f("fill-in-the-blank-try-again")}`),e.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200"),e.classList.add("border-red-500","focus:border-red-500","focus:ring-red-200","focus:ring"));let s=e.getBoundingClientRect(),c=e.parentNode.getBoundingClientRect(),d=s.top-c.top+(s.height-24)/2,u=c.right-s.right+10;a.style.top=`${d}px`,a.style.right=`${u}px`,window.getComputedStyle(e.parentNode).position==="static"&&(e.parentNode.style.position="relative"),e.parentNode.insertBefore(a,e.nextSibling)},Ga=()=>{let e=document.createElement("span");return e.classList.add("feedback","text-base","text-nowrap","font-medium","transition-colors","duration-200"),e.setAttribute("role","alert"),e},Ka=(e,t)=>{let o=`feedback-${Math.random().toString(36).substr(2,9)}`;t.id=o,e.setAttribute("aria-describedby",o)},_l=e=>{A(e?"success":"error")},$l=(e,t,o)=>{if(W(e,f("next-activity"),b.OPEN_ENDED_ANSWER,t),o){let n=document.getElementById("toast");n&&(n.classList.remove("hidden"),n.classList.add("text-orange-700"),n.textContent=f("validation-write-appropriate")||"Please use appropriate language",setTimeout(()=>{n.classList.add("hidden")},3e3))}},Pl=e=>{let t=document.getElementById("toast");t&&(t.textContent=f("validation-error"),t.classList.remove("hidden"),t.classList.add("bg-red-200","text-red-700"),setTimeout(()=>{t.classList.add("hidden")},3e3))}});function No(){let e={};e[b.FILL_IN_THE_BLANK]=o=>{To(o,{sectionSelector:nt.FILL_IN_THE_BLANK,inputSelector:'input[type="text"]:not(#filter-input)'})},e[b.FILL_IN_A_TABLE]=o=>{To(o,{sectionSelector:nt.FILL_IN_A_TABLE,inputSelector:'input[type="text"]:not(#filter-input), textarea:not(#filter-input)'})},e[b.MULTIPLE_CHOICE]=o=>{let n=document.querySelector(nt.MULTIPLE_CHOICE),a=n?n.querySelectorAll('input[type="radio"]'):document.querySelectorAll('input[type="radio"]');Qa(a),document.querySelectorAll(".activity-option span").forEach(r=>{r.classList.remove(...ee.FEEDBACK.SUCCESS,...ee.FEEDBACK.ERROR,"border-green-600","border-red-600","border-2");let i=r.querySelector(".mark");i&&i.remove();let s=r.querySelector(".sr-only");s&&s.remove()}),localStorage.removeItem(`${o}_selectedOption`)},e[b.QUIZ]=o=>{go(o)},e[b.TRUE_FALSE]=o=>{let n=document.querySelector(nt.TRUE_FALSE),a=n?n.querySelectorAll('input[type="radio"]'):document.querySelectorAll('input[type="radio"]');Qa(a),document.querySelectorAll(".statement-option").forEach(r=>{r.classList.remove(...ee.FEEDBACK.SUCCESS,...ee.FEEDBACK.ERROR);let i=r.querySelector(".feedback-icon");i&&i.remove()}),Object.keys(localStorage).filter(r=>r.startsWith(`${o}_tf_`)).forEach(r=>localStorage.removeItem(r))},e[b.OPEN_ENDED_ANSWER]=o=>{To(o,{sectionSelector:nt.OPEN_ENDED,inputSelector:'textarea, input[type="text"]'})},e[b.SORTING]=o=>{Promise.resolve().then(()=>(Nt(),ha)).then(n=>{n.resetActivity&&n.resetActivity(o)})},e[b.MATCHING]=o=>{Promise.resolve().then(()=>(Bt(),Ia)).then(n=>{n.resetActivity&&n.resetActivity(o)})};let t={};return t[b.MULTIPLE_CHOICE]={setup:Gn,validate:()=>be(b.MULTIPLE_CHOICE)},t[b.QUIZ]={setup:ia,validate:()=>be(b.QUIZ)},t[b.FILL_IN_THE_BLANK]={setup:Pa,validate:()=>be(b.FILL_IN_THE_BLANK)},t[b.OPEN_ENDED_ANSWER]={setup:_a,validate:()=>be(b.OPEN_ENDED_ANSWER)},t[b.SORTING]={setup:po,validate:()=>be(b.SORTING)},t[b.MATCHING]={setup:ho,validate:()=>be(b.MATCHING)},t[b.TRUE_FALSE]={setup:ka,validate:()=>be(b.TRUE_FALSE)},t[b.FILL_IN_A_TABLE]={setup:Oa,validate:()=>be(b.FILL_IN_A_TABLE)},{activityResetHandlers:e,activityHandlers:t}}var ee,nt,Xa,ko,Ml,Ol,J,Fl,Rl,Qa,Ja,Za,zl,Dl,Hl,jl,To,at,rt,Wl,Vl,Ya,ze=N(()=>{"use strict";z();j();H();so();Ct();Nt();Bt();Eo();$t();ot();wo();So();D();Xe();ee={VALIDATION:{SUCCESS:["border-green-500","focus:border-green-500","focus:ring-green-200"],ERROR:["border-red-500","focus:border-red-500","focus:ring-red-200"],WARNING:["border-orange-500","focus:border-orange-500","focus:ring-orange-200"]},FEEDBACK:{SUCCESS:["bg-green-100","border-green-300"],ERROR:["bg-red-100","border-red-300"]}},nt={FILL_IN_THE_BLANK:'section[data-section-type="activity_fill_in_the_blank"]',FILL_IN_A_TABLE:'section[data-section-type="activity_fill_in_a_table"]',MULTIPLE_CHOICE:'section[data-section-type="activity_multiple_choice"]',QUIZ:'section[data-section-type="activity_quiz"]',TRUE_FALSE:'section[data-section-type="activity_true_false"]',OPEN_ENDED:'section[data-section-type="activity_open_ended_answer"]'},Xa=()=>location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],ko=e=>{let t=document.querySelectorAll(e);return Array.from(t).some(o=>o.value.trim()!=="")},Ml=e=>{let t=Xa(),o=Object.keys(localStorage).some(n=>n.startsWith(`${t}_`)&&n!==`${t}_success`);if(o)return!0;if(e==="activity_open_ended_answer")return ko('section textarea, section input[type="text"]');if(e==="activity_fill_in_the_blank")return ko('section .blank-input, section input[type="text"]:not(#filter-input)');if(e==="activity_fill_in_a_table")return ko('section td input[type="text"], section td textarea');if(e==="activity_multiple_choice")return document.querySelectorAll('section input[type="radio"]:checked').length>0;if(e==="activity_quiz")return document.querySelectorAll('section input[type="radio"]:checked').length>0;if(e==="activity_true_false")return document.querySelectorAll('section input[type="radio"]:checked').length>0;if(e==="activity_sorting")return document.querySelectorAll("section .placed-word").length>0||o;if(e==="activity_matching")return document.querySelectorAll("section .matching-item.matched").length>0||o},Ol=()=>{let e=document.querySelector('section[role="activity"]');if(!e)return!1;let t=e.dataset.sectionType;return Ml(t)},J=()=>{let e=document.getElementById("reset-button");if(!e)return;let o=document.querySelector('section[role="activity"]')?.dataset.sectionType;if(!new Set([b.OPEN_ENDED_ANSWER,b.FILL_IN_THE_BLANK,b.SORTING,b.FILL_IN_A_TABLE,b.MATCHING]).has(o)){e.classList.add("hidden");return}let a=Ol();e.classList.toggle("hidden",!a)},Fl=(e,t)=>{e.forEach(o=>{o.value="",o.classList.remove(...ee.VALIDATION.SUCCESS,...ee.VALIDATION.ERROR,...ee.VALIDATION.WARNING);let n=o.getAttribute("data-aria-id")||o.getAttribute("data-activity-item");if(n){let a=`${t}_${n}`;localStorage.removeItem(a)}})},Rl=()=>{document.querySelectorAll("[class^='feedback-icon-for-']").forEach(e=>{e.remove()}),document.querySelectorAll(".feedback-container").forEach(e=>{e.innerHTML=""})},Qa=e=>{e.forEach(t=>{t.checked=!1})},Ja=["min-w-[180px]","px-8","py-3","rounded-2xl","text-lg","font-semibold","shadow-lg"],Za=["px-6","py-3","rounded-2xl","text-lg","font-medium"],zl=e=>{let t=e?.querySelector("[data-submit-target]"),o=document.getElementById("submit-button"),n=document.getElementById("reset-button"),a=document.getElementById("submit-reset-container");if(!o||!a)return;let r=()=>{Ja.forEach(s=>o.classList.add(s)),n&&Za.forEach(s=>n.classList.add(s)),o.dataset.submitLocation="activity"},i=()=>{Ja.forEach(s=>o.classList.remove(s)),n&&Za.forEach(s=>n.classList.remove(s)),o.dataset.submitLocation="interface"};t?(t.contains(o)||(t.appendChild(o),n&&t.appendChild(n),r()),a.classList.add("hidden")):(a.contains(o)||(a.appendChild(o),n&&a.appendChild(n)),i(),a.classList.remove("hidden"))},Dl=e=>{Object.keys(localStorage).filter(t=>t.startsWith(`${e}_`)).forEach(t=>localStorage.removeItem(t))},Hl=()=>{let e=document.getElementById("submit-button");e&&(e.textContent=f("submit-text"),e.setAttribute("aria-label",f("submit-text")),e.removeEventListener("click",Le),e.dataset.submitState="submit",l.validateHandler&&e.addEventListener("click",l.validateHandler))},jl=()=>{let e=[".feedback-icon","[class^='feedback-icon-for-']",".mark",".validation-mark",".sr-only"].join(", ");document.querySelectorAll(e).forEach(n=>n.remove()),document.querySelectorAll(".feedback-container").forEach(n=>{n.innerHTML=""}),document.querySelectorAll("input, textarea").forEach(n=>{n.classList.remove(...ee.VALIDATION.SUCCESS,...ee.VALIDATION.ERROR,...ee.VALIDATION.WARNING),["aria-invalid","aria-describedby","data-has-gibberish-feedback","data-has-profanity-feedback"].forEach(a=>n.removeAttribute(a))}),document.querySelectorAll(".activity-option span, .statement-option, .placed-word").forEach(n=>{n.classList.remove(...ee.FEEDBACK.SUCCESS,...ee.FEEDBACK.ERROR,"border-green-600","border-red-600","border-2")});let t=document.getElementById("toast");t&&(t.textContent="",t.classList.add("hidden"),t.classList.remove("bg-red-200","text-red-700","bg-green-200","text-green-700","bg-orange-200","text-orange-700"));let o=document.getElementById("feedback");o&&(o.textContent="",o.classList.remove("text-red-500","text-green-500"))},To=(e,{sectionSelector:t,inputSelector:o,additionalReset:n})=>{let a=document.querySelector(t),r=a?a.querySelectorAll(o):document.querySelectorAll(o);Fl(r,e),n&&typeof n=="function"&&n(e),Rl()};Wl=()=>{if(!at){let o=No();at=o.activityResetHandlers,rt=o.activityHandlers}let e=Xa();Dl(e);let t=document.querySelector('section[role="activity"]');if(t){let o=t.dataset.sectionType,n=at[o];n?n(e):console.warn(`No reset handler found for activity type: ${o}`)}A("reset"),Hl(),jl(),J()},Vl=(e,t,o)=>{if(!rt){let a=No();at=a.activityResetHandlers,rt=a.activityHandlers}let n=rt[t];n?(n.setup(e),g("validateHandler",n.validate)):console.error("Unknown activity type:",t),l.validateHandler&&(o.removeEventListener("click",l.validateHandler),o.addEventListener("click",l.validateHandler)),zl(e)},Ya=()=>{let e=No();at=e.activityResetHandlers,rt=e.activityHandlers,qo();let t=document.querySelectorAll('section[role="activity"]'),o=document.getElementById("submit-button"),n=document.getElementById("reset-button");if(t.length===0){o&&o.classList.add("hidden"),n&&n.classList.add("hidden");return}else o&&o.classList.remove("hidden"),n&&n.classList.remove("hidden");if(!o){console.warn("Submit button not found");return}t.forEach(a=>{let r=a.dataset.sectionType;Vl(a,r,o)}),n&&n.addEventListener("click",Wl),J()}});var b,F,Te,W,Ul,er,Gl,ke,Kl,Ql,Jl,Zl,Xl,Yl,ec,tc,oc,nc,ac,rc,tr,j=N(()=>{"use strict";z();de();D();Xe();H();Ee();ze();b=Object.freeze({MULTIPLE_CHOICE:"activity_multiple_choice",QUIZ:"activity_quiz",FILL_IN_THE_BLANK:"activity_fill_in_the_blank",SORTING:"activity_sorting",OPEN_ENDED_ANSWER:"activity_open_ended_answer",MATCHING:"activity_matching",TRUE_FALSE:"activity_true_false",FILL_IN_A_TABLE:"activity_fill_in_a_table"});window.utils={provideFeedback:null};F=(e,t=null)=>{let o=document.getElementById(e);if(o){let n=o.getAttribute("aria-checked")==="true",a=t!==null?t:!n;o.setAttribute("aria-checked",a),o.querySelector("#toggle-dot").classList.toggle("translate-x-5",a),o.querySelector("#toggle-background").classList.toggle("bg-gray-400",!a),o.querySelector("#toggle-background").classList.toggle("bg-blue-700",a)}else console.error(`No element found with ID: ${e}`)},Te=(e,t)=>{let o=document.getElementById(e);if(o){let n=o.querySelector("svg");o.classList.toggle("bg-gray-200",!t),o.classList.toggle("hover:bg-gray-300",!t),o.classList.toggle("bg-blue-50",t),o.classList.toggle("hover:bg-gray-100",t),o.classList.toggle("focus:ring-blue-500",t),n&&(n.classList.toggle("text-gray-600",!t),n.classList.toggle("text-blue-600",t))}else console.error(`No button found with ID: ${e}`)},W=(e,t=f("next-activity"),o,n=0,a={})=>{let r=document.getElementById("submit-button"),i=document.getElementById("reset-button"),s=document.getElementById("toast"),d=!(o===b.MULTIPLE_CHOICE||o===b.QUIZ),m={...{message:"",emoji:"",toastType:"",timeout:6e3,showCloseButton:!0},...a};if(Ul(e),r.removeEventListener("click",l.validateHandler),r.removeEventListener("click",l.retryHandler),r.removeEventListener("click",Le),J(),i&&(o===b.OPEN_ENDED_ANSWER||o===b.FILL_IN_THE_BLANK||o===b.SORTING||o===b.FILL_IN_A_TABLE||o===b.MATCHING?i.classList.remove("hidden"):i.classList.add("hidden")),e){let y=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0];if(oo(y,o),r.textContent=t,r.dataset.submitState=t===f("next-activity")?"next":"submit",d&&s){let p=m.message||(o===b.OPEN_ENDED_ANSWER||o===b.FILL_IN_A_TABLE?f("answers-submitted"):f("correct-answer")),h=m.emoji||"\u{1F389}",x=m.toastType||"success";tr(s,x,h,p,m.showCloseButton)}if(t===f("next-activity")){r.addEventListener("click",Le),r.setAttribute("aria-label",f("next-activity"));let p=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0];localStorage.setItem(`${p}_success`,"true")}d?setTimeout(()=>{s?.classList.add("hidden")},m.timeout||6e3):s?.classList.add("hidden")}else d?er(r,s,o,n,m):(er(r,s,o,n,m),s?.classList.add("hidden"))},Ul=e=>{let t=location.pathname.substring(location.pathname.lastIndexOf("/")+1).split(".")[0],o=document.querySelector(`[class*="${t}"]`);if(!o){console.warn(`Activity icon not found for ID: ${t}`);return}e?(o.classList.replace("fa-pen-to-square","fa-square-check"),o.classList.replace("text-blue-700","text-green-500")):(o.classList.replace("fa-square-check","fa-pen-to-square"),o.classList.replace("text-green-500","text-blue-700"))},er=(e,t,o,n,a={})=>{let r=o===b.MULTIPLE_CHOICE||o===b.QUIZ;if(r?(e.textContent=f("retry"),e.setAttribute("aria-label",f("retry")),e.dataset.submitState="retry",l.retryHandler=ec,e.addEventListener("click",l.retryHandler)):(e.textContent=f("submit-text"),e.setAttribute("aria-label",f("submit-text")),e.dataset.submitState="submit",l.validateHandler&&e.addEventListener("click",l.validateHandler)),r){t?.classList.add("hidden");return}Gl(t,o,n,a)},Gl=(e,t,o,n={})=>{if(!e)return;let a=n.message,r=n.emoji,i=n.toastType;if(!a||!r||!i)if(t===b.OPEN_ENDED_ANSWER||t===b.FILL_IN_THE_BLANK||t===b.FILL_IN_A_TABLE)if(o>0)a=a||f("fill-in-the-blank-not-complete",{unfilledCount:o}),r=r||"\u26A0\uFE0F",i=i||"warning";else{let s;switch(t){case b.FILL_IN_A_TABLE:case b.FILL_IN_THE_BLANK:default:s=f("fill-in-the-blank-try-again")}a=a||s,r=r||"\u{1F914}",i=i||"error"}else a=a||f("fill-in-the-blank-try-again"),r=r||"\u{1F914}",i=i||"error";tr(e,i,r,a,n.showCloseButton!==!1),setTimeout(()=>{e?.classList.add("hidden")},n.timeout||6e3)},ke=(e,t,o,n)=>{let a=document.createElement("span");a.classList.add("feedback","ml-2","px-2","py-1","rounded-full","text-lg","w-32","text-center"),a.setAttribute("role","alert");let r=e.getAttribute("data-activity-item");r&&a.setAttribute("aria-labelledby",r),window.utils.provideFeedback=ke,Kl(e,a,n),Ql(a,t,n,e),a.id=`feedback-${r}`,e.setAttribute("aria-describedby",a.id)},Kl=(e,t,o)=>{},Ql=(e,t,o,n)=>{e.innerText="",e.classList.remove("bg-green-200","text-green-700","bg-red-200","text-red-700"),o===b.FILL_IN_THE_BLANK||o===b.OPEN_ENDED_ANSWER||o===b.FILL_IN_A_TABLE?Jl(e,t,n):o===b.MULTIPLE_CHOICE&&Zl(e,t,n)},Jl=(e,t,o)=>{e.remove();let n=o.getAttribute("data-activity-item")||o.getAttribute("data-aria-id")||o.id||`input-${Math.random().toString(36).substr(2,9)}`;document.querySelectorAll(`.feedback-icon-for-${o.getAttribute("data-activity-item")}`).forEach(y=>y.remove()),o.style.paddingRight="30px";let r=document.createElement("div");r.className=`feedback-icon-for-${n}`,r.style.position="absolute",r.style.pointerEvents="none",r.style.zIndex="10";let i=document.createElement("i");i.className=t?"fas fa-check-circle text-green-600 feedback-icon":"fas fa-times-circle text-red-600 feedback-icon",i.setAttribute("aria-hidden","true"),r.appendChild(i),t?(o.setAttribute("aria-invalid","false"),o.setAttribute("aria-label",`${o.value} - ${f("fill-in-the-blank-correct-answer")}`),o.classList.remove("border-red-500","focus:border-red-500","focus:ring-red-200"),o.classList.add("border-green-500","bg-green-100","focus:border-green-500","focus:ring-green-200","focus:ring")):(o.setAttribute("aria-invalid","true"),o.setAttribute("aria-label",`${o.value} - ${f("fill-in-the-blank-try-again")}`),o.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200"),o.classList.add("border-red-500","focus:border-red-500","focus:ring-red-200","focus:ring"));let s=o.getBoundingClientRect(),c=o.parentNode.getBoundingClientRect(),d=s.top-c.top+(s.height-24)/2,u=c.right-s.right+10;r.style.top=`${d}px`,r.style.right=`${u}px`,window.getComputedStyle(o.parentNode).position==="static"&&(o.parentNode.style.position="relative"),o.parentNode.insertBefore(r,o.nextSibling)},Zl=(e,t,o)=>{let n=o.closest(".activity-option");if(!n)return;let a=n.querySelector("span");if(!a)return;a.querySelector(".mark")?.remove(),t?Xl(e,null,a):Yl(e,null,a)},Xl=(e,t,o)=>{e.remove();let n=o.querySelector(".mark");n&&n.remove();let a=document.createElement("i");a.className="fas fa-check-circle text-green-600 mark tick ml-2",a.setAttribute("aria-hidden","true"),o.appendChild(a);let r=document.createElement("span");r.className="sr-only",r.textContent=f("multiple-choice-correct-answer"),o.appendChild(r),o.classList.add("bg-green-100","border-green-600","border-2")},Yl=(e,t,o)=>{e.remove();let n=o.querySelector(".mark");n&&n.remove();let a=document.createElement("i");a.className="fas fa-times-circle text-red-600 mark cross ml-2",a.setAttribute("aria-hidden","true"),o.appendChild(a);let r=document.createElement("span");r.className="sr-only",r.textContent=f("multiple-choice-try-again"),o.appendChild(r),o.classList.add("bg-red-100","border-red-600","border-2")},ec=()=>{A("reset"),tc(),oc(),nc()},tc=()=>{document.querySelectorAll(".feedback").forEach(t=>{t.remove()}),document.querySelectorAll(".fas.fa-check-circle, .fas.fa-times-circle").forEach(t=>{t.classList.contains("mark")||t.remove()}),document.querySelectorAll("input[type='text'], textarea").forEach(t=>{t.removeAttribute("aria-invalid"),t.removeAttribute("aria-label"),t.classList.remove("border-green-500","focus:border-green-500","focus:ring-green-200","border-red-500","focus:border-red-500","focus:ring-red-200","focus:ring")}),document.querySelectorAll(".activity-option span").forEach(t=>{t.classList.remove("bg-green-100","bg-red-100","border-green-600","border-red-600","border-2");let o=t.querySelector(".mark");o&&o.remove();let n=t.querySelector(".sr-only");n&&n.remove()});let e=document.getElementById("toast");e&&e.remove()},oc=()=>{document.querySelectorAll("input[type='radio']").forEach(t=>{t.classList.remove("bg-green-200","bg-red-200","text-black")})},nc=()=>{l.selectedButton=null;let e=document.getElementById("submit-button");e&&(e.textContent=f("submit-text"),e.setAttribute("aria-label",f("submit-text")),e.removeEventListener("click",l.retryHandler),e.removeEventListener("click",l.validateHandler),e.addEventListener("click",l.validateHandler),e.dataset.submitState="submit")},ac=(e,t="success")=>{switch(e.classList.remove("bg-red-100","bg-white","bg-yellow-100","bg-green-100","bg-blue-100","text-red-700","border-red-400","border-yellow-400","border-green-400","border-l-4"),t){case"success":e.classList.add("border-green-600","bg-green-100");break;case"warning":e.classList.add("border-yellow-600","bg-yellow-100");break;case"error":e.classList.add("border-red-600","bg-red-100");break;default:e.classList.add("border-blue-600","bg-blue-100")}},rc=e=>{let t=document.createElement("button");t.className="absolute -top-2 -right-2 bg-white border-1 border-gray-500 hover:bg-gray-300 rounded-full w-6 h-6 flex items-center justify-center transition-colors shadow-[1px_1px_2px_rgba(0,0,0,0.2)]",t.setAttribute("aria-label",f("close")),t.setAttribute("type","button");let o=document.createElement("i");o.className="fas fa-times text-gray-600 text-xs",t.addEventListener("click",n=>{n.stopPropagation(),e.classList.add("hidden")}),t.appendChild(o),e.appendChild(t)},tr=(e,t="success",o,n,a=!0)=>{e.innerHTML="",e.classList.add("fixed","top-10","left-1/2","transform","-translate-x-1/2"),e.classList.remove("hidden");let r=document.createElement("span");r.className="text-2xl mr-2",r.textContent=o;let i=document.createElement("p");i.className="text-gray-800 font-medium",i.innerHTML=n,ac(e,t),e.appendChild(r),e.appendChild(i),a&&rc(e)};document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("toast");e&&(document.addEventListener("click",t=>{!e.classList.contains("hidden")&&!e.contains(t.target)&&e.classList.add("hidden")}),e.addEventListener("click",t=>{t.stopPropagation()}))})});function or(){let e=navigator.userAgent.indexOf("Win")!==-1,t=window.devicePixelRatio>1.3;return e&&t}function ic(){let e=!!window.chrome,t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return e||t}function se(e){if(document.body.style.zoom=e,it=e,localStorage.setItem("pageZoomLevel",e.toString()),ic()){document.body.style.zoom=e,lc(e);return}sc(e)}function sc(e){let t=document.documentElement,o=document.body,n=document.querySelector(".container.content"),a=document.getElementById("interface-container"),r=document.getElementById("nav-container"),i=document.getElementById("sidebar"),s=1/e;o&&(o.style.transform=`scale(${e})`,o.style.transformOrigin="top center",o.style.width=`${s*100}%`,o.style.minHeight=`${s*100}vh`,o.style.overflow="hidden"),n&&(n.style.transform="none",n.style.minHeight=`calc(${s*100}vh - ${s*100}px)`,n.style.width="100%",n.style.maxWidth="none"),a&&(a.style.position="fixed",a.style.bottom="0",a.style.left="0",a.style.width=`${s*100}%`,a.style.transform=`scale(${e})`,a.style.transformOrigin="bottom left",a.style.zIndex="9999"),r&&(r.style.position="fixed",r.style.transform=`scale(${e})`,r.style.transformOrigin="top left",r.style.zIndex="9999"),i&&i.getAttribute("aria-expanded")==="true"&&(i.style.transform=`scale(${e})`,i.style.transformOrigin="top right",i.style.right="0"),window.dispatchEvent(new CustomEvent("zoomchange",{detail:{zoomLevel:e}}))}function lc(e){let t=document.querySelector(".fixed.bottom-0"),o=document.getElementById("sidebar");t&&(t.style.bottom="0"),o&&o.getAttribute("aria-expanded")==="true"&&(o.style.right="0"),window.dispatchEvent(new CustomEvent("zoomchange",{detail:{zoomLevel:e}}))}function cc(){se(1);let e=document.querySelector(".container.content"),t=document.getElementById("interface-container"),o=document.getElementById("nav-container"),n=document.getElementById("sidebar");document.body.style.transform="",document.body.style.width="",document.body.style.minHeight="",document.body.style.overflow="",e&&(e.style.minHeight="",e.style.width="",e.style.maxWidth=""),t&&(t.style.position="",t.style.transform="",t.style.width=""),o&&(o.style.position="",o.style.transform=""),n&&(n.style.transform="",n.style.right=""),localStorage.removeItem("pageZoomLevel")}function Bo(){return it}function dc(){let e=localStorage.getItem("pageZoomLevel");return e&&!isNaN(parseFloat(e))?(se(parseFloat(e)),!0):!1}function Pt(){let e=dc();return window.addEventListener("resize",()=>{it!==1&&se(it)}),document.addEventListener("keydown",t=>{t.altKey&&t.key==="z"&&se(it===.75?1:.75)}),e}function nr(){let e=document.getElementById("zoom-controls");e&&e.remove();let t=document.createElement("div");t.id="zoom-controls",t.className="fixed bottom-20 left-4 bg-white rounded-lg shadow-lg p-2 z-50 flex items-center space-x-2 border border-gray-200";let o=document.createElement("button");o.className="p-2 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",o.innerHTML='<i class="fas fa-search-minus"></i>',o.setAttribute("aria-label","Zoom out"),o.addEventListener("click",()=>{se(.75)});let n=document.createElement("button");n.className="p-2 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",n.innerHTML='<i class="fas fa-undo"></i>',n.setAttribute("aria-label","Reset zoom"),n.addEventListener("click",cc);let a=document.createElement("button");a.className="p-2 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",a.innerHTML='<i class="fas fa-search-plus"></i>',a.setAttribute("aria-label","Zoom in"),a.addEventListener("click",()=>{se(1.25)});let r=document.createElement("span");return r.id="zoom-level-display",r.className="text-sm font-medium text-gray-700 px-2",r.textContent="100%",window.addEventListener("zoomchange",i=>{let s=i.detail.zoomLevel;r.textContent=`${Math.round(s*100)}%`}),t.appendChild(o),t.appendChild(n),t.appendChild(a),t.appendChild(r),document.body.appendChild(t),t}var it,_o=N(()=>{"use strict";it=1});var ir={};Me(ir,{adjustLayout:()=>Ne,cacheInterfaceElements:()=>ie,checkWindowsScaling:()=>ar,createZoomResetButton:()=>rr,extractPageTerms:()=>Mt,formatNavigationItems:()=>Re,getCachedInterface:()=>$o,getCachedNavigation:()=>Po,highlightGlossaryTerms:()=>X,initializeLanguageDropdown:()=>Fo,initializeNavigation:()=>Oo,initializePlayBar:()=>Jo,initializeSidebar:()=>Mo,initializeSignLanguage:()=>Wo,loadEasyReadMode:()=>Go,loadGlossaryTerms:()=>he,loadSignLanguageMode:()=>Vo,loadStateMode:()=>Qo,removeGlossaryHighlights:()=>ve,restoreInterfaceElements:()=>zo,setNavVisibility:()=>At,setPlayPauseIcon:()=>ut,setSidebarVisibility:()=>Zo,showGlossaryDefinition:()=>ct,showZoomResetButton:()=>vc,switchLanguage:()=>Do,testZoom:()=>hc,toggleEasyReadMode:()=>Ho,toggleGlossaryMode:()=>Uo,togglePlayBarSettings:()=>dt,toggleSidebar:()=>re,toggleSignLanguageMode:()=>je,toggleStateMode:()=>Ko,toggleSyllablesMode:()=>jo,updatePageNumber:()=>Ro,updateToggleVisuals:()=>bc});var lt,ae,st,uc,mc,gc,pc,fc,$o,Po,Mo,Oo,yc,Fo,Ro,re,Ne,ie,zo,Do,Ho,jo,Wo,je,Vo,he,Uo,X,ct,ve,Go,Ko,Qo,Jo,dt,Re,ut,bc,Mt,ar,rr,hc,vc,Zo,At,ue=N(()=>{"use strict";H();de();vt();z();D();j();Y();eo();_o();Ee();Xe();lt={},ae={interface:null,navigation:null,sidebarState:null},st=null,uc=300,mc=uc+50,gc='button:not([disabled]):not([tabindex="-1"]):not([aria-hidden="true"]), a[href]:not([tabindex="-1"]):not([aria-hidden="true"]), input:not([disabled]):not([tabindex="-1"]):not([aria-hidden="true"]), select:not([disabled]):not([tabindex="-1"]):not([aria-hidden="true"]), textarea:not([disabled]):not([tabindex="-1"]):not([aria-hidden="true"]), [tabindex]:not([tabindex="-1"]):not([aria-hidden="true"])',pc=()=>{let e=document.getElementById("sidebar");if(!e)return;let t=e.querySelectorAll(gc),o=Array.from(t).find(n=>{let a=n.closest(".tab-content");return!a||!a.classList.contains("hidden")});o&&o.focus({preventScroll:!0})},fc=()=>{st&&document.contains(st)?st.focus({preventScroll:!0}):document.getElementById("open-sidebar")?.focus({preventScroll:!0}),st=null},$o=()=>ae.interface,Po=()=>ae.navigation,Mo=()=>{let e=document.getElementById("sidebar");if(!e)return;let t=k("sidebarState");k("stateMode")==="true"||Zo(t==="open",{manageFocus:!1}),e.classList.add("fixed","top-2","w-80","bg-white","shadow-lg","z-70","overflow-y-auto"),yc()},Oo=()=>{if(!document.getElementById("navPopup"))return;let t=k("navState"),o=k("stateMode")==="true",n=t==="open";o||n&&Ae(n)},yc=()=>{window.addEventListener("beforeunload",()=>{let e=ae.sidebarState?"open":"closed";I("sidebarState",e,7)})},Fo=async()=>{try{let t=0,o=async()=>{let n=document.getElementById("language-dropdown");if(!n){if(t>=3)throw new Error("Language dropdown not found after maximum retries");return t++,await new Promise(c=>setTimeout(c,200)),o()}n.innerHTML="";let a=document.querySelector('meta[name="available-languages"]'),r=a?a.getAttribute("content")?.split(","):["es","en"],i=l.currentLanguage||k("currentLanguage")||document.documentElement.lang||"es";r.forEach(c=>{let d=document.createElement("option");d.value=c,d.textContent=c.toUpperCase(),c===i&&(d.selected=!0),n.appendChild(d)}),n.value=i,g("currentLanguage",i),n.classList.remove("hidden");let s=n.closest(".flex.items-center");return s&&(s.classList.remove("hidden"),s.style.display="flex",s.classList.add("flex","items-center","space-x-4","ml-auto","mr-4")),n.classList.add("ml-4","p-2","border","border-gray-300","rounded-md","bg-white","text-gray-700"),document.documentElement.lang=i,!0};return await o()}catch(e){return console.error("Error initializing language dropdown:",e),!1}},Ro=()=>{let e=document.getElementById("page-section-id");if(!e)return;let t=document.querySelector('meta[name="page-section-id"]'),o=document.querySelector('meta[name="title-id"]'),n=t?.getAttribute("content")||"0";l.currentPage=n;let a=o?.getAttribute("content"),r=null;if(a){let s=(Rn()?.pages||[]).find(c=>c.section_id===a);s?.page_label&&(r=s.page_label)}e.innerHTML=`<span data-id="page"></span> ${r||n}`},re=()=>{let e=document.getElementById("sidebar");if(!e)return;let t=e.getAttribute("aria-expanded")==="true";Zo(!t),l.sideBarActive=!t,Ne()},Ne=()=>{let e=document.querySelector(".fixed.bottom-0 .container .absolute"),t=document.getElementById("back-forward-buttons"),o=document.querySelector("body > .container"),n=document.getElementById("submit-button"),r=l.signLanguageMode,i=n&&window.getComputedStyle(n).display!=="none";o&&(o.classList.remove("lg:ml-0","lg:w-[calc(100vw-450px)]","mx-auto"),r?o.classList.add("lg:ml-0","lg:w-[calc(100vw-450px)]"):o.classList.add("mx-auto")),e&&(e.classList.remove("lg:right-0","lg:right-[calc(425px-1rem)]"),r?e.classList.add("lg:right-[calc(425px-1rem)]"):e.classList.add("lg:right-0")),t&&(t.classList.remove("left-1/2","lg:left-[calc(50vw-212.5px)]","left-20"),i?t.classList.add("left-20"):r?t.classList.add("lg:left-[calc(50vw-212.5px)]","left-1/2"):t.classList.add("left-1/2"));let s=Bo();s!==1&&setTimeout(()=>{se(s)},10)},ie=()=>{try{let e=document.getElementById("sidebar"),t=document.getElementById("navPopup");e&&(ae.interface=e.outerHTML),t&&(ae.navigation=t.outerHTML)}catch(e){console.error("Error caching interface elements:",e)}},zo=()=>{try{if(ae.interface){let e=document.getElementById("interface-container");e&&(e.innerHTML=ae.interface)}if(ae.navigation){let e=document.getElementById("nav-container");e&&(e.innerHTML=ae.navigation)}return!0}catch(e){return console.error("Error restoring interface elements:",e),!1}},Do=async()=>{try{let e=document.getElementById("language-dropdown");if(!e)return;e.disabled=!0,$(),g("currentLanguage",e.value);let t=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1);I("currentLanguage",l.currentLanguage,7,t),document.documentElement.lang=l.currentLanguage,await Qe(),Ot(),l.glossaryMode&&X(),e.disabled=!1}catch(e){console.error("Error switching language:",e),Ke("Error changing language")}},Ho=async({stopCalls:e=!1}={})=>{g("easyReadMode",!l.easyReadMode),I("easyReadMode",l.easyReadMode,7),F("toggle-easy-read",l.easyReadMode),xe("EasyReadMode",l.easyReadMode),$(),await Qe()},jo=()=>{g("syllablesMode",!l.syllablesMode),I("syllablesMode",l.syllablesMode,7),F("toggle-syllables",l.syllablesMode)},Wo=()=>{let e=document.getElementById("sl-quick-toggle-button");e&&e.classList.contains("hidden")&&e.classList.remove("hidden")},je=({stopCalls:e=!1}={})=>{g("signLanguageMode",!l.signLanguageMode),I("signLanguageMode",l.signLanguageMode?"true":"false",7),F("toggle-sign-language",l.signLanguageMode),Te("sl-quick-toggle-button",l.signLanguageMode),Yt(l.signLanguageMode),xe("SignLanguageMode",l.signLanguageMode),Ne(),l.signLanguageMode?Xt():Zt(),!e&&l.readAloudMode&&mt({stopCalls:!0})},Vo=()=>{let e=k("signLanguageMode")==="true";e!==""&&(g("signLanguageMode",e),F("toggle-sign-language",l.signLanguageMode),Te("sl-quick-toggle-button",l.signLanguageMode),Yt(l.signLanguageMode),Zt(),l.signLanguageMode&&Xt())},he=async()=>{try{let e=l.currentLanguage||"es",o=await(await fetch(`./content/i18n/${e}/glossary.json`)).json();lt=o,l.glossaryTerms=o}catch(e){console.error("Error loading glossary:",e)}},Uo=()=>{g("glossaryMode",!l.glossaryMode),I("glossaryMode",l.glossaryMode,7),F("toggle-glossary",l.glossaryMode),l.glossaryMode?he().then(()=>{X()}):ve()},X=()=>{if(!l.glossaryMode||!lt)return;ve();let e=Mt(),t=d=>d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=[];if(Object.entries(lt||{}).forEach(([d,u])=>{o.push({text:d,pattern:t(d),baseForm:d.toLowerCase().replace(/[es]$|[s]$/,""),definition:u.definition,emoji:u.emoji||""}),u.variations&&u.variations.forEach(m=>{o.push({text:m,pattern:t(m),baseForm:m.toLowerCase().replace(/[es]$|[s]$/,""),definition:u.definition,emoji:u.emoji||""})})}),o.sort((d,u)=>u.text.length-d.text.length),o.length===0)return;let n=new Set,a=document.getElementById("content");if(!a)return;let r=new Set;a.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(d=>{let u=d.textContent.toLowerCase();for(let m of o)new RegExp(`\\b${m.pattern}\\b`,"i").test(u)&&r.add(m.baseForm)});let i=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,{acceptNode(d){return d.parentNode.nodeName.match(/^H[1-6]$/i)||d.parentNode.nodeName==="SCRIPT"||d.parentNode.nodeName==="STYLE"||d.parentNode.classList?.contains("glossary-term")||d.parentNode.closest(".glossary-popup, .glossary-term")||d.parentNode.closest(".activity-text")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),s=[],c;for(;c=i.nextNode();)c.textContent.trim()&&s.push(c);s.forEach(d=>{let u=d.textContent;if(!u.trim())return;let m=[{text:u,highlighted:!1}];for(let y of o)if(!(n.has(y.baseForm)&&!r.has(y.baseForm)))for(let p=0;p<m.length;p++){let h=m[p];if(h.highlighted)continue;let x=new RegExp(`\\b(${y.pattern})([,;:.!?)]|\\s|$)`,"i"),v=h.text.match(x);if(v){let T=h.text.substring(0,v.index),L=v[1],w=v[2],B=h.text.substring(v.index+v[1].length+v[2].length);m.splice(p,1,{text:T,highlighted:!1},{text:L,highlighted:!0,term:y},{text:w,highlighted:!1},{text:B,highlighted:!1}),n.add(y.baseForm),r.delete(y.baseForm);break}}if(m.some(y=>y.highlighted)){let y=m.filter(h=>h.text),p=document.createDocumentFragment();y.forEach(h=>{if(h.highlighted){let x=document.createElement("span");x.className="glossary-term bg-emerald-100 bg-opacity-80 text-emerald-800 rounded cursor-pointer",x.setAttribute("role","button"),x.setAttribute("tabindex","0"),x.textContent=h.text,x.addEventListener("click",ct),x.addEventListener("keydown",v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),ct.call(x,v))}),p.appendChild(x)}else p.appendChild(document.createTextNode(h.text))}),d.parentNode.replaceChild(p,d)}})},ct=async e=>{let t=document.querySelector(".glossary-popup");t&&t.remove();let n=e.target.textContent.toLowerCase().trim().replace(/[.,;:!?()]/g,""),a="",r="",i="";for(let[T,L]of Object.entries(lt))if(T.toLowerCase().trim().replace(/[.,;:!?()]/g,"")===n){a=L.definition,r=L.emoji,i=T;break}else if(L.variations&&L.variations.some(B=>B.toLowerCase().trim().replace(/[.,;:!?()]/g,"")===n)){a=L.definition,r=L.emoji,i=T;break}if(!a)return;let s=document.createElement("div");s.className="glossary-popup text-2xl fixed z-50 bg-white rounded-lg border-[1px] border-gray shadow-xl p-4 max-w-sm text-base",s.setAttribute("role","dialog"),s.setAttribute("aria-label",`Definition for ${i}`);let c=document.createElement("div");c.className="flex items-center gap-4 mb-4";let d=document.createElement("div");d.className="text-4xl flex-shrink-0",d.textContent=r,d.setAttribute("role","img"),d.setAttribute("aria-label",`Symbol for ${i}`);let u=document.createElement("div");u.className="font-bold text-2xl",u.textContent=i,c.appendChild(d),c.appendChild(u);let m=document.createElement("div");m.className="mt-3 text-lg leading-relaxed",m.textContent=a;let y=document.createElement("div");y.className="mt-4 flex justify-end border-t border-gray-200 pt-4 pb-1";let p=document.createElement("button");p.className="px-4 py-2 border border-blue-600 text-blue-600 bg-transparent rounded hover:bg-blue-50 transition-colors flex items-center gap-2 mx-auto",p.innerHTML='<i class="fas fa-book"></i> <span data-id="glossary-view-term">'+f("glossary-view-term")+"</span>",p.addEventListener("click",T=>{T.stopPropagation(),s.remove(),document.removeEventListener("click",x),document.removeEventListener("keydown",v),document.removeEventListener("scroll",h);let L=document.getElementById("sidebar"),w=document.getElementById("glossary-content"),B=document.getElementById("page-tab"),R=document.getElementById("page-content"),Q=document.getElementById("glossary-terms-page");L&&L.getAttribute("aria-expanded")!=="true"?(re(),setTimeout(()=>{C()},50)):C();function C(){w&&w.classList.contains("hidden")&&(document.querySelectorAll("#sidebar > div").forEach(M=>{M!==w&&M.classList.add("hidden")}),w.classList.remove("hidden")),B&&(B.setAttribute("aria-selected","true"),B.classList.add("bg-gray-100"),document.getElementById("book-tab")&&(document.getElementById("book-tab").setAttribute("aria-selected","false"),document.getElementById("book-tab").classList.remove("bg-gray-100"))),R&&R.classList.contains("hidden")&&(R.classList.remove("hidden"),document.getElementById("book-content")&&document.getElementById("book-content").classList.add("hidden")),Q&&setTimeout(()=>{let M=Q.querySelectorAll(".glossary-page-item"),le=null;for(let Vt of M){let E=Vt.querySelector(".glossary-page-term");if(E&&E.textContent.toLowerCase().trim().includes(n.toLowerCase())){le=Vt;break}}le&&(le.scrollIntoView({behavior:"smooth",block:"center"}),le.classList.add("bg-yellow-100","transition-colors","duration-500"),setTimeout(()=>{le.classList.remove("bg-yellow-100","transition-colors","duration-500")},2e3))},300)}}),y.appendChild(p),s.appendChild(c),s.appendChild(m),s.appendChild(y);let h=()=>{if(document.querySelector(".glossary-popup")){let L=e.target.getBoundingClientRect(),w=L.bottom+window.scrollY,B=L.left+window.scrollX;s.style.position="absolute",s.style.top=`${w+10}px`,s.style.left=`${B}px`;let R=s.getBoundingClientRect(),Q=window.innerWidth,C=window.innerHeight;R.right>Q&&(s.style.left=`${window.scrollX+Q-R.width-10}px`),R.bottom>C&&(s.style.top=`${window.scrollY+L.top-R.height-10}px`)}};document.body.appendChild(s),h(),window.addEventListener("scroll",h);function x(T){!s.contains(T.target)&&T.target!==e.target&&(s.remove(),document.removeEventListener("click",x),document.removeEventListener("scroll",h))}function v(T){T.key==="Escape"&&(s.remove(),document.removeEventListener("keydown",v),document.removeEventListener("click",x),document.removeEventListener("scroll",h),e.target.focus())}setTimeout(()=>{document.addEventListener("click",x),document.addEventListener("keydown",v),document.addEventListener("scroll",h)},0)},ve=()=>{document.querySelectorAll(".glossary-popup").forEach(e=>{e.remove()}),document.querySelectorAll(".glossary-term").forEach(e=>{let t=document.createTextNode(e.textContent);e.parentNode.replaceChild(t,e)}),document.querySelectorAll("span:not([class])").forEach(e=>{if(e.attributes.length===0&&e.childNodes.length>0&&Array.from(e.childNodes).every(t=>t.nodeType===3)){let t=document.createTextNode(e.textContent);e.parentNode&&e.parentNode.replaceChild(t,e)}})},Go=async()=>{let e=k("easyReadMode");e!==""&&(g("easyReadMode",e==="true"),F("toggle-easy-read",l.easyReadMode),$(),await Qe())},Ko=()=>{g("stateMode",!l.stateMode),I("stateMode",l.stateMode?"true":"false",7),F("toggle-state",l.stateMode)},Qo=()=>{let e=k("stateMode");if(e!==""&&e!==null){let t=e==="true";g("stateMode",t),I("stateMode",t?"true":"false",7),F("toggle-state",t)}else g("stateMode",!1),I("stateMode","false",7),F("toggle-state",!1)},Jo=()=>{try{let e=k("playBarVisible")==="true",t=k("readAloudMode")==="true";g("readAloudMode",t);let o=document.getElementById("play-bar");if(!o)return;l.readAloudMode?o.classList.remove("hidden"):o.classList.add("hidden")}catch(e){console.error("Error initializing play bar:",e)}},dt=()=>{let e=document.getElementById("read-aloud-settings"),t=document.getElementById("read-aloud-speed");e.classList.contains("opacity-0")?(e.classList.add("opacity-100","pointer-events-auto","h-auto"),e.classList.remove("opacity-0","pointer-events-none","h-0"),e.setAttribute("aria-hidden","false"),e.removeAttribute("inert"),t?.setAttribute("aria-expanded","true"),setTimeout(()=>{e.querySelector('[role="menuitem"]')?.focus()},100)):(e.classList.remove("opacity-100","pointer-events-auto","h-auto"),e.classList.add("h-0","opacity-0","pointer-events-none"),e.setAttribute("aria-hidden","true"),e.setAttribute("inert",""),t?.setAttribute("aria-expanded","false"),t?.focus())},Re=()=>{document.querySelectorAll('.nav__list[data-nav-type="pages"] .nav__list-item').forEach((t,o)=>{let n=t.querySelector(".nav__list-link");if(!n)return;t.classList.add("border-b","border-gray-300","flex","items-center","gap-2"),n.classList.add("flex-grow","flex","items-center","min-w-0","w-full","h-full","p-2","py-3","hover:bg-blue-50","transition","text-gray-500"),o===0&&t.classList.add("border-t");let a=n.getAttribute("href"),r=n.dataset.pageDisplayLabel||n.dataset.pageLabel||n.dataset.pageNumber||n.textContent.trim()||"\u2014",i=n.dataset.pdfPage,s="",c="";if(t.classList.contains("activity")){let p=a.split(".")[0];JSON.parse(localStorage.getItem(`${p}_success`))||!1?(s=`<i class="${p} fas fa-check-square text-green-500 mt-1"></i>`,c="<span class='activity-status' data-id='activity-completed'></span>"):(s=`<i class="${p} fas fa-pen-to-square mt-1 text-blue-700"></i>`,c="<span class='activity-status' data-id='activity-to-do'></span>")}let d=[];c&&d.push(c);let u=d.length?`<div class='text-xs text-gray-500 flex flex-wrap items-center gap-2'>${d.join("<span class='text-gray-300'>\u2022</span>")}</div>`:"",m=i?`<div class='text-xs text-gray-500 whitespace-nowrap ml-4' aria-label='Print page ${i}'>Print Page ${i}</div>`:"",y="<div class='flex items-top space-x-2'>"+s+`<div><div class='text-gray-800 font-medium'>${r}</div>`+u+"</div></div>";n.innerHTML=`<div class='flex items-center justify-between gap-2 w-full'>${y}${m}</div>`,a===window.location.pathname.split("/").pop()&&(t.classList.add("min-h-[3rem]"),n.classList.add("border-l-4","border-blue-500","bg-blue-100","p-2"))})},ut=()=>{let e=document.getElementById("read-aloud-play-icon"),t=document.getElementById("read-aloud-pause-icon");l.isPlaying?(e.style.display="none",e.setAttribute("aria-hidden","true"),t.style.display="",t.setAttribute("aria-hidden","false")):(e.style.display="",e.setAttribute("aria-hidden","false"),t.style.display="none",t.setAttribute("aria-hidden","true"))},bc=e=>{let t=e.closest(".toggle-container");if(t){let o=t.querySelector(".toggle-track"),n=t.querySelector(".toggle-thumb");e.checked?(o?.classList.remove("bg-gray-200"),o?.classList.add("bg-blue-600"),n?.classList.add("translate-x-5")):(o?.classList.add("bg-gray-200"),o?.classList.remove("bg-blue-600"),n?.classList.remove("translate-x-5"))}},Mt=()=>{let e=document.getElementById("content");if(!e)return[];let t=e.textContent,o=new Map,n=r=>r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=[];return Object.entries(lt||{}).forEach(([r,i])=>{a.push(r),i.variations&&Array.isArray(i.variations)&&i.variations.forEach(s=>a.push(s))}),a.forEach(r=>{let i=new RegExp(`(^|[^a-z\xE1\xE9\xED\xF3\xFA\xF1A-Z\xC1\xC9\xCD\xD3\xDA\xD1])${n(r)}($|[^a-z\xE1\xE9\xED\xF3\xFA\xF1A-Z\xC1\xC9\xCD\xD3\xDA\xD1])`,"gi"),s=t.match(i);s&&s.forEach(c=>{let d=c.trim().replace(/^[^a-zA-Z]|[^a-zA-Z]$/g,""),u=d.toLowerCase();o.has(u)||o.set(u,d)})}),Array.from(o.values()).sort((r,i)=>r.localeCompare(i,void 0,{sensitivity:"base"}))},ar=()=>{if(Pt(),or()&&localStorage.getItem("hasSeenScalingNotice")!=="true"){let e=document.createElement("div");e.className="fixed top-4 right-4 bg-white border border-gray-300 rounded-lg shadow-lg p-4 max-w-md z-50 flex flex-col",e.style.maxWidth="350px",e.innerHTML=`
      <div class="flex items-start mb-3">
      <div class="text-amber-500 mr-3 text-xl flex-shrink-0">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div>
        <h3 class="font-semibold text-gray-800 mb-1">Escalado de Pantalla Detectado</h3>
        <p class="text-gray-600 text-sm">
        Se ha detectado un escalado de alta resoluci\xF3n. Esto puede resultar en una experiencia de visualizaci\xF3n menos \xF3ptima. Presiona Ctrl + \u201C-\u201D (menos) para reducir el zoom hasta alcanzar el tama\xF1o de visualizaci\xF3n deseado.
        </p>
      </div>
      </div>
      <div class="flex justify-end space-x-2">
      <button id="dismiss-scaling-notice" class="text-sm px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded transition-colors">
        No mostrar de nuevo
      </button>
      </div>
    `,document.body.appendChild(e),document.getElementById("dismiss-scaling-notice").addEventListener("click",()=>{e.remove(),localStorage.setItem("hasSeenScalingNotice","true")}),setTimeout(()=>{document.body.contains(e)&&e.remove()},15e3)}},rr=()=>nr(),hc=e=>se(e),vc=()=>rr();window.addEventListener("load",()=>{setTimeout(ar,500)});Zo=(e,{manageFocus:t=!0}={})=>{let o=document.getElementById("sidebar");if(!o)return;e?(t&&(st=document.activeElement),o.style.opacity="1",o.style.visibility="visible",o.style.pointerEvents="auto",o.setAttribute("aria-expanded","true"),o.setAttribute("aria-hidden","false"),o.removeAttribute("inert")):(o.style.opacity="0",o.style.visibility="hidden",o.style.pointerEvents="none",o.setAttribute("aria-expanded","false"),o.setAttribute("aria-hidden","true"),o.setAttribute("inert","")),ae.sidebarState=e,I("sidebarState",e?"open":"closed",7),g("sideBarActive",e),Ne();let n=Bo();n!==1&&setTimeout(()=>{se(n)},50),t&&(e?setTimeout(()=>pc(),mc):requestAnimationFrame(()=>fc()))},At=e=>{let t=document.getElementById("navPopup"),o=document.querySelector('.nav__list[data-nav-type="pages"]');if(t){if(t.classList.add("transform","transition-transform","duration-300","ease-in-out"),e){if(t.classList.remove("-translate-x-full"),t.classList.add("left-2"),t.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false"),t.removeAttribute("inert"),o){let n=k("navScrollPosition");n&&(o.scrollTop=parseInt(n))}I("navState","open",7)}else{if(t.classList.add("-translate-x-full"),t.classList.remove("left-2"),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"),t.setAttribute("inert",""),o){let n=o.scrollTop;I("navScrollPosition",n,7)}I("navState","closed",7)}ae.navigation=e}}});var Wn={};Me(Wn,{announceToScreenReader:()=>O,checkIfReferencePage:()=>sr,deactivateAudioElements:()=>rn,displayReturnButton:()=>lr,handleEli5Popup:()=>cn,highlightElement:()=>Se,initializeAudioElements:()=>gt,initializeAutoplay:()=>an,initializeEli5:()=>ln,initializeGlossary:()=>dn,initializeReferencePage:()=>mn,initializeTabs:()=>un,loadAutoplayState:()=>Yo,loadDescribeImagesState:()=>en,loadGlossaryState:()=>tn,loadSyllablesState:()=>xc,loadToggleButtonState:()=>Ft,populateGlossaryTerms:()=>Ot,setAutoplayContainerVisibility:()=>Rt,setDescribeImagesContainerVisibility:()=>gn,setEli5ContainerVisibility:()=>qc,showReadAloudContainers:()=>Ac,toggleAutoplay:()=>on,toggleDescribeImages:()=>nn,toggleEli5Mode:()=>sn,unhighlightAllElements:()=>K,unhighlightElement:()=>fe,updatePlayPauseIcon:()=>oe,updateTtsOptionsContainerVisibility:()=>pt});var Yo,en,xc,tn,on,nn,an,Ft,gt,rn,Ec,Ac,oe,Lc,Sc,sn,ln,cn,wc,Ic,Cc,kc,Xo,Tc,O,Ot,Nc,dn,un,sr,mn,lr,Rt,gn,pt,qc,Se,fe,K,Y=N(()=>{"use strict";z();de();H();ue();j();ue();D();Ee();fn();document.addEventListener("click",e=>{if(e.target.closest('.glossary-term, [data-glossary-term="true"]'))return Promise.resolve().then(()=>(ue(),ir)).then(o=>{o.showGlossaryDefinition(e)}),window._isGlossaryTermClick=!0,(l.isPlaying||l.currentAudio)&&($(),K()),setTimeout(()=>{window._isGlossaryTermClick=!1},100),!1},{capture:!0});Yo=()=>{let e=k("autoplayMode");e!==null&&(g("autoplayMode",e==="true"),F("toggle-autoplay",l.autoplayMode))},en=()=>{let e=k("describeImagesMode");e!==null?g("describeImagesMode",e==="true"):(g("describeImagesMode",!1),I("describeImagesMode","false",7)),F("toggle-describe-images",l.describeImagesMode),l.describeImagesMode&&me()},xc=()=>{let e=k("syllablesMode");e!==null&&(g("syllablesMode",e==="true"),F("toggle-syllables",l.syllablesMode))},tn=async()=>{let e=k("glossaryMode");e!==null&&(g("glossaryMode",e==="true"),F("toggle-glossary",l.glossaryMode),l.glossaryMode&&(await he(),X()))},on=()=>{$(),K(),g("autoplayMode",!l.autoplayMode),F("toggle-autoplay",l.autoplayMode),I("autoplayMode",l.autoplayMode,7),l.readAloudMode&&l.autoplayMode&&(g("currentIndex",0),g("isPlaying",!0),ut(),qe())},nn=()=>{$(),K(),g("describeImagesMode",!l.describeImagesMode),F("toggle-describe-images",l.describeImagesMode),I("describeImagesMode",l.describeImagesMode,7),l.readAloudMode&&l.autoplayMode&&(g("currentIndex",0),g("isPlaying",!0),ut(),qe())},an=()=>{l.readAloudMode&&l.autoplayMode&&(g("isPlaying",!0),ut(),me(),g("currentIndex",0),qe())},Ft=()=>{let e=document.getElementById("toggle-easy-read"),t=document.getElementById("toggle-read-aloud"),o=document.getElementById("toggle-eli5"),n=document.getElementById("tts-options-container");if(!t||!o||!n||!e){setTimeout(Ft,100);return}pt(l.readAloudMode),F("toggle-read-aloud",l.readAloudMode),Te("tts-quick-toggle-button",l.readAloudMode),F("toggle-eli5",l.eli5Mode),F("toggle-easy-read",l.easyReadMode),Lc()},gt=()=>{l.audioElements.forEach(({element:e})=>{e._audioHandler&&e.removeEventListener("click",e._audioHandler),e._audioHandler=()=>Ec(e,l.audioElements),e.addEventListener("click",e._audioHandler)})},rn=()=>{!l.audioElements||l.audioElements.length===0||l.audioElements.forEach(({element:e})=>{e&&e._audioHandler&&(e.removeEventListener("click",e._audioHandler),e._audioHandler=null,e.classList.remove("audio-clickable"))})},Ec=(e,t)=>{if(!(window._isGlossaryTermClick===!0||e.classList.contains("glossary-highlighted")||e.classList.contains("glossary-term")||e.hasAttribute("data-glossary-term")||e.closest(".glossary-term-highlight")||e.closest(".glossary-term")||e.closest("[data-glossary-term]"))&&l.readAloudMode){let n=e.tagName.toLowerCase()==="img",a=t.findIndex(r=>r.element===e);if(a!==-1)g("currentIndex",a),$(),g("isPlaying",!0),pn();else if(n){let r=e.getAttribute("data-id"),i=l.audioFiles[r],s=e.getAttribute("data-aria-id");if(s&&l.audioFiles[s]&&(i=l.audioFiles[s]),i){$(),K();let c=new Audio(i);g("currentAudio",c),c.playbackRate=parseFloat(l.audioSpeed),Se(e),g("isPlaying",!0),oe(!0),c.play().catch(d=>{console.error("Error playing audio:",d),fe(e),g("isPlaying",!1),oe(!1)}),c.onended=()=>{fe(e),g("currentAudio",null),g("isPlaying",!1),oe(!1)}}}}},Ac=()=>{let e=document.getElementById("tts-options-container"),t=document.getElementById("describe-images-container"),o=document.querySelector("#eli5-label")?.closest(".flex");e?.classList.remove("hidden"),t?.classList.remove("hidden"),e?.classList.add("mt-4","mb-2","px-4"),o?.classList.add("mt-4")},oe=e=>{let t=document.getElementById("read-aloud-play-icon"),o=document.getElementById("read-aloud-pause-icon");e?(t.style.display="none",t.setAttribute("aria-hidden","true"),o.style.display="",o.setAttribute("aria-hidden","false")):(t.style.display="",t.setAttribute("aria-hidden","false"),o.style.display="none",o.setAttribute("aria-hidden","true"))},Lc=()=>{let e=document.getElementById("explain-me-button"),t=k("eli5Mode");S("eli5")&&t?(g("eli5Mode",t==="true"),F("toggle-eli5",l.eli5Mode),l.eli5Mode&&l.translations?(Sc(),e?.classList.remove("hidden")):e?.classList.add("hidden")):e?.classList.add("hidden")},Sc=()=>{let e=document.querySelector("section[data-eli5-id]")?.getAttribute("data-eli5-id");if(!e)return;let t=l.translations[e];if(t){let o=document.getElementById("eli5-content-text");if(o){if(o.innerHTML=t,o.classList.remove("hidden"),!document.getElementById("eli5-list-style")){let n=document.createElement("style");n.id="eli5-list-style",n.textContent=`
                    #eli5-content-text ul {
                        list-style-type: none;
                        padding-left: 2.5em;
                        margin-top:0.8em;
                    }
                    #eli5-content-text ul li {
                        position: relative;
                        margin-bottom: 0.5em;
                    }
                    #eli5-content-text ul li::before {
                        content: "\u2014";
                        position: absolute;
                        left: -1.5em;
                        color: #666;
                    }
                `,document.head.appendChild(n)}o.classList.remove("hidden")}}},sn=()=>{g("eli5Mode",!l.eli5Mode),I("eli5Mode",l.eli5Mode,7),F("toggle-eli5",l.eli5Mode),xe("Eli5Mode",l.eli5Mode),l.isPlaying&&$(),K(),wc()},ln=()=>{let e=document.getElementById("explain-me-button");e&&e.classList.contains("hidden")&&(e.classList.remove("hidden"),e.setAttribute("aria-hidden","false"),e.setAttribute("tabindex","0"));let t=document.getElementById("toggle-eli5");t&&t.classList.contains("hidden")&&(t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),t.setAttribute("tabindex","0"));let o=document.getElementById("eli5-container");o&&o.classList.contains("hidden")&&(o.classList.remove("hidden"),o.setAttribute("aria-hidden","false"))},cn=()=>{let e=document.getElementById("explain-me-button"),t=document.getElementById("eli5-content"),o=document.getElementById("close-eli5-content"),n=document.querySelector("section[data-eli5-id]");if(!e||!t||!o||!n)return;let a=n.getAttribute("data-eli5-id");e.addEventListener("click",function(){!t.classList.contains("hidden")?(t.classList.add("hidden"),e.setAttribute("aria-expanded","false"),Xo()):(t.classList.remove("hidden"),e.setAttribute("aria-expanded","true"),Cc(a))}),o.addEventListener("click",function(){t.classList.add("hidden"),e.setAttribute("aria-expanded","false"),Xo()}),document.addEventListener("click",function(r){!t.contains(r.target)&&!e.contains(r.target)&&!t.classList.contains("hidden")&&(t.classList.add("hidden"),e.setAttribute("aria-expanded","false"),Xo())})},wc=()=>{let e=document.getElementById("explain-me-button");if(l.eli5Mode){let t=document.querySelector("section[data-eli5-id]");if(!t){e&&e.classList.add("hidden");return}let o=t.getAttribute("data-eli5-id"),n=l.translations[o];n&&Ic(o,n),e&&e.classList.remove("hidden")}else Tc(),e&&e.classList.add("hidden")},Ic=(e,t)=>{let o=document.getElementById("eli5-content-text");o.innerHTML=`<span data-id="${e}">${t}</span>`,o.classList.remove("hidden")},Cc=e=>{if(l.readAloudMode){$();let t=document.getElementById("eli5-content-text");Se(t);let a=`content/i18n/${l.currentLanguage||window.appConfig&&window.appConfig.languages&&window.appConfig.languages.default||"es"}/audio/`+l.audioFiles[e];a&&kc(a,t)}},kc=(e,t)=>{let o=l.audioElements.findIndex(n=>n.element===t&&n.audioSrc===e);o!==-1?g("currentIndex",o):(l.audioElements.push({element:t,id:"eli5-audio",audioSrc:e}),g("currentIndex",l.audioElements.length-1)),g("isPlaying",!0),pn()},Xo=()=>{$(),K();let e=l.audioElements.findIndex(t=>t.id==="eli5-audio");e!==-1&&(l.audioElements.splice(e,1),l.currentIndex>=e&&g("currentIndex",Math.max(0,l.currentIndex-1)))},Tc=()=>{let e=document.getElementById("eli5-content-text");e.textContent="",e.classList.add("hidden")},O=(e,t=!1)=>{let o=document.getElementById("sr-announcement");if(!o){let n=document.createElement("div");n.id="sr-announcement",n.setAttribute("role","status"),n.setAttribute("aria-live","polite"),n.classList.add("sr-only"),document.body.appendChild(n),o=n}o.textContent="",o.setAttribute("aria-live",t?"assertive":"polite"),o.setAttribute("lang","es"),setTimeout(()=>{o.textContent=e},50)},Ot=()=>{he().then(()=>{let e=document.getElementById("glossary-terms-book"),t=document.getElementById("glossary-terms-page"),o=l.glossaryTerms;l.pageTerms=Mt();let n=l.pageTerms;e&&(e.innerHTML=""),t&&(t.innerHTML="");let a=new Set;if(e&&o){let r={};Object.entries(o).forEach(([s,c])=>{if(!a.has(s.toLowerCase())){let d=s.charAt(0).toUpperCase(),u=d.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();r[u]||(r[u]=[]),r[u].push({term:s,displayTerm:s.charAt(0).toUpperCase()+s.slice(1),emoji:c.emoji,definition:c.definition,originalFirstLetter:d}),a.add(s.toLowerCase())}}),Object.keys(r).sort().forEach(s=>{let c=r[s],d=s,u=document.createElement("div");u.classList.add("glossary-letter-grouping","text-2xl","font-bold","mt-6","mb-3","text-blue-700","pb-4"),u.textContent=d,e.appendChild(u),c.sort((m,y)=>m.term.localeCompare(y.term,void 0,{sensitivity:"base"})),c.forEach(m=>{Nc(e,m.displayTerm,m.emoji,m.definition,m.term)})})}t&&n&&n.length>0?n.forEach(r=>{let i=null,s=null;if(Object.entries(o).forEach(([c,d])=>{let{variations:u}=d;(u.find(y=>y.toLowerCase()===r.toLowerCase())||c.toLowerCase()===r.toLowerCase())&&(i=d,s=c)}),i&&s){let{emoji:c,definition:d}=i,u=document.createElement("div");u.classList.add("mb-4","border-b","border-gray-300","pb-4","glossary-page-item","cursor-pointer","focus:outline-none","focus:ring-2","focus:ring-blue-700","focus:ring-opacity-50"),u.setAttribute("tabindex","0"),u.setAttribute("role","button"),u.setAttribute("aria-label",`${r}${c?" "+c:""}`);let m=r.charAt(0).toUpperCase()+r.slice(1),y=document.createElement("div");y.classList.add("font-bold","text-lg","glossary-page-term"),y.textContent=c?m+" "+c:m,u.appendChild(y);let p=document.createElement("div");p.classList.add("mt-2","text-gray-700","mb-2"),p.textContent=d,u.appendChild(p),u.addEventListener("keydown",h=>{(h.key==="Enter"||h.key===" ")&&h.preventDefault()}),u.addEventListener("focus",()=>{u.classList.add("bg-gray-100")}),u.addEventListener("blur",()=>{u.classList.remove("bg-gray-100")}),t.appendChild(u)}}):t&&(t.innerHTML='<span data-id="glossary-no-terms">'+f("glossary-no-terms")+"</span>"),l.glossaryMode?X():ve()})},Nc=(e,t,o,n,a)=>{let r=document.createElement("div");r.classList.add("mb-4","border-b","border-gray-300","pb-4","glossary-item","cursor-pointer","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-opacity-50"),r.setAttribute("tabindex","0"),r.setAttribute("role","button"),r.setAttribute("aria-label",`${t}${o?" "+o:""}`);let i=document.createElement("div");if(i.classList.add("font-bold","text-lg","glossary-term"),i.textContent=t,o){let d=document.createElement("span");d.classList.add("ml-1"),d.textContent=o,i.appendChild(d)}let s=l.glossaryTerms[a];if(s&&s.variations&&Array.isArray(s.variations)){let d=[a.toLowerCase(),...s.variations.map(u=>u.toLowerCase())];r.dataset.searchTerms=d.join("|")}else r.dataset.searchTerms=a.toLowerCase();r.appendChild(i),e.appendChild(r);let c=d=>{if(d.type==="keydown"&&d.key!=="Enter"&&d.key!==" ")return;d.type==="keydown"&&d.key===" "&&d.preventDefault();let u=document.getElementById("glossary-content"),m=document.getElementById("glossary-term-details"),y=document.getElementById("glossary-term-content");m.dataset.sourceItemId=r.id,r.id||(r.id=`glossary-item-${a.replace(/\s+/g,"-").toLowerCase()}`);let p=a,h=l.glossaryTerms[p],x="";if(h&&h.variations&&h.variations.length>0){let T=h.variations.join(", ");x=`
                <div class="text-sm text-gray-500 mt-1 mb-3">
                    ${T.charAt(0).toUpperCase()+T.slice(1)}
                </div>
            `}y.innerHTML=`
            <div class="flex justify-center items-center mt-8 mb-2 border-b border-gray-300 pb-8">
                <h3 class="text-2xl font-bold">
                    ${t} ${o||""}
                </h3>
            </div>
            ${x}
            <div class="mt-4 text-lg">
                ${n}
            </div>
        `,u.classList.add("hidden"),m.classList.remove("hidden");let v=document.getElementById("close-glossary-term-details");v&&setTimeout(()=>v.focus(),10),O(`Showing details for ${t}`)};r.addEventListener("click",c),r.addEventListener("keydown",c),r.addEventListener("focus",()=>{r.classList.add("bg-gray-100")}),r.addEventListener("blur",()=>{r.classList.remove("bg-gray-100")})},dn=()=>{let e=document.getElementById("glossary-button"),t=e?.closest(".flex.justify-between.items-left.border-t.border-gray-300"),o=document.getElementById("glossary-content"),n=document.getElementById("back-to-sidebar"),a=document.getElementById("sidebar-content"),r=document.getElementById("page-tab"),i=document.getElementById("book-tab"),s=document.getElementById("page-content"),c=document.getElementById("book-content"),d=document.getElementById("filter-input"),u=document.getElementById("glossary-terms-book"),m=document.getElementById("glossary-term-details"),y=document.getElementById("close-glossary-term-details");if(e&&t&&t.classList.remove("hidden"),Ot(),e&&o&&n&&a&&(k("glossaryListOpen")==="true"&&(a.classList.add("hidden"),o.classList.remove("hidden")),e.addEventListener("click",()=>{a.classList.add("hidden"),o.classList.remove("hidden"),m.classList.add("hidden"),I("glossaryListOpen","true",7),ge("Glossary","Open","Glossary button clicked")}),n.addEventListener("click",()=>{o.classList.add("hidden"),a.classList.remove("hidden"),m.classList.add("hidden"),I("glossaryListOpen","false",7),ge("Glossary","Close","Glossary back button clicked")}),y&&y.addEventListener("click",()=>{m.classList.add("hidden"),o.classList.remove("hidden")})),r&&i&&s&&c){let p=x=>{x===0?(r.setAttribute("aria-selected","true"),i.setAttribute("aria-selected","false"),s.classList.remove("hidden"),c.classList.add("hidden"),r.classList.add("text-blue-700","border-b-4","border-blue-700","-mb-1"),i.classList.remove("border-b-4","border-blue-700","text-blue-700","-mb-1")):(r.setAttribute("aria-selected","false"),i.setAttribute("aria-selected","true"),s.classList.add("hidden"),c.classList.remove("hidden"),r.classList.remove("text-blue-700"),i.classList.add("text-blue-700","border-b-4","-mb-1","border-blue-700"),r.classList.remove("border-b-4","border-blue-700","text-blue-700","-mb-1")),I("activeGlossaryTabIndex",x,7)},h=k("activeGlossaryTabIndex");h!=null&&h!==""?p(parseInt(h)):p(0),r.addEventListener("click",()=>{p(0)}),i.addEventListener("click",()=>{p(1)})}d&&u&&d.addEventListener("input",()=>{let p=d.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),h=u.querySelectorAll(".glossary-item"),x=u.querySelectorAll(".glossary-letter-grouping"),v=!1,T=new Map;x.forEach(w=>{T.set(w,!1)}),h.forEach(w=>{let B=w.textContent.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),R=(w.dataset.searchTerms||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(B.includes(p)||R.includes(p)){w.classList.remove("hidden"),v=!0;let C=w;for(;C.previousElementSibling;)if(C=C.previousElementSibling,C.classList.contains("glossary-letter-grouping")){T.set(C,!0);break}}else w.classList.add("hidden")}),x.forEach(w=>{T.get(w)?w.classList.remove("hidden"):w.classList.add("hidden")});let L=document.getElementById("no-results-message");L||(L=document.createElement("span"),L.id="no-results-message",L.dataset.id="glossary-no-terms-filter",L.classList.add("text-gray-700","mt-4"),L.textContent=f("glossary-no-terms-filter"),u.appendChild(L)),v?L.classList.add("hidden"):L.classList.remove("hidden")})},un=()=>{let e=document.getElementById("assistant-tab"),t=document.getElementById("settings-tab"),o=document.getElementById("assistant-content"),n=document.getElementById("settings-content");if(e&&t&&o&&n){let a=i=>{i===0?(e.setAttribute("aria-selected","true"),t.setAttribute("aria-selected","false"),o.classList.remove("hidden"),n.classList.add("hidden"),e.classList.add("text-blue-700","border-b-4","-mb-1","border-blue-700"),t.classList.remove("border-b-4","-mb-1","border-blue-700","text-blue-700")):(e.setAttribute("aria-selected","false"),t.setAttribute("aria-selected","true"),o.classList.add("hidden"),n.classList.remove("hidden"),e.classList.remove("text-blue-700"),t.classList.add("text-blue-700","border-b-4","-mb-1","border-blue-700"),e.classList.remove("border-b-4","-mb-1","border-blue-700","text-blue-700")),I("activeTabIndex",i,7)},r=k("activeTabIndex");r!=null&&r!==""?a(parseInt(r)):a(0),e.addEventListener("click",()=>{a(0)}),t.addEventListener("click",()=>{a(1)})}},sr=()=>{let e=localStorage.getItem("originatingPage");if(!e)return!1;let t=window.location.href;return e===t?(localStorage.removeItem("originatingPage"),g("originatingPage",null),g("isReferencePage",!1),!1):(g("isReferencePage",!0),g("originatingPage",e),!0)},mn=()=>{sr()&&lr()},lr=()=>{let e=Kt("originatingPage");if(!e||document.querySelector(".return-button"))return;let t=document.createElement("button"),n=(Kt("translations")||{})["return-button"]||"Regresar";t.innerHTML=`<i class="fas fa-arrow-left mr-1"></i> ${n}`,t.classList.add("return-button","fixed","top-4","right-20","z-50","inline-flex","items-center","px-3","py-1.5","bg-purple-600","text-white","text-sm","rounded-lg","shadow-md","hover:bg-purple-700","focus:outline-none","focus:ring-2","focus:ring-purple-500","focus:ring-opacity-50"),t.setAttribute("aria-label",n),t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-pressed","false"),t.addEventListener("click",()=>{localStorage.removeItem("originatingPage"),g("originatingPage",null),g("isReferencePage",!1),ie();let a=document.querySelector("body > .container");a&&a.classList.add("opacity-0"),setTimeout(()=>{window.location.href=e},150)}),document.body.appendChild(t)},Rt=e=>{let t=document.getElementById("autoplay-container");t&&t.classList.toggle("hidden",!e)},gn=e=>{let t=document.getElementById("describe-images-container");t&&t.classList.toggle("hidden",!e)},pt=e=>{let t=document.getElementById("tts-options-container");t&&(e&&(S("autoplay")||S("describeImages"))?t.classList.remove("hidden"):t.classList.add("hidden"))},qc=e=>{let t=document.getElementById("eli5-container");t&&t.classList.toggle("hidden",!e)},Se=e=>{e?.classList.add("outline","outline-blue-300","outline-2","bg-blue-100","bg-opacity-30","text-black","rounded-lg")},fe=e=>{e?.classList.remove("outline","outline-blue-300","bg-opacity-30","outline-2","bg-blue-100","text-black")},K=()=>{document.querySelectorAll(".bg-blue-100").forEach(fe)}});var cr,Bc,Be,zt,qo,A,me,$,dr,qe,pn,yn,ur,mr,gr,pr,fr,_c,yr,br,mt,hr,H=N(()=>{"use strict";z();de();Y();j();ue();Ee();fn();cr={"speed-0-5":"0.5","speed-1":"1","speed-1-5":"1.5","speed-2":"2"},Bc=!0,Be=null,zt=!1,qo=()=>(Be||(Be={drop:new Audio("./assets/sounds/drop.mp3"),success:new Audio("./assets/sounds/success.mp3"),error:new Audio("./assets/sounds/error.mp3"),reset:new Audio("./assets/sounds/reset.mp3"),validate_success:new Audio("./assets/sounds/validate_success.mp3"),validate_error:new Audio("./assets/sounds/drop.mp3")},Object.values(Be).forEach(e=>{e.volume=.5})),Be),A=e=>{(!Be||!Be[e])&&qo();let t=Be?.[e];if(!t)return console.log(`Sound ${e} not available`),null;try{t.pause(),t.currentTime=0,t.play().catch(o=>{console.log(`Error playing ${e} sound:`,o)})}catch(o){return console.warn(`Error playing ${e} sound:`,o),null}return t},me=()=>{let t=`content/i18n/${l.currentLanguage||window.appConfig&&window.appConfig.languages&&window.appConfig.languages.default||"es"}/audio/`,o=Array.from(document.querySelectorAll(".container [data-id], .container textarea[data-placeholder-id], .container input[data-placeholder-id]")).filter(n=>{let a=n.closest(".nav__list")!==null,r=n.tagName.toLowerCase()==="img";return!a&&!n.getAttribute("data-id")?.startsWith?.("sectioneli5")}).map(n=>{let a=n.tagName.toLowerCase();if((a==="textarea"||a==="input")&&n.hasAttribute("data-placeholder-id")){let s=n.getAttribute("data-placeholder-id");return s&&l.audioFiles[s]?{element:n,id:s,audioSrc:t+l.audioFiles[s]}:null}let r=n.getAttribute("data-id"),i=l.audioFiles[r]?t+l.audioFiles[r]:void 0;if(a==="img"){let s=n.getAttribute("data-aria-id");s&&l.audioFiles[s]&&(i=t+l.audioFiles[s])}if(l.easyReadMode){let s=n.tagName.toLowerCase().match(/^h[1-6]$/),c=n.closest(".word-card"),d=n.closest("[data-activity-item]"),u=n.closest(".nav__list"),m=n.closest(".activity-text");if(!s&&!(c!==null||d!==null||u!==null||m!==null)){let p=`${r}_easy_read`;l.audioFiles.hasOwnProperty(p)&&(i=t+l.audioFiles[p])}}return{element:n,id:r,audioSrc:i}}).filter(n=>n&&n.audioSrc);return g("audioElements",o),o},$=()=>{try{K(),l.currentAudio&&(l.currentAudio.pause(),l.currentAudio.currentTime=0,g("currentAudio",null)),g("isPlaying",!1),oe(!1),zt=!1}catch(e){console.error("Error stopping audio:",e)}},dr=()=>{l.isPlaying?$():(g("isPlaying",!0),oe(!0),qe())},qe=async()=>{if(!(zt||!Bc)){zt=!0;try{await yn()}finally{zt=!1}g("navigationDirection","forward")}},pn=async()=>{let{currentIndex:e,audioElements:t,audioSpeed:o}=l;if(e<0||e>=t.length){$();return}let{element:n,audioSrc:a}=t[e];try{Se(n),await ur(a,o),fe(n),$()}catch(r){console.error("Error playing audio:",r),$()}},yn=async()=>{let{currentIndex:e,audioElements:t,audioSpeed:o,describeImagesMode:n,navigationDirection:a}=l;if(e<0||e>=t.length){$(),l.currentIndex=0,l.navigationDirection="forward";return}K();let{element:r,audioSrc:i}=t[e];if(r.tagName.toLowerCase()==="img"&&!n)if(l.isPlaying){g("currentIndex",e+(a==="backward"?-1:1)),await yn();return}else{$();return}try{Se(r),await ur(i,o),fe(r),l.isPlaying?(a==="backward"?(g("navigationDirection","forward"),g("currentIndex",e+1)):g("currentIndex",e+1),await yn()):$()}catch(c){console.error("Error playing audio:",c),$()}},ur=(e,t)=>new Promise((o,n)=>{if(!l.isPlaying){o();return}let a=new Audio(e);g("currentAudio",a),a.playbackRate=parseFloat(t),a.onended=o,a.onerror=n,oe(!0),a.play().catch(r=>{console.warn("Audio playback failed:",r),o()})}),mr=()=>{g("navigationDirection","backward"),g("currentIndex",Math.max(0,l.currentIndex-1)),$(),g("isPlaying",!0),qe()},gr=()=>{g("navigationDirection","forward"),g("currentIndex",l.currentIndex+1),$(),g("isPlaying",!0),qe()},pr=()=>{let e=k("audioSpeed");e&&(g("audioSpeed",e),yr(e),br(e))},fr=e=>{let t=e.target.closest(".read-aloud-change-speed"),o=Array.from(t.classList).find(a=>a.startsWith("speed-")),n=cr[o];g("audioSpeed",n),I("audioSpeed",n,7),_c(n),yr(n),br(t),dt()},_c=e=>{l.currentAudio&&(l.currentAudio.playbackRate=parseFloat(e)),l.eli5Audio&&(l.eli5Audio.playbackRate=parseFloat(e))},yr=e=>{let t=Object.entries(cr).find(([a,r])=>r===e)?.[0]||"speed-1",o=document.querySelector(`[class*="${t}"]`),n=o?.innerHTML;if(n){let a=document.getElementById("read-aloud-speed");a.innerHTML=n;let r=o.textContent.trim();a.setAttribute("aria-label",`Playback speed: ${r}`)}},br=e=>{document.querySelectorAll(".read-aloud-change-speed").forEach(t=>{t===e?(t.classList.add("bg-white","text-black"),t.classList.remove("bg-black","text-white")):(t.classList.remove("bg-white","text-black"),t.classList.add("bg-black","text-white"))})},mt=({stopCalls:e=!1}={})=>{$(),K(),l.readAloudMode?rn():gt();let t=!l.readAloudMode;g("readAloudMode",t),I("readAloudMode",t.toString(),7),Te("tts-quick-toggle-button",t),xe("ReadAloud",t);let o=document.getElementById("play-bar"),n=document.getElementById("tts-options-container"),a=document.getElementById("autoplay-container"),r=document.getElementById("describe-images-container"),i=document.getElementById("tts-quick-toggle-button");t?(o&&o.classList.remove("hidden"),i&&i.classList.remove("hidden"),(S("autoplay")||S("describeImages"))&&n&&(n.classList.remove("hidden"),S("autoplay")&&a?.classList.remove("hidden"),S("describeImages")&&r?.classList.remove("hidden"))):(o&&o.classList.add("hidden"),n&&(n.classList.add("hidden"),S("autoplay")&&a?.classList.add("hidden"),S("describeImages")&&r?.classList.add("hidden"))),F("toggle-read-aloud",t),!e&&l.signLanguageMode&&je({stopCalls:!0})},hr=()=>{let e=document.getElementById("tts-quick-toggle-button");e&&(e.classList.remove("hidden"),e.addEventListener("click",t=>{t.preventDefault(),mt()}))}});async function Er(){let e=`./content/i18n/${l.currentLanguage}/timecode/timecode_output.json`;try{let t=await fetch(e);if(!t.ok)throw new Error(`Failed to load timecode JSON: ${t.statusText}`);We=await t.json(),$c()}catch(t){console.error("Error initializing word-by-word highlighter:",t)}}function $c(){vr||(vr=setInterval(Pc,50))}function Pc(){let e=l.currentAudio;e&&!e._wordHighlighterAttached?Mc(e):!e&&Ve&&(Ar(),Ge())}function Mc(e){let t=l.audioElements;if(!t||t.length===0)return;let o=l.currentIndex;if(o<0||o>=t.length)return;let{element:n,id:a}=t[o],r=a,i=a;if(l.easyReadMode){let p=n.tagName.toLowerCase().match(/^h[1-6]$/),h=n.closest(".word-card"),x=n.closest("[data-activity-item]"),v=n.closest(".nav__list"),T=n.closest(".activity-text");if(!p&&!(h!==null||x!==null||v!==null||T!==null)){let w=`easyread-${a}`;l.translations&&l.translations.hasOwnProperty(w)&&(r=w,i=We&&We[w]?w:a)}}if(!We||!We[i])return;let s=We[i],c=s.timecodes&&s.timecodes[1]&&s.timecodes[1].word_timestamps||[];if(c.length===0)return;let d=l.translations&&l.translations[r]?l.translations[r]:n.textContent,u=n.tagName.toLowerCase()==="img";u?(Oc(n,d),Ue=n):q&&hn();let m=u?q.querySelector(".subtitle-content"):n;m.dataset.wordsWrapped||(Fc(m,c,d),m.dataset.wordsWrapped="true"),document.querySelectorAll('[data-words-wrapped="true"]').forEach(p=>{p!==n&&p.querySelectorAll("span[data-word-index]").forEach(h=>{h.classList.remove("bg-yellow-300"),h.classList.remove("rounded-lg"),h.classList.remove("text-black")})});let y=n.querySelector('span[data-word-index="0"]');y&&(n.querySelectorAll("span[data-word-index]").forEach(p=>{p.classList.remove("bg-yellow-300"),p.classList.remove("rounded-lg"),p.classList.remove("text-black")}),y.classList.add("bg-yellow-300"),y.classList.add("rounded-lg"),y.classList.add("text-black")),Ar(),Ve=()=>Rc(e,m,c),e.addEventListener("timeupdate",Ve),yt=()=>{Ge(),u&&q&&hn()},e.addEventListener("ended",yt),e.addEventListener("play",()=>{let p=n.querySelector('span[data-word-index="0"]');p&&e.currentTime<c[0].end+ft&&(n.querySelectorAll("span[data-word-index]").forEach(h=>{h.classList.remove("bg-yellow-300"),h.classList.remove("rounded-lg"),h.classList.remove("text-black")}),p.classList.add("bg-yellow-300"),p.classList.add("rounded-lg"),p.classList.add("text-black"))}),document.addEventListener("audioIndexChanged",Ge),e._wordHighlighterAttached=!0}function Oc(e,t){document.removeEventListener("click",bn),q&&q.parentNode&&(q.parentNode.removeChild(q),q=null),q=document.createElement("div"),q.className="fixed z-50 bg-white/90 backdrop-blur-sm rounded-lg border border-gray-300 shadow-lg p-3 max-w-md min-w-[280px] opacity-0 transition-opacity duration-300 ease-in-out",q.style.width=Math.min(Math.max(e.offsetWidth*1.2,280),500)+"px";let o=document.createElement("div");return o.className="subtitle-content text-lg leading-relaxed",o.textContent=t,q.appendChild(o),document.body.appendChild(q),xr(e),setTimeout(()=>{q.classList.add("opacity-100")},10),window.addEventListener("resize",()=>{q&&Ue&&xr(Ue)}),setTimeout(()=>{document.addEventListener("click",bn)},50),q}function bn(e){if(q&&!q.contains(e.target)&&(!Ue||!Ue.contains(e.target))){if(e.target.tagName.toLowerCase()==="img"&&e.target.getAttribute("data-id"))return;hn()}}function xr(e){if(!q)return;let t=e.getBoundingClientRect();q.style.top=t.bottom+window.scrollY+8+"px",q.style.left=t.left+window.scrollX+(t.width-q.offsetWidth)/2+"px";let o=window.innerWidth,n=q.getBoundingClientRect();n.right>o&&(q.style.left=o-n.width-8+"px"),parseFloat(q.style.left)<8&&(q.style.left="8px")}function hn(){q&&(document.removeEventListener("click",bn),q.classList.add("opacity-0"),setTimeout(()=>{q&&q.parentNode&&(q.parentNode.removeChild(q),q=null)},300)),Ue=null}function Ge(){document.querySelectorAll('[data-words-wrapped="true"]').forEach(t=>{t.querySelectorAll("span[data-word-index]").forEach(o=>{o.classList.remove("bg-yellow-300"),o.classList.remove("rounded-lg"),o.classList.remove("text-black")})})}function Ar(){let e=l.currentAudio;e&&(Ve&&(e.removeEventListener("timeupdate",Ve),Ve=null),yt&&(e.removeEventListener("ended",yt),yt=null),e._wordHighlighterAttached=!1),document.removeEventListener("audioIndexChanged",Ge)}function Fc(e,t,o){let n={},a=e.querySelectorAll(".glossary-term"),r=o||e.textContent,i=m=>m.toLowerCase().trim().replace(/[.,;:!?()]/g,"");a.forEach(m=>{let y=m.textContent.trim(),p=i(y);n[p]={classes:Array.from(m.classList),role:m.getAttribute("role"),tabindex:m.getAttribute("tabindex"),text:y,originalText:y}});let s=[...t];Object.keys(n).sort((m,y)=>y.split(/\s+/).length-m.split(/\s+/).length).forEach(m=>{let y=m.split(/\s+/);for(let p=0;p<s.length-y.length+1;p++){if(s[p].isPartOfGlossaryTerm)continue;if(s.slice(p,p+y.length).map(x=>i(x.text)).join(" ")===m)for(let x=0;x<y.length;x++)s[p+x].isPartOfGlossaryTerm=!0,s[p+x].glossaryTermIndex=p,s[p+x].glossaryTermLength=y.length,s[p+x].glossaryTerm=m}});let d=[],u=0;for(;u<s.length;){let m=s[u];if(m.isPartOfGlossaryTerm&&m.glossaryTermIndex===u){let y=s.slice(u,u+m.glossaryTermLength).map(x=>x.text).join(" "),p=n[m.glossaryTerm],h=p.classes.join(" ");d.push(`<span 
        data-word-index="${u}" 
        class="${h}" 
        role="${p.role||"button"}" 
        tabindex="${p.tabindex||"0"}"
        data-glossary-term="true"
      >${y}</span>`),u+=m.glossaryTermLength}else{let y=i(m.text);if(n[y]){let p=n[y],h=p.classes.join(" ");d.push(`<span 
          data-word-index="${u}" 
          class="${h}" 
          role="${p.role||"button"}" 
          tabindex="${p.tabindex||"0"}"
          data-glossary-term="true"
        >${m.text}</span>`)}else m.isPartOfGlossaryTerm||d.push(`<span data-word-index="${u}">${m.text}</span>`);u++}}e.innerHTML=d.join(" "),e.querySelectorAll('[data-glossary-term="true"]').forEach(m=>{m.addEventListener("click",y=>{y.stopPropagation(),window._isGlossaryTermClick=!0,(l.isPlaying||l.currentAudio)&&($(),K()),ct(y),setTimeout(()=>{window._isGlossaryTermClick=!1},100)})})}function Rc(e,t,o){let n=e.currentTime,a=-1,r=o[o.length-1];if(r&&n>r.end+ft){Ge();return}if(n<o[0].start)a=0;else if(n>=o[o.length-1].start)a=o.length-1;else for(let c=0;c<o.length&&n>=o[c].start;c++)if(a=c,c<o.length-1&&n>o[c+1].start-ft&&(a=c+1),n>o[c].end+ft&&c<o.length-1&&n<o[c+1].start-ft){Ge();return}a===-1&&(a=0),t.querySelectorAll("span[data-word-index]").forEach(c=>{c.classList.remove("bg-yellow-300"),c.classList.remove("rounded-lg"),c.classList.remove("text-black")});let s=t.querySelector(`span[data-word-index="${a}"]`);s&&(s.classList.add("bg-yellow-300"),s.classList.add("rounded-lg"),s.classList.add("text-black"))}var We,vr,Ve,yt,ft,q,Ue,Lr=N(()=>{"use strict";z();H();Y();ue();We=null,vr=null,Ve=null,yt=null,ft=.2,q=null,Ue=null});var Sr,Dt,Ht,vn,wr,Ir=N(()=>{"use strict";de();z();D();Sr=()=>{let e=document.getElementById("notepad-button");e&&e.classList.remove("hidden")},Dt=()=>{let e=document.getElementById("notepad-content"),t=document.getElementById("notepad-button");if(e)if(!e.classList.contains("hidden"))l.notepadOpen=!1,I("notepadOpen","false",30),e.classList.add("hidden"),t.setAttribute("aria-expanded","false"),Ht();else{l.notepadOpen=!0,I("notepadOpen","true",30),e.classList.remove("hidden"),t.setAttribute("aria-expanded","true");let n=document.getElementById("notepad-textarea");n&&setTimeout(()=>n.focus(),100),vn()}},Ht=()=>{let e=document.getElementById("notepad-textarea"),t=document.getElementById("notepad-save-status");e&&(localStorage.setItem("user_notepad",e.value),t&&(t.textContent=f("notepad-save-success"),t.classList.remove("opacity-0"),t.classList.add("opacity-100"),setTimeout(()=>{t.classList.remove("opacity-100"),t.classList.add("opacity-0")},2e3)))},vn=()=>{let e=document.getElementById("notepad-textarea");if(e){let t=localStorage.getItem("user_notepad");t!==null&&(e.value=t)}},wr=()=>{k("notepadOpen")=="true"&&Dt()}});function Tr(){let e=Date.now().toString(36);return`${Math.random().toString(36).substring(2,10)}`}function xn(){let e=kr[Math.floor(Math.random()*kr.length)],o=zc[e]===!0?Cr.feminine:Cr.masculine,n=o[Math.floor(Math.random()*o.length)],a=Dc[e]||"\u{1F996}";return{firstName:e,lastName:n,fullName:`${e} ${n}`,emoji:a}}var Cr,zc,kr,Dc,Nr=N(()=>{"use strict";Cr={masculine:["R\xE1pido","Feroz","Dulce","Elegante","Intr\xE9pido","Valiente","Sabio","Astuto","Brillante","Divertido","Amigable","Aventurero","Creativo","Misterioso","Encantador","Feliz","Simp\xE1tico"],feminine:["R\xE1pida","Feroz","Dulce","Elegante","Intr\xE9pida","Valiente","Sabia","Astuta","Brillante","Divertida","Amigable","Aventurera","Creativa","Misteriosa","Encantadora","Feliz","Simp\xE1tica"]},zc={Serpiente:!0,Jirafa:!0,\u00C1guila:!0,Ballena:!0,Estrella:!0,Abeja:!0,Mariquita:!0,Mariposa:!0,Tortuga:!0,Medusa:!0,Cebra:!0,Sirena:!0,Cocodrilo:!1,Panda:!1,Koala:!1,Tigre:!1,Le\u00F3n:!1,Elefante:!1,Zorro:!1,Lobo:!1,Oso:!1,Conejo:!1,Rat\u00F3n:!1,Mono:!1,Mapache:!1,Ping\u00FCino:!1,Loro:!1,B\u00FAho:!1,Delf\u00EDn:!1,Tibur\u00F3n:!1,Pulpo:!1,Cangrejo:!1,Pez:!1,Cactus:!1,Robot:!1,Dinosaurio:!1,Extraterrestre:!1,Fantasma:!1,Genio:!1,"Mu\xF1eco de Nieve":!1,Caramelo:!1,Unicornio:!1},kr=["Cocodrilo","Serpiente","Panda","Koala","Tigre","Le\xF3n","Elefante","Jirafa","Zorro","Lobo","Oso","Conejo","Rat\xF3n","Mono","Mapache","Cebra","\xC1guila","Flamenco","Ping\xFCino","Loro","B\xFAho","Delf\xEDn","Ballena","Tibur\xF3n","Pulpo","Estrella","Cangrejo","Pez","Tortuga","Medusa","Foca","Abeja","Mariquita","Mariposa","Cactus","Robot","Dinosaurio","Extraterrestre","Fantasma","Genio","Sirena","Mu\xF1eco de Nieve","Caramelo","Unicornio"],Dc={Cocodrilo:"\u{1F40A}",Serpiente:"\u{1F40D}",Rana:"\u{1F438}",Panda:"\u{1F43C}",Koala:"\u{1F428}",Tigre:"\u{1F42F}",Le\u00F3n:"\u{1F981}",Elefante:"\u{1F418}",Jirafa:"\u{1F992}",Zorro:"\u{1F98A}",Lobo:"\u{1F43A}",Oso:"\u{1F43B}",Conejo:"\u{1F430}",Rat\u00F3n:"\u{1F42D}",Mono:"\u{1F412}",Mapache:"\u{1F99D}",Cebra:"\u{1F993}",\u00C1guila:"\u{1F985}",Flamenco:"\u{1F9A9}",Ping\u00FCino:"\u{1F427}",Loro:"\u{1F99C}",B\u00FAho:"\u{1F989}",Delf\u00EDn:"\u{1F42C}",Ballena:"\u{1F40B}",Tibur\u00F3n:"\u{1F988}",Pulpo:"\u{1F419}",Estrella:"\u2B50",Cangrejo:"\u{1F980}",Pez:"\u{1F420}",Tortuga:"\u{1F422}",Medusa:"\u{1F419}",Foca:"\u{1F9AD}",Abeja:"\u{1F41D}",Mariquita:"\u{1F41E}",Mariposa:"\u{1F98B}",Cactus:"\u{1F335}",Robot:"\u{1F916}",Dinosaurio:"\u{1F996}",Extraterrestre:"\u{1F47D}",Fantasma:"\u{1F47B}",Genio:"\u{1F9DE}\u200D\u2642\uFE0F",Sirena:"\u{1F9DC}\u200D\u2640\uFE0F","Mu\xF1eco de Nieve":"\u26C4\uFE0F",Caramelo:"\u{1F36D}",Unicornio:"\u{1F984}"}});function Hc(){let e=xn(),t=localStorage.getItem("studentID");localStorage.setItem("characterInfo",JSON.stringify(e)),localStorage.setItem("nameUser",e.fullName),g("characterName",e.fullName),g("characterEmoji",e.emoji),g("studentID",t),qr(e,t),Br(e,t),O(f("character-regenerated-announcement")+e.fullName);let o=document.getElementById("character-emoji");o&&(o.classList.add("animate-bounce"),setTimeout(()=>{o.classList.remove("animate-bounce")},1e3))}function qr(e,t){let o=document.querySelectorAll("#character-name"),n=document.querySelectorAll("#character-emoji"),a=document.querySelectorAll("#student-id");o.forEach(r=>{r&&(r.textContent=e.fullName)}),n.forEach(r=>{r&&(r.textContent=e.emoji)}),a.forEach(r=>{r&&(r.textContent=t)})}function Br(e,t){let o=document.getElementById("settings-character-name");o&&(o.textContent=e.fullName);let n=document.getElementById("settings-character-emoji");n&&(n.textContent=e.emoji)}function En(){let e=localStorage.getItem("studentID");e||(e=Tr(),localStorage.setItem("studentID",e)),g("studentID",e);let t=localStorage.getItem("characterInfo"),o;t?o=JSON.parse(t):(o=xn(),localStorage.setItem("characterInfo",JSON.stringify(o)),localStorage.setItem("nameUser",o.fullName)),g("characterName",o.fullName),g("characterEmoji",o.emoji),qr(o,e),Br(o,e);let n=document.getElementById("refresh-character");n&&n.addEventListener("click",Hc)}var _r=N(()=>{"use strict";Nr();z();Y();D()});var zr={};Me(zr,{init:()=>Uc,initTutorial:()=>Rr,resetTutorial:()=>Fr,showTutorial:()=>Pr,showWelcome:()=>$r});function Uc(){Rr()}var Wt,jt,jc,V,_,te,_e,$r,Pr,Mr,Or,Wc,Vc,An,Fr,Rr,Dr=N(()=>{"use strict";D();Y();Wt="tutorial_completed",jt=[{title:"1/3",content:"tutorial-step-1-content",position:"left",arrow:"left",targetElementId:"nav-popup",targetElementClass:"nav__toggle"},{title:"2/3",content:"tutorial-step-2-content",position:"center",arrow:"bottom",targetElementId:"back-forward-buttons",targetElementClass:"navigation-buttons"},{title:"3/3",content:"tutorial-step-3-content",position:"right",arrow:"right",targetElementId:"open-sidebar",targetElementClass:"sidebar-toggle"}],jc=0,$r=()=>{if(localStorage.getItem(Wt)==="true")return;V=document.createElement("div"),V.className="fixed inset-0 bg-black bg-opacity-50 z-[10000] flex items-center justify-center",V.setAttribute("role","dialog"),V.setAttribute("aria-modal","true"),V.setAttribute("aria-labelledby","welcome-title"),V.setAttribute("aria-describedby","welcome-description"),te=document.createElement("div"),te.className="bg-white rounded-lg shadow-lg p-6 max-w-[400px] relative z-[10001] pointer-events-auto text-center animate-tutorialPopIn",te.setAttribute("tabindex","0");let e=document.createElement("div");e.className="text-[48px] mb-2",e.textContent="\u{1F44B}",e.setAttribute("role","img"),e.setAttribute("aria-label",f("tutorial-welcome-emoji-label"));let t=document.createElement("h2");t.className="text-2xl font-bold mb-2",t.id="welcome-title",t.setAttribute("tabindex","-1"),t.textContent=f("tutorial-welcome-title");let o=document.createElement("p");o.className="text-xl mb-5",o.innerHTML=f("tutorial-welcome-content");let n=document.createElement("p");n.className="text-gray-600 leading-snug mb-6 text-base",n.id="welcome-description",n.innerHTML=f("tutorial-description-content");let a=document.createElement("button");a.textContent=f("tutorial-start-button-content"),a.className="bg-blue-600 text-white font-medium py-2 px-4 rounded cursor-pointer border-0 hover:bg-blue-700 text-base py-2 px-5",a.setAttribute("aria-label",f("tutorial-start-button-aria-label"));let r=document.createElement("button");r.className="absolute top-2.5 right-5 bg-transparent border-0 cursor-pointer text-2xl text-gray-600",r.setAttribute("aria-label",f("tutorial-exit-button-aria-label")),r.textContent="\xD7",r.addEventListener("click",()=>{V.remove(),localStorage.setItem(Wt,"true"),O(f("tutorial-closed-announcement"));let i=document.querySelector('main, [role="main"], .container');i&&(i.setAttribute("tabindex","-1"),i.focus())}),te.appendChild(r),a.addEventListener("click",()=>{te.remove(),Pr(),O(f("tutorial-starting-announcement"))}),te.appendChild(e),te.appendChild(t),te.appendChild(o),te.appendChild(n),te.appendChild(a),V.appendChild(te),document.body.appendChild(V),Or(te,[a]),O(f("tutorial-welcome-announcement")),setTimeout(()=>{t.focus()},100)},Pr=()=>{_=document.createElement("div"),_.className="bg-white rounded-lg shadow-lg p-6 max-w-[350px] relative z-[10001] pointer-events-auto animate-tutorialPopIn",_.setAttribute("tabindex","0"),_.setAttribute("role","dialog"),_.setAttribute("aria-modal","true"),V.appendChild(_),Mr(0)},Mr=e=>{if(e<0||e>=jt.length)return;jc=e;let t=jt[e];_.innerHTML="",_.setAttribute("aria-labelledby",`tutorial-title-${e}`),_.setAttribute("aria-describedby",`tutorial-content-${e}`);let o=document.getElementById(t.targetElementId);if(!o){console.error(`Target element #${t.targetElementId} not found`);return}let n=document.querySelector(".cloned-element-container");n&&n.remove();let a=document.createElement("div");a.className="fixed z-[10002] pointer-events-none cloned-element-container",a.setAttribute("aria-hidden","true");let r;if(t.targetElementId==="nav-popup"){r=document.createElement("button"),r.id="cloned-nav-popup",r.className="px-4 py-3 bg-white text-gray-800 rounded-lg shadow-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50 aria-expanded:bg-blue-700 aria-expanded:text-white",r.setAttribute("aria-label",f("context-index-menu")),r.setAttribute("type","button");let p=document.createElement("i");p.className="fas fa-list",p.setAttribute("aria-hidden","true"),r.appendChild(p)}else if(t.targetElementId==="back-forward-buttons"){r=document.createElement("div"),r.id="cloned-back-forward-buttons",r.className="flex flex-row-reverse items-center bg-white border border-gray-300 rounded-2xl shadow-md";let p=document.createElement("button");p.className="text-2xl no-underline text-gray-800 px-4 py-2",p.setAttribute("aria-label","Next page");let h=document.createElement("i");h.className="fas fa-chevron-right",p.appendChild(h);let x=document.createElement("span");x.textContent="1",x.className="align-text-bottom no-underline text-gray-800 px-4 py-2 text-2xl border-r border-gray-300";let v=document.createElement("button");v.className="text-2xl no-underline text-gray-800 px-4 py-2 border-r border-gray-300",v.setAttribute("aria-label",f("previous"));let T=document.createElement("i");T.className="fas fa-chevron-left",v.appendChild(T),r.appendChild(p),r.appendChild(x),r.appendChild(v)}else if(t.targetElementId==="open-sidebar"){r=document.createElement("button"),r.id="cloned-open-sidebar",r.className="w-12 h-12 flex items-center justify-center rounded-full bg-white hover:bg-gray-100 focus:outline-none focus:ring-4 focus:ring-blue-500 shadow-lg",r.setAttribute("aria-label",f("tutorial-smart-utility-sidebar-label"));let p=document.createElement("i");p.className="fa fa-universal-access text-4xl text-gray-800",r.appendChild(p)}else r=o.cloneNode(!0),r.id=`cloned-${t.targetElementId}`;if(r.style.pointerEvents="none",r.className+=" cloned-interface-element flex items-center justify-center border-2 border-blue-500/80 rounded-lg bg-white shadow-tutorial animate-pulseBorder",r.setAttribute("aria-hidden","true"),Wc(a,o,t.position),a.appendChild(r),V.appendChild(a),Vc(t.position,o),t.arrow){let p=document.createElement("div");p.className=`absolute w-0 h-0 border-solid ${t.arrow==="left"?"border-y-[10px] border-r-[15px] border-y-transparent border-r-white left-[-15px] top-[90%] -translate-y-1/2":t.arrow==="right"?"border-y-[10px] border-l-[15px] border-y-transparent border-l-white right-[-15px] top-[6%] -translate-y-1/2":t.arrow==="top"?"border-x-[10px] border-b-[15px] border-x-transparent border-b-white top-[-15px] left-1/2 -translate-x-1/2":t.arrow==="bottom"?"border-x-[10px] border-t-[15px] border-x-transparent border-t-white bottom-[-15px] left-1/2 -translate-x-1/2":""}`,p.setAttribute("aria-hidden","true"),_.appendChild(p)}let i=document.createElement("h3");i.className="text-xl font-semibold mb-4 text-gray-800",i.id=`tutorial-title-${e}`,i.textContent=t.title;let s=document.createElement("div");s.className="mb-6 text-gray-600 leading-snug text-lg",s.id=`tutorial-content-${e}`,s.innerHTML=f(t.content);let c=document.createElement("div");c.className="flex justify-between items-center";let d=document.createElement("button");d.textContent=f("tutorial-skip"),d.className="text-gray-500 text-sm p-2 cursor-pointer bg-none border-0 hover:text-gray-600 hover:underline underline",d.addEventListener("click",An);let u=document.createElement("button");e===jt.length-1?(u.textContent=f("finish"),u.className="bg-blue-600 text-white font-medium py-2 px-4 rounded cursor-pointer border-0 hover:bg-blue-700",u.addEventListener("click",An)):(u.textContent=f("next"),u.className="bg-blue-600 text-white font-medium py-2 px-4 rounded cursor-pointer border-0 hover:bg-blue-700",u.addEventListener("click",()=>{Mr(e+1)})),c.appendChild(d),c.appendChild(u),_.appendChild(i),_.appendChild(s),_.appendChild(c),_.focus(),Or(_,[d,u]);let m=e+1,y=f("tutorial-step-"+m+"-content-announcement");O(f("tutorial-step-announcement",{currentStep:m,totalSteps:jt.length,stepContent:y}))},Or=(e,t)=>{e.addEventListener("keydown",o=>{if(o.key==="Escape"&&(An(),o.preventDefault()),o.key==="Tab"){if(t.length===0)return;let n=t[0],a=t[t.length-1];o.shiftKey&&document.activeElement===n?(a.focus(),o.preventDefault()):!o.shiftKey&&document.activeElement===a&&(n.focus(),o.preventDefault())}})},Wc=(e,t,o)=>{let n=t.getBoundingClientRect();e.style.position="absolute",e.style.left=`${n.left}px`,e.style.top=`${n.top}px`,e.style.width=`${n.width}px`,e.style.height=`${n.height}px`,e.style.zIndex="10002"},Vc=(e,t)=>{_.style.position="absolute",_.style.top="",_.style.bottom="",_.style.left="",_.style.right="",_.style.transform="";let o=t.getBoundingClientRect();switch(e){case"left":_.style.left=`${o.right+20}px`,_.style.bottom=`${window.innerHeight-o.bottom+20}px`;break;case"center":_.style.bottom=`${window.innerHeight-o.top+20}px`,_.style.left=`${o.left+o.width/2-175}px`;break;case"right":_.style.right=`${window.innerWidth-o.left+20}px`,_.style.top=`${o.top+o.height/2-10}px`;break;default:_.style.top="50%",_.style.left="50%",_.style.transform="translate(-50%, -50%)"}},An=()=>{localStorage.setItem(Wt,"true"),V.style.opacity="0",V.style.transition="opacity 0.3s ease",_e&&(_e.style.opacity="0",_e.style.transition="opacity 0.3s ease");let e=document.getElementById("tutorial-announcer");e&&e.remove(),setTimeout(()=>{V&&V.parentNode&&V.parentNode.removeChild(V),_e&&_e.parentNode&&_e.parentNode.removeChild(_e);let t=document.querySelector("h1"),o=document.getElementById("content");t?(t.setAttribute("tabindex","-1"),t.focus()):o&&(o.setAttribute("tabindex","-1"),o.focus()),O(f("tutorial-completed-announcement"))},300)},Fr=()=>{localStorage.removeItem(Wt)},Rr=()=>{window.location.hash.includes("showTutorial")&&Fr(),setTimeout($r,300)}});async function Kc(){try{Qc(),await Jc();let e=[{name:"Core",fn:Zc},{name:"EventListeners",fn:od,dependencies:["Core"]},{name:"UI",fn:ad,dependencies:["Core","EventListeners"]},{name:"Final",fn:rd,dependencies:["UI"]}];for(let t of e)await t.fn()}catch(e){console.error("Error in initialization:",e),Jt(e)}finally{ht()}}function Qc(){[{rel:"icon",type:"image/x-icon",href:"./assets/favicon_io/favicon.ico"},{rel:"apple-touch-icon",sizes:"180x180",href:"./assets/favicon_io/apple-touch-icon.png"},{rel:"icon",type:"image/png",sizes:"32x32",href:"./assets/favicon_io/favicon-32x32.png"},{rel:"icon",type:"image/png",sizes:"16x16",href:"./assets/favicon_io/favicon-16x16.png"},{rel:"manifest",href:"./assets/favicon_io/site.webmanifest"}].forEach(t=>{if(!Array.from(document.head.querySelectorAll("link")).some(n=>n.rel===t.rel&&n.href.includes(t.href.split("/").pop()))){let n=document.createElement("link");for(let[a,r]of Object.entries(t))n.setAttribute(a,r);document.head.appendChild(n)}})}function Jc(){return new Promise(e=>{document.readyState==="complete"?e():window.addEventListener("load",e)})}async function Zc(){try{return document.readyState!=="complete"&&await new Promise(t=>{window.addEventListener("load",t)}),Hr(),En(),await Xc(),Hr(),await Fo()||console.warn("Language dropdown initialization failed, continuing with other components"),Re(),Ro(),await qn(),!0}catch(e){return console.error("Error in core initialization:",e),!1}}function Hr(){let e=k("currentLanguage"),t=document.getElementsByTagName("html")[0].getAttribute("lang"),o=window.appConfig?.languages?.default||t||"en",n=window.appConfig?.languages?.available||[],a=null;if(n.length>0)if(e&&n.includes(e))a=e;else{if(e&&!n.includes(e)){console.warn(`Cookie language "${e}" not available. Available languages:`,n,". Using default:",o),Qt("currentLanguage","/");let r=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1);r!=="/"&&Qt("currentLanguage",r)}a=o,I("currentLanguage",o,7)}else a=e||o;g("currentLanguage",a)}async function Xc(){try{let[e,t,o,n,a]=await Promise.all([fetch("./assets/interface.html").then(r=>r.text()),fetch("./content/navigation/nav.html").then(r=>r.text()),fetch("./assets/config.json").then(r=>r.json()),fetch("./content/pages.json").then(jr).then(r=>r.json()),fetch("./content/toc.json").then(jr).then(r=>r.json())]);await Yc(e,t,o),On(),Fn({pages:n,toc:a}),Re()}catch(e){throw new Error("Failed to fetch components: "+e.message)}}async function Yc(e,t,o){try{let n=$o(),a=Po();if(n&&a){if(!zo())throw new Error("Failed to restore cached interface elements")}else{let r=G.get("interface-container"),i=G.get("nav-container");if(!r||!i)throw new Error("Required containers not found");r.innerHTML=e,i.innerHTML=t,G.clear(),ie()}ed(o)}catch(n){throw console.error("Error injecting components:",n),new Error("Failed to inject components: "+n.message)}}function ed(e){if(e.title&&e.title!==Gc&&(document.title=e.title),e.languages&&e.languages.available){let t=e.languages.available.join(","),o=document.querySelector('meta[name="available-languages"]');o||(o=document.createElement("meta"),o.name="available-languages",document.head.appendChild(o)),o.content=t}window.appConfig=e,td(e.features||{})}function td(e){Object.entries(e).forEach(([t,o])=>{let n=t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();if(t==="notepad"){let a=document.getElementById("notepad-button"),r=document.getElementById("notepad-content");a&&a.classList.toggle("hidden",!o),r&&r.classList.toggle("hidden",!o)}else if(t==="showAutoHideButton"){let a=document.getElementById("toggle-state");if(a){let r=a.closest(".flex.justify-between.items-left")||a.parentElement;r&&r.classList.toggle("hidden",!o)}}else if(t==="showNavigationControls"){let a=document.getElementById("back-forward-buttons"),r=document.getElementById("back-button"),i=document.getElementById("forward-button");a&&(a.classList.toggle("hidden",!o),a.setAttribute("aria-hidden",(!o).toString())),[r,i].forEach(s=>{s&&(s.tabIndex=o?0:-1,s.setAttribute("aria-hidden",(!o).toString()))})}else if(t==="characterDisplay"){let a=document.getElementById("character-profile-row");a&&a.classList.toggle("hidden",!o)}else{let a=G.get(`toggle-${n}`);if(a){let r=a.closest(".setting-item")||a.closest(".feature-container")||a.parentElement;r&&r.classList.toggle("hidden",!o)}}g(`${t}Enabled`,o)})}function od(){let e={"open-sidebar":re,"close-sidebar":re,"toggle-eli5":sn,"toggle-easy-read":Ho,"toggle-sign-language":je,"sl-quick-toggle-button":je,"toggle-syllables":jo,"toggle-glossary":Uo,"toggle-autoplay":on,"toggle-describe-images":nn,"toggle-state":Ko,"back-button":ao,"forward-button":Le,"nav-popup":Ae,"nav-close":Ae};S("notepad")&&(e["notepad-button"]=Dt,e["close-notepad"]=Dt,e["save-notepad"]=Ht),Object.entries(e).forEach(([n,a])=>{let r=G.get(n);r&&r.addEventListener("click",a)});let t=G.get("language-dropdown");if(t&&t.addEventListener("change",Do),S("notepad")){let n=G.get("notepad-textarea");if(n){let a;n.addEventListener("input",()=>{clearTimeout(a),a=setTimeout(Ht,1e3)})}}document.addEventListener("click",zn),document.addEventListener("keydown",Hn),G.getAll(".purple-link-button").forEach(n=>{n.addEventListener("click",()=>{localStorage.setItem("originatingPage",window.location.href)})}),jn()}function nd(){[["play-pause-button",dr],["toggle-read-aloud",mt],["audio-previous",mr],["audio-next",gr],["read-aloud-speed",dt]].forEach(([o,n])=>{let a=G.get(o);a&&a.addEventListener("click",n)}),G.getAll(".read-aloud-change-speed").forEach(o=>{o.addEventListener("click",fr)})}async function ad(){try{if(await Ln.load("zoom",()=>Promise.resolve({init:Pt})).then(e=>e.init()),Mo(),un(),Ne(),window.appConfig?.features){if(S("readAloud")){Jo(),pr(),nd(),hr();let o=document.getElementById("tts-sidebar-section");if(o&&o.classList.remove("hidden"),l.readAloudMode){gt();let n=G.get("play-bar");n&&n.classList.remove("hidden")}}S("glossary")&&dn(),S("eli5")&&ln(),S("notepad")&&Sr(),S("characterDisplay")&&(En(),id()),S("highlight")&&Er();let e=[];if(S("easyRead")){let o=document.getElementById("easy-read-section");o&&o.classList.remove("hidden"),e.push(Go)}if(e.push(Qo),S("signLanguage")){let o=document.getElementById("sign-language-section");o&&o.classList.remove("hidden"),Wo(),e.push(Vo)}if(S("notepad")&&(e.push(vn()),e.push(wr)),S("autoplay")?(Rt(!0),e.push(Yo)):Rt(!1),S("describeImages")&&(gn(!0),e.push(en)),S("autoplay")||S("describeImages")?pt(!0):pt(!1),S("glossary")&&e.push(tn),S("eli5")&&cn(),!(S("easyRead")||S("readAloud")||S("signLanguage")||S("eli5")||S("glossary"))){let o=document.getElementById("assistant-tab");o&&o.classList.add("hidden");let n=document.getElementById("settings-tab"),a=document.getElementById("assistant-content"),r=document.getElementById("settings-content");n&&a&&r&&(n.setAttribute("aria-selected","true"),n.classList.add("text-blue-700","border-b-4","-mb-1","border-blue-700"),a.classList.add("hidden"),r.classList.remove("hidden"))}e.length>0&&await Promise.all(e.map(o=>Promise.resolve().then(o)))}else{let e=[];await Promise.all(e.map(t=>t()))}S("activities",!0)&&document.querySelectorAll('section[role="activity"]').length>0&&(la(),Ya()),Ft()}catch(e){console.error("Error initializing UI components:",e)}}function id(){let e=localStorage.getItem("characterInfo"),t=localStorage.getItem("studentID"),o=document.getElementById("character-profile-row");if(o&&o.classList.contains("hidden")&&o.classList.remove("hidden"),e)try{let n=JSON.parse(e),a=G.get("settings-character-emoji"),r=G.get("settings-character-name"),i=G.getAll("#student-id");a&&r&&(a.textContent=n.emoji||"\u{1F464}",r.textContent=n.fullName||localStorage.getItem("nameUser")||"Guest"),t&&i.length>0&&i.forEach(s=>{s&&(s.textContent=t)})}catch(n){console.error("Error parsing character information:",n)}}var Gc,Wg,G,jr,rd,Ln,S,fn=N(()=>{kn();H();Lr();de();vt();ue();_o();Xe();z();D();Y();Ir();ze();Ct();_r();Ee();Gc="Accessible Digital Textbook",Wg=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1),G={_cache:new Map,get(e){if(!this._cache.has(e)){let t=document.getElementById(e);this._cache.set(e,t)}return this._cache.get(e)},getAll(e){let t=`selector:${e}`;if(!this._cache.has(t)){let o=document.querySelectorAll(e);this._cache.set(t,o)}return this._cache.get(t)},clear(){this._cache.clear()}};document.addEventListener("DOMContentLoaded",async function(){try{await Kc()}catch(e){console.error("Error initializing application:",e),Jt()}});window.addEventListener("beforeunload",()=>{ie()});jr=async e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e};rd=async()=>{let e=G.get("navPopup"),t=G.get("sidebar");setTimeout(async()=>{e&&e.classList.remove("hidden"),t&&t.classList.remove("hidden"),S("readAloud")&&S("autoplay")&&an();let o=[()=>Oo(),()=>mn(),()=>{S("glossary")&&X()},()=>{window.MathJax&&window.MathJax.typeset()},()=>{Ne()},async()=>{if(!S("showTutorial",!0))return;let n=await Ln.load("tutorial",()=>Promise.resolve().then(()=>(Dr(),zr)));n.init&&n.init()},async()=>{window.appConfig?.analytics?.enabled&&(await Ln.load("analytics",()=>Promise.resolve().then(()=>(Ee(),Bn)))).initMatomo(window.appConfig.analytics)}];await Promise.all(o.map(n=>Promise.resolve().then(n)))},100)};Ln={_modules:{},async load(e,t){return this._modules[e]||(this._modules[e]=await t()),this._modules[e]}},S=(e,t=!1)=>{if(typeof window.appConfig?.features?.[e]<"u")return window.appConfig.features[e]===!0;let o=`${e}Enabled`;return typeof l[o]<"u"?l[o]===!0:t}});fn();export{fr as changeAudioSpeed,Hn as handleKeyboardShortcuts,an as initializeAutoplay,S as isFeatureEnabled,Yo as loadAutoplayState,en as loadDescribeImagesState,gr as playNextAudio,mr as playPreviousAudio,sn as toggleEli5Mode,dr as togglePlayPause,mt as toggleReadAloud};
//# sourceMappingURL=base.bundle.min.js.map
